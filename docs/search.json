[
  {
    "objectID": "preface.html",
    "href": "preface.html",
    "title": "Preface",
    "section": "",
    "text": "致谢\n我要特别感谢位于霍巴特的澳大利亚联邦科学与工业研究组织（CSIRO）海洋与大气部，感谢他们给了我成为该组织荣誉研究员的机会。能够继续使用图书馆和办公室为本书的写作提供了极大的便利。除了实用性之外，能在这样一个活跃的工作环境中与这么多优秀的人共事也很有价值，我在从事渔业科学工作期间曾与他们共事和合作。此外，我还要感谢塔斯马尼亚大学任命我为海洋与南极研究所的兼职教授。即使在 2008 年底离开塔斯马尼亚大学后，我仍继续与那里的许多优秀员工合作，特别是克雷格-蒙迪（Craig Mundy）博士，我还要感谢他允许我在 MQMF R 软件包中的许多数据集中使用鲍鱼研究项目的各种数据。\n我还要感谢许多通过电子邮件与我联系的人，他们提出了许多有趣的问题。他们帮助我找出了我没有说清楚的地方。\n最后，我要感谢我在Chapman & Hall/CRC的编辑罗布-卡尔弗（Rob Calver），他安排我在github页面或 http://www.bookdown.org 上免费发布本书的在线git-book版本。在我看来，bookdown 的最大优势之一就是它能为多种出版选择提供便利。开放源码社区（R、CRAN 和 RStudio 的部分内容是其中的最佳范例）是一项了不起的成就，我们都应该为它喝彩，并为相关人员鼓掌。",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "preface.html#作品细节",
    "href": "preface.html#作品细节",
    "title": "Preface",
    "section": "作品细节",
    "text": "作品细节\n本书是在RStudio（RStudio，2019）中使用Bookdown(Xie 2016)编写的，我使用了Chapman & Hall/CRC LaTeX class (kranz.cls)，该类经谢益辉修改，并由我自己对页面分数进行了一些非常小的试错编辑。代码块使用 Consolas 字体书写，将显示在略微灰色的方框中。软件包名称将以粗体显示（MQMF），函数名称（function()）将以圆括号结束，如果它们只是在文本中被引用。括号的作用是将它们与其他code 文本区分开来，后者通常是指变量、参数和函数参数。与数字有关的代码块一般指颜色，但本书是黑白印刷，因此也使用不同的图案或特定的顺序来区分不同的行。在其他地方，一般会使用颜色或图案，但不会同时使用两种。我在代码块和图例中保留了对颜色的引用，这样代码就保持了一般性，但希望不会造成混淆。\n代码块的控制台输出一般会预置 # 号，而代码块中的整行注释则总是缩进一个空格。无论代码块试图使用什么字体（font=7 意味着衬线字体），用于定义 pdfengine 如何渲染数字的 LaTeX 类都设置为使用无衬线字体。因此，如果单独使用代码块，它们将以不同的方式渲染图表。\n\n\n\n\n\n\nHaddon, Malcolm. 2011. Modelling and Quantitative Methods in Fisheries. Chapman; Hall/CRC. https://doi.org/10.1201/9781439894170.\n\n\nXie, Yihui. 2016. 《bookdown: Authoring Books and Technical Documents with R Markdown》. The R Foundation. https://doi.org/10.32614/cran.package.bookdown.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "01-intro.html",
    "href": "01-intro.html",
    "title": "1  关于建模",
    "section": "",
    "text": "1.1 数据模型的特点",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>关于建模</span>"
    ]
  },
  {
    "objectID": "01-intro.html#数据模型的特点",
    "href": "01-intro.html#数据模型的特点",
    "title": "1  关于建模",
    "section": "",
    "text": "1.1.1 简介\n常规的渔业种群评估通常基于种群生产过程和捕捞群体种群动态的数学模型。正面的生产过程包括补充动态（增加数量）和个体生长（增加生物量），而负面的生产过程包括自然死亡率和捕捞死亡率（包括选择性），这既减少了数量，也减少了生物量。种群动态包括一些细节，例如建模动态中使用的时间步长、是否对生物量或数量建模（年龄或大小，或两者兼有）、空间结构的细节以及手头案例的其他细节。如此多的潜在细节意味着生物种群和过程的数学模型种类繁多。然而，仍有可能就这些模式发表一些常规性声明。\n由建模人员对现在已知过程或现象进行建模得到的所有模型都是抽象和模拟的。数学模型只是所有模型类别的一个子集，模型可能有多种形式，涵盖了构建的物理表示（想想由Watson 和 Crick，1953年制作的DNA球和棒模型），图表模型（如地理地图），以及这里讨论的更抽象的数学表达。我们可以通过关注模型的不同属性和建模人员做出的决定所施加的一些限制，对这种多样性施加某种概念顺序。\n\n\n1.1.2 模型设计或选择\n作为抽象，模型从来不是模型主题的完美副本，因此必须有一定程度的选择，建模者认为是系统的基本属性或组件。这种”基本属性或组件”的概念假定系统的所有部分并非都同样重要。例如，在人体血液循环系统的模型中，皮肤某处的浅静脉不会像肾动脉那么重要。如果接受这一假设，那么建模背后的一个基本想法是选择要包含的属性，以便模型的行为可能预期显示与建模系统的可观察行为接近。这种选择被认为是系统的重要属性允许，甚至迫使建模者强调系统建模的特定方面。路线图显示道路在真实地理尺度上大大放大，因为这是地图的要点。拓扑图强调不同的东西，因此在确定使用什么结构时，使用模型的目的也很重要。\n选择一个系统在模型中包括哪些方面决定模型是否将普遍适用于一类系统，或者如此专业，以至于它试图模拟特定系统的详细行为（对于系统，人们可能会读取鱼群或种群）。然而，通过选择自然系统的特定部分，模型也受到约束，它可以描述。假设尽管没有完成，但它将充分描述利益进程，而且不包括这些方面不会意外地扭曲整个的代表性（Haddon，1980）。\n当然，为了进行抽象，首先需要了解整体，但不幸的是，在现实世界中，还有许多仍然未知或被误解的东西。因此，模型很有可能成为所谓的”误用”。这就是模型的动态或行为，未能捕获正在研究的系统的全部动态。在本书稍后说明的一些示例中，我们将看到资源的平均预测生物质轨迹无法解释资源大小的振荡，显示大约 10 年周期（例如，参见第 7 章”剩余产量模型“的”Bootstrap 置信区间“节中拟合 dataspm 数据集的剩余产量模型）。在这种情况下，存在以未知机制作用于资源量的影响（或多种影响），这种影响以一种看似有规律或可重复的方式发生作用。假设这种规律是有意义的，由于其背后的机制不包含在模型结构中，那么，很明显，模型不能解释它的影响。这是典型的错误表达，虽然不是所有的错误表达都如此清晰或有如此清晰的规律。\n模型设计或模型选择是复杂的，因为将模型放在一起时做出的决定将取决于已知的内容和模型的使用。\n\n\n1.1.3 模型类型的局限\n模型可以是物理、口头、图形或数学，但是，为模型选择的特定形式对其所能描述的内容施加了限制。例如，对动态种群过程的口头描述对任何人都是挑战，因为人们使用文字捕捉或表达种群的动态特性总是有限度的。单词似乎更适合静态对象的描述。这种限制不一定是由于演讲者缺乏语言技能。相反，这是因为口语（至少我知道的语言）似乎不适合描述动态过程，尤其是在系统中的多个变量或方面正在随着时间的推移或相对于其他变量而变化的情况下。令人高兴的是，我们可以认为数学是一种替代语言，它提供了描述动态系统的极好方式。但是，即使以数学作为我们描述的基础，也有许多决定需要做出。\n\n\n1.1.4 数学模型\n有许多类型的数学模型。它们可被描述为描述性、解释性、现实性、理想主义、一般性或特殊性：它们也可以是决定性的、随机的、连续的和离散的。有时它们可以是其中一部分或所有类型的组合。有了所有这些可能性，对于数学模型究竟在科学研究中能发挥什么作用，就有可能产生混淆。为了更好地了解特定模型的潜在局限性，我们将尝试解释其中一些术语的含义。\n可将数学种群模型称为动态的，因为可以通种群/渔业的过去状态表示现在状态，并有可能描述未来的状态。例如，种群生物量动力学的Schaefer模型 (Schaefer 1957)可以部分地表示为：\n\\[\nB_{t+1} = B_t + r{B_t} \\left(1 - \\frac{B_t}{K} \\right) - C_t  \n\\qquad(1.1)\\]\n其中变量\\(C_t\\) 是时间\\(t\\) 段捕获的渔获量，\\(B_t\\) 是时间 \\(t\\) 开始时的群体生物量（\\(B_t\\) 也是模型的输出变量）。模型参数是 \\(r\\)，表示生物量（或数量，具体取决于对\\(B_t\\)的解释， 或许 \\(=N_t\\) ）的种群增长率， \\(K\\) 为系统所能达到的最大生物量（或数量）（这些参数来自早期数学生态学的 logistic 模型；参见第 3 章”简单种群模型“）。通过检查这个相对简单的模型，人们可以看到，在时间 \\((t+1)\\) 的期望生物量水平 与渔获量和前期生物量直接相关 （时间 \\(= t\\); 该值是连续相关的） 。前期生物量对种群增长的影响由 \\(r\\) 和 \\(K\\) 这两个参数的共同调控。通过计算不同时间段的变量之间的序列相关性，这种动态状态模型与传统的统计分析有显著差异。序列相关性意味着，如果我们每年对一个种群进行抽样，那么严格地说，样本将不独立，这是更经典的统计分析的要求。例如，在封闭的种群中，一年内两龄鱼的数量不能超过上一年的一龄鱼的数量：他们不独立。\n\n\n1.1.5 参数和变量\n在最原始的层面上，数学模型由变量和参数组成的。模型的变量必须表示可定义或可测量的性质（至少在原则上是这样）。参数会修改变量对模型输出的影响或贡献，或与模型内变量之间的关系有关。参数是定量决定变量如何相互作用的因素。它们与模型的变量不同，因为参数是模型安装到观测数据时估计的参数。在 公式 1.1 中， \\(B_t\\) 和 \\(C_t\\) 是变量，\\(r\\) 和 \\(K\\) 是参数。可以有重叠，例如，人们可能会估计 \\(B_t\\) 系列中非常初始的值，也许 \\(B_{init}\\) 因此，该系列将由一个参数组成，其余的为 \\(B_{init}\\) 的直接函数， \\(r\\) 和 \\(K\\) 为参数和 \\(C_t\\) 为变量。\n在任何模型中，如 公式 1.1 中，我们必须估计或提供参数的恒定值。对于这些变量，任一提供观察到的值（例如，时间系列渔获量， \\(C_t\\) ）或它们是模型的输出（ 如上所述 \\(B_{init}\\) ）。因此，在 公式 1.1 中，给出时间系列的观测渔获量以及 \\(B_{init}\\) 、\\(r\\) 和 \\(K\\) 的参数估计值，然后是一系列生物量值，\\(B_t\\)，由模型作为输出。只要人们意识到在观测值、估计、变量、参数和模型输出等术语中可能出现混淆的可能性，就可以更清楚地了解在建模特定现象时究竟在做什么。理论与模型结构的关系不一定简单。背景知识和理论可能是模型结构选择背后的驱动力。一组变量之间提议的关系可能构成关于自然组织的一个新假设或理论，或者仅仅是对目前已知内容的总结，准备随着学习的更多而修改。\n模型误用的另一个方面源于这样一个事实，即控制种群动态的参数往往被认为是随着时间而保持不变的，这通常应被承认为近似值。如果种群增长率 \\(r\\) 或承载能力\\(K\\) 随时间而随机变化，但假设是恒定的，这将是所谓的过程错误的一个例子。这种过程错误将增加从人群中采集的样本的可观察到的变化，即使可以毫无差错地收集（没有测量错误）。如果参数因人口外部的某些因素（环境因素或生物因素（如捕食者或竞争对手）而变化，那么这种非随机反应就有可能增进对自然世界的了解。因此，构建模型时所作决策的一个重要方面是明确对所选结构的假设。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>关于建模</span>"
    ]
  },
  {
    "objectID": "01-intro.html#数学模型属性",
    "href": "01-intro.html#数学模型属性",
    "title": "1  关于建模",
    "section": "1.2 数学模型属性",
    "text": "1.2 数学模型属性\n\n1.2.1 决定论与随机性\n我们可以将模型参数定义为定量属性（系统建模），假定该属性要么在可用数据的期间保持不变，要么由环境变化调节。大致而言，参数在模型应用的时间尺度上保持不变的模型称为确定性模型。对于给定的一组输入，由于其恒定的参数，确定性模型始终会为相同的输入提供相同的输出。由于模型变量之间的关系是固定的（恒定参数），因此给定输入的输出由模型的结构”决定”。人们不应被以下情况所混淆：确定模型中的参数通过采取一组预先确定值（例如，招聘指数或可捕获性指数可能每年更改和更改）而发生顺序变化。在这种情况下，虽然估计参数预计会随着时间而变化，但它们以可重复的、确定性的方式（在较长的时间尺度上保持不变）进行，给定输入始终提供相同输出的主要属性仍然有效。\n确定性模型与随机模型形成对比，在模型所涵盖的时间段内，至少有一个参数以随机或不可预知的方式变化。因此，如果给出一组输入值，相关的输出值将不确定。不同的参数将从预定的概率分布（无论是从经典概率密度函数 （PDF） 之一）或自定义分布中随机值。因此，例如，在模拟鱼群时，每年的补充量水平可能达到平均值正负随机量，由随机变种 公式 1.2 的性质决定。\n\\[\nR_{y} = \\bar{R} e^{N(0,\\sigma^{2}_{R})-\\sigma^{2}_{R}/2}\n\\qquad(1.2)\\]\n其中\\(R_y\\) 是年\\(y\\) 的补充量，\\(\\bar R\\) 是年间的平均补充量（这本身可能是资源规模的函数），\\(N(0, \\sigma_R^2)\\) 是用于随机变量的符号，其值在本示例中是均值为0 和方差为\\(\\sigma^2_R\\) 的正态分布（即具有正值和负值）。通过将正态分布以指数项表示，这将指定为对数正态变异，\\(-\\sigma_R^2/2\\) 为补充量时间系列中 Log-Normal 变异的偏差更正项（Haltuch等，2008）。\n模拟模型与具有估计参数的模型不同。这两种模型的目标也不同，前者可能被用来探讨不同管理方案的影响，而后者可能被用来估计资源的当前衰竭状态。\n鉴于一组输入数据（假定是完整和准确的;注意这些假设），一个确定性模型表示其所有可能的反应。然而，随机模型构成了所谓的蒙特卡洛模拟的基础，其中模型是反复运行相同的输入数据，但每次运行新的随机值产生为随机参数，如 公式 1.2 。 对于每个运行，都会产生不同的输出，并绘制这些输出表或图表，以查看从此类系统中可以预期到哪些结果范围。即使模型固有的变化通常是分布的，但这并不意味着可以预期特定输出通常分布在某些平均值上。如果模型中有非线性方面，可能会出现偏斜和其他更改。\n未来的种群预测、风险评估和确定数据中不确定性的影响都需要使用蒙特卡洛建模。模型结构的模拟测试是一个非常强大的工具。在 第 6 章 “不确定性（On Uncertainty）和第 7 章“剩余产量模型”（Surplus Production Models）中，详细介绍了这些预测的运行情况。\n\n\n1.2.2 连续与离散模型\n早期的渔业建模专家使用连续的微分方程来设计他们的模型，所以模型中的时间步长都是无限小的 （Beverton 和 Holt，1957）。当时，计算机还处于起步阶段，分析解决方案是当今的文化。因此，早期渔业模型是利用微积分形成的，其结构的某些部分更多地取决于可以分析解决的问题，而不是因为它们以特定准确的方式反映了自然。同时，这些模型的应用反映了或假定了平衡条件。幸运的是，我们现在可以使用易于访问的计算机和软件模拟资源状况，我们可以使用更现实或更详细的公式。虽然可能无法通过分析来求解此类模型（即，如果模型配方具有该结构，那么它的解就必须是这样的），但通常可以通过数值方式求解（了解情况并改进试验和错误）。尽管这两种方法仍在使用，但渔业科学的一大变化是从连续的微分方程向差异方程的转变，差分方程试图通过离散间隔（从无穷小到每年的时间步长）变化时对系统进行建模。\n模型构建的其他方面可以限制模型可以捕获或描述的行为。模型的实际结构或形式施加了限制。例如，如果数学建模人员使用差分方程来描述系统，那么事件的分辨率不能比模型构建的时间间隔更精确。这种明显的效果发生在许多地方。例如，在包含季节性成分的模型中，分辨率明显有限，具体取决于可用数据是持几周、几月还是其他间隔。例如，在第 5章 “静态模型”（Static Models）中，我们使用每周收集的数据来拟合季节性增长曲线，很明显，如果数据是每年收集的，那么描述季节性增长将是不可能的。\n\n\n1.2.3 描述性与解释性\n一个模型是离散的还是连续的，是确定性的还是随机的，这是模型结构的问题，它会明显影响着可以建模的内容。使用模型的目的也很重要。为了使模型具有描述性，它只需要模拟观察数据的经验行为。例如，对个体生长数据的精确拟合通常可以通过使用多项式方程获得:\n\\[\ny = a +bx +cx^2 + dx^3 + \\cdots + mx^n\n\\qquad(1.3)\\]\n其中未试图解释使用的多个参数(通常人们不会使用大于6阶的多项式，2阶或3阶更为常见)。这样的描述模型可以被视为黑盒，它为给定的输入提供确定性的输出。不需要知道这些模型的工作原理；甚至可以使用简单的查询表，通过从值的交叉列表中逐字查找输出，从给定的输入值生成特定的输出值。这样的黑盒模型只能是描述性的，除此之外别无其他。即使经验描述性模型可以做出假设，但如果特定的情况不能满足这些假设，这并不意味着需要完全拒绝模型，而只是必须限制该模型应用于哪些系统。除了所描述的变量外，这种纯描述性模型不需要具有现实主义元素，尽管它们的参数通常可以给出解释(如可实现的最大规模)。但同样重要的是，这些模型描述现有数据的程度，而不是它们的参数值是否具有生物学意义。在第 4 章“模型参数估计”（Model Parameter Estimation）中，我们将考察三条增长曲线，包括著名的 von Bertalanffy 曲线。该部分将对这种描述性模型的使用进行更深入的讨论。\n解释性模型还提供了对感兴趣的实证观察的描述，但除此之外，它们试图提供一些理由或解释，一种机制，说明为什么所注意到的特定观察发生而不是不同的数据。对于解释性模型，有必要考虑假设和参数，以及构成模型的变量。通过尝试使参数和变量，以及变量如何相互作用，反映自然，解释模型试图模拟自然界中的真实事件。如果模型包含理论构造（假设、变量或参数），则模型具有解释性，这些结构声称与自然过程有关，而不仅仅是与自然的行为方式相关。\n\n\n1.2.4 测试解释模型\n解释性模型至少部分地是关于自然的机制和结构以及自然如何运作的假设或理论。因此，它们应该根据自然界的观测结果进行测试。但是，我们如何测试解释模型呢？数据拟合模型可以提供模型测试吗？如果模型预测的观测数据的预期值占观测数据内变异性的很大比例，那么我们对模型充分描述观测结果的信心可能很大。但初始模型拟合并不构成对模型结构的直接测试。拟合模型并不测试模型是否解释观测到的数据；它只测试模型描述的程度和与数据一致性（Haddon，1980）。解释和描述之间的区别非常重要。一个纯粹的描述性或经验模型可以提供同样适合的数据，这有望表明，我们需要进一步的，独立的观察，以真正测试模型的结构。需要测试的不仅是模型是否适合一组观察到的数据（即不仅适合的质量），而且模型假设是否有效，以及模型变量之间的相互作用（如模型中的编码）是否密切反映自然。\n将目前拟合的模型与新的观测结果进行比较确实构成了某种测试。理想情况下，考虑到特定的输入，该模型将提供预测的观测以及围绕预期结果的置信间隔。如果模型预测，鉴于输入，其价值极不可能，则观察结果将与模型不一致。但是，有了这个测试，如果有反驳，没有迹象表明模型的哪个方面有问题。这是因为这不是对模型结构的测试，而只是对特定参数值（ 给定模型结构）是否足以预测未来结果的测试！我们不知道拟合过程是否有限，因为现有数据没有充分说明所研究资源固有的变化潜力。是假设还是建模者使变量相互作用的特殊方式？模型是否过于简单，这意味着重要的相互作用或变量被排除在结构外？如果没有对假设或特定变量重要性的独立测试，我们就无法判断。\n如果新的观测结果与模型一致，那么人们就没有什么收获了。实际上，新数据很可能会被包括在原始数据和重新估计的参数中。但这同样适用于纯粹的经验模型。所需要的是独立测试，确保所选择的结构不遗漏重要的变异来源；要验证这一点，需要的不仅仅是将预期输出与实际观测结果进行简单比较。\n虽然我们可以满足于观测数据和模型预测数据之间的拟合质量，但我们永远无法确定我们确定的模型是最好的。当然，有些模型可能看起来不太可接受，因为其它模型可能更有效地拟合数据。\n然而，任何关于哪条曲线或模型最能代表一组数据的讨论，不仅取决于拟合的质量，而且还取决于有关变量之间关系形式的其他信息。带有每个数据点参数的经验模型可以精确地拟合数据集，但不能提供任何有用的信息。显然，在这种情况下，除了数值拟合的质量之外，还必须使用其他标准来决定应该选择哪个模型。在第 5 章”静态模型“（Static Models）中，我们考虑了第 5.4 节 目标模型选择 的方法，试图评估增加模型中的参数数量在统计上是否合理。任何解释模型都必须具有生物学上的合理性。甚至可以给一个完全任意的模型结构的参数赋予意义。然而，这种解释将是临时的，而且仅在表面上可信。模型除了描述一组特定的数据外，不可能做更多的事情。解释性模型应该适用于新的数据集，尽管可能需要一组新的特定参数来适应新的情况。\n即使在现实的模型中，精度也不可能实现，因为我们对拟合变量的估计(观测误差)或系统响应(可能是环境变化(模型参数的过程误差))的内在不确定性。换句话说，在我们预测的系统结果的精度方面，可能无法超越某些限制(拟合质量可能有内在限制)。\n\n\n1.2.5 现实主义与普遍性\n与我们是否应该使用解释性模型相关的问题是模型中的现实主义问题。纯粹的描述性模型不需要任何现实的东西。但这只是一个假设，即如果某个科研人同正在开发一个解释模型，那么至少解释模型的一部分必须是现实的。例如，在年龄或体长可以区分的种群中，年龄或体长结构模型会被认为比将所有年龄或体长组集中在一起的模型更现实。但是一个模型可以是真实的和经验的结合。\n一般模型将具有非常广泛的适用性领域，即在许多情况下可以有效应用。在渔业科学的发展中，将许多描述特定过程的模型（例如，个体生长）纳入一个更普遍的数学模型，这些模型是特殊情况（见第5 章“静态模型”（Static Models））。通常这涉及增加所涉及的参数数量，但尽管如此，这些新模型显然在数学上更为通用。很难就这种更笼统的方程/模型是否不太现实得出结论。这将是一个问题，是否额外的参数可以现实地解释，或者它们是否只是临时解决方案，将不同的方程组合成一个更数学通用的方程。随着更复杂的现象，如年龄结构模型，一般模型通常不会给出准确的预测，因为更专业的模型调整到特定的情况。正因如此，建模人员在处理特定情况时，往往认为数学上一般模型不太现实（Maynard-Smith, 1974）。\n\n\n1.2.6 模型是理论\n所有模型都可能被认为具有理论成分，甚至被认为是经验模型。它成为一个感知问题，而不是模型结构。例如，通过简单的模型，基本假设可以开始承担假设断言的重担。因此，如果使用 logistic 方程来描述种群的增长，它就导入了种群增长率的密度依赖补偿与种群密度线性相关的假设。换言之，种群规模增长对种群增长的负面影响与种群规模呈线性关系（见第 3 章“简单种群模型”（Simple Population Models））。这可以被视为一个领域假设（即模型只能有效地应用于密度依赖效应与种群密度线性相关的情况）或理论（非线性密度依赖效应在建模的系统中不重要）。这显然是一个感知或建模目标的问题，即这两种可能性中哪一种是获得的。这是一个很好的理由，人们应该明确解释一个人的模型的假设。\n如果将自己局限于纯粹的经验关系，那么他的模型唯一可以改进的方法就是增加模型所解释的观测结果的方差。没有有效的期望，经验模型将提供洞察一个系统的未来行为。解释/理论模型的一个优点是，它应该能够检验假设、变量之间的关系和误差结构，独立于与观测结果的拟合质量。\n因此，应该有可能提出证据来支持一个模型，这超出了拟合的质量。那些建议的结构没有以这种方式得到支持的模型，也可能是经验性的。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>关于建模</span>"
    ]
  },
  {
    "objectID": "01-intro.html#结束语",
    "href": "01-intro.html#结束语",
    "title": "1  关于建模",
    "section": "1.3 结束语",
    "text": "1.3 结束语\n编写和讨论模型，它们的使用和构建有时是有价值的，因为它提醒我们在其中工作的框架。如果你想成为一名建模人员，对数学模型的优缺点的理论理解总是有价值的。然而，通常理解模型及其属性的最佳方法是实际使用它们，并通过操作它们的参数和检查它们在实践中如何操作来探索它们的属性。希望您会发现，使用 R 作为编程语言使这些探索相对容易实现。\n下面的材料包括非常一般的方法和其他更具体的方法。这本书的目的是鼓励你，也许是为你提供一个开始，发展你自己的分析功能，也许是通过修改本书中的一些内容。您可以这样做，以便您自己的分析变得更快、更容易，并且在某种程度上是自动化的，从而让您有更多的时间来思考和解释您的发现。如果您使用的是其他更少的程序性分析的话，您需要机械地进行分析的时间越少，就有越多的时间来思考科学问题并进行更深入的探索。使用R来实现您的建模的一个主要优势是，您所做的任何工作都应该变得更容易重复，因此，大概也更容易防御。当然，这里所涉及的主题范围只是触及了可用内容的表面，但试图探索一些基本方法，如最大似然估计。请记住，有大量的 R 包可用，这些可以帮助您实现自己的模型，无论是统计或动态。\n\n\n\n\n\n\nSchaefer, M. B. 1957. 《A study of the dynamics of the fishery for yellowfin tuna in the eastern tropical pacific ocean》. 收入. https://www.semanticscholar.org/paper/A-study-of-the-dynamics-of-the-fishery-for-tuna-in-Schaefer/29677d4a85d251d68d645584b2505c51c1ef1728.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>关于建模</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "使用 R 语言进行渔业建模和定量方法研究",
    "section": "",
    "text": "中文版本说明\n这是《Using R for Modelling and Quantitative Methods in Fisheries》（https://haddonm.github.io/URMQMF/）的 中文学习版本，中文版本由机器翻译而成，难免有误，仅供学习参考，更准确的版本请参考英文原版，如果发现有不妥之处或建议，请联系 shengfa@gmail.com。\n中文版本仅供个人使用，不得用于商业目的，所有版权归原作者所有，转载请注明出处。",
    "crumbs": [
      "中文版本说明"
    ]
  },
  {
    "objectID": "03-simpopmodel.html",
    "href": "03-simpopmodel.html",
    "title": "3  简单种群模型",
    "section": "",
    "text": "3.1 简介\n简单的种群模型构成了众多渔业模型的基础，事实上，渔业模型与生态种群模型的区别只是人为的划分。理解任何种群模型的运行方式都将有助于更好地理解渔业模型，因此在本章中，我们将使用R来检验种群生物学中的一些基本思想的动力学。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  },
  {
    "objectID": "03-simpopmodel.html#简介",
    "href": "03-simpopmodel.html#简介",
    "title": "3  简单种群模型",
    "section": "",
    "text": "3.1.1 离散Logistic模型\n我们将首先考察已成为生态学中经典种群模型之一的离散逻辑斯蒂模型所展示的动力学。这种模型出现在许多地方，以许多不同的形式出现，因此值得进行一些详细的探索。这里我们将使用 (Schaefer 1991) Schaefer(1954, 1957)版本，它有四个组成部分或项:\n\\[\n\\begin{aligned}\nN_{t=0} &= N_0 \\\\\nN_{t+1} &= N_t + rN_t \\left(1-\\left(\\dfrac{N_t}{K} \\right) \\right) -C_t\n\\end{aligned}\n\\qquad(3.1)\\]\n\\(N_t\\) 项为时间 \\(t\\) 时的数量（如年 \\(t\\) 的开始时），最后一项为 \\(C_t\\)，它是在时间 \\(t\\) 内（如年份 \\(t\\) ）捕获的渔获量。第一行反映了初始状态，定义为时间 \\(0\\) 时的数量（或生物量）。要注意下标，因为无论是数量还是生物量，它们都是指特定时间的数量和生物量，通常是确定的时间段 \\(t\\) 的开始时的数量或生物量，而渔获量指的是整个时间段 \\(t\\) 内的渔获量。这个方程是对时间步长\\(t\\)的动力学的总结； 它是一个差分方程而不是连续微分方程。第二个方程的中间项是更复杂的组成部分，该项定义了所谓的渔业生产曲线。它由 \\(r\\) 和 \\(K\\) 组成，\\(r\\) 为种群的内在增长率， \\(K\\) 为承载力或最大种群规模。如果动力学表示为在开发开始之前处于平衡状态，那么 \\(N_0\\) 会取与 \\(K\\) 相同的值，但它是分开的，以考虑任何时间序列开始时偏离均衡的情况。在 MQMF 的 discretelogistic() 中，你会看到另一个参数 \\(p\\)，这个参数将在“剩余产量模型”中详细探讨。在此，只需说明的是，当使用默认值 \\(p=1.0\\) 时， 公式 3.1 中的方程等同于 Schaefer 模型。这里，Schaefer 模型输出实时数量，尽管在渔业中，它通常直接用实时生物量（\\(B_t\\)）表示。这些术语可以以这种方式改变，这一事实强调了该模型忽略了生物学实际和属性，如种群体长结构和年龄结构，以及性别和其他属性之间的差异。令人惊讶的是，这样一个简单的模型在理论和实践中仍然是有用的。\n我们可以通过将式 公式 3.1 的中间项与 \\(N_t\\) 值的向量绘制成曲线来说明产量曲线。子项 \\(rN_t\\) 表示无限制的种群指数增长，在这个离散形式的方程中，并将此项与 \\(N_t\\) 相加。因此，只要 \\(r&gt;0.1\\)及渔获量为0，我们就可以期待从方程的 \\(N_t+rN_t\\) 部分得到种群的无尽增长。然而,子项 \\((1−(N_t/K))\\) 为抑制指数增长的项，而且随着种群规模的增长，这种作用越来越大。这就是所谓的密度依赖效应。\n\n代码surprod &lt;- function(Nt,r,K) return((r*Nt)*(1-(Nt/K)))  \ndensdep &lt;- function(Nt,K) return((1-(Nt/K)))  \nr &lt;- 1.2; K &lt;- 1000.0; Nt &lt;- seq(10,1000,10)  \npar(mfrow=c(2,1),mai=c(0.4,0.4,0.05,0.05),oma=c(0.0,0,0.0,0.0))   \npar(cex=0.75, mgp=c(1.35,0.35,0), font.axis=7,font=7,font.lab=7)   \nplot1(Nt,surprod(Nt,r,K),xlab=\"Population Nt\",defpar=FALSE,  \n      ylab=\"Production\")  \nplot1(Nt,densdep(Nt,K),xlab=\"Population Nt\",defpar=FALSE,  \n      ylab=\"Density-Dependence\")  \n\n\n\n\n\n\n图 3.1: 离散 Schaefer（1954，1957）剩余生产模型的完整生产曲线以及与种群大小相当的等效线性密度依赖关系。\n\n\n\n\n密度依赖是种群规模调节的重要组成部分 (May 和 McLean 2007)。从 图 3.1 可以明显看出，Schaefer 模型中的密度依赖项与种群规模呈线性递减关系。这就是”线性密度依赖”一词的字面意思，你可以在种群动态文献中找到它。这个密度依赖项，试图补偿由 \\(rN_t\\) 驱动的指数增长 ，限制种群规模不大于未捕捞种群规模\\(K\\)的长期平均(关于补偿不足时会发生什么，请参阅下一节)。\n\n3.1.2 动态行为\n众所周知，微分方程形式的 Schaefer 模型一直非常稳定，最大种群数量真正受限于 \\(K\\) 值。令人惊讶的是，人们发现离散形式的动力学更为复杂和有趣 (May, 1973，1976)。我们已经在函数 discretelogistic() 中实现了上述方程的一种形式，你可以通过 ?discrete telogistic 读取它的帮助文件，并且可以通过在控制台输入 discretelogistic 来查看它的代码(注意，没有括号)。如果您检查这个函数中的代码，您将看到它使用 for 循环来逐年间计算每年的资源量。我希望，作为一名 R 程序员，您会想知道为什么我不使用向量化方法来避免使用 for 循环。这突出了种群动力学的一个基本方面，即 \\(t\\) 时的数量总是 \\(t-1\\) 时数量的函数(初始条件可能于 \\(N_0\\) 参数)。种群动态的顺序性质意味着我们不能以任何有效的方式使用矢量化。种群动态的顺序性是如此明显的事实，以至于它施加在种群模型上的约束和结构常常被忽视。\ndiscretelogistic() 函数（隐形）输出时间矩阵， \\(year\\)（用 year 表示）、\\(t\\) 时的数量 \\(n_t\\) （表示为 \\(nt\\) ）以及 \\(t+1\\) 时的数量 \\(n_{t+1}\\)（表示为 \\(nt1\\) ）的矩阵。该矩阵也给出 MQMF 中包含的了 dynpop 类和S3方法（plot.dynpop；见A non-introduction to R 一章S3类和方法的使用。如果要查看代码，在控制台中输入MQMF:::plot.dynpop，记住当中是3个”:“，而非2个）。当然，可以写任何想写的东西。试着将rv的值 设定为0.5、1.95、2.2、2.475、2.56和2.8，用这些值按顺序运行下面的代码。\n如果你运行生成 图 3.2 的代码，使用上面提到的6个rv值，你应该会看到一个单调阻尼平衡(一个实心点)，然后是一个阻尼振荡平衡(仍然是一个实心点)，然后是介于阻尼振荡平衡和两环稳定极限环之间的东西(有点涂抹了两个实心点)。当 \\(r = 2.475\\) 时，有一个 4 圈稳定的极限环( 4 个实心点)，当 \\(r = 2.56\\) 时，有一个 8 圈稳定的极限环。最后，当 \\(r = 2.8\\) 时，动态以混乱告终，尽管所有的点都落在如图所示的抛物线上，但每一步的结果都不是随机的，也不是直接可预测的。在混沌理论中，这个抛物线被称为奇怪的吸引子，尽管这是一个非常简单的吸引子。这种混沌系统也依赖于起始条件。如果把初始数字改为 101 而不是 100，数字的时间线就会发生根本性的变化，尽管抛物线保持不变。当然，我们可以输入任意范围的数字，也可以使用稍微不同的模型来改变动态。虽然混乱很有趣，玩起来也很有趣 (Gleick，1988；Lauwerier, 1991)，但在模拟自然种群的实际应用中似乎很少有用。事实上，一些人声称，他们观察到的明显的随机性是由种群对随机环境效应的反应引起的，而不是由密度依赖模型中的补偿不足和补偿过度引入的非线性（Higgins等，1997）。\n\n代码 #Code for Figure 3.2. Try varying the value of rv from 0.5-2.8  \nyrs &lt;- 100; rv=2.8;  Kv &lt;- 1000.0; Nz=100; catch=0.0; p=1.0  \nans &lt;- discretelogistic(r=rv,K=Kv,N0=Nz,Ct=catch,Yrs=yrs,p=p)  \navcatch &lt;- mean(ans[(yrs-50):yrs,\"nt\"],na.rm=TRUE) #used in text  \nlabel &lt;- paste0(\"r=\",rv,\" K=\",Kv,\" Ct=\",catch, \" N0=\",Nz,\" p=\",p=p)  \nplot(ans, main=label, cex=0.9, font=7) #Schaefer dynamics  \n\n\n\n\n\n\n图 3.2: Schaefer 模型动态。左图是按年份的数值，展示了从 r 值为 2.8 开始的混沌动态。右图是时间 t+1 的数值与时间 t 的关系，称为相图。最后 20%的点用红色标出以展示任何平衡行为。灰色对角线是 1:1 线。\n\n\n\n\n在实际应用中，如果发现模型表现出明显的混沌或周期性行为，甚至是负的种群数量，尝试确定所观察到的现象是真实的生物群体行为(显然不是负数)，还是更简单地说，只是一个特殊参数的数学表达式。人们总是可以通过在计算中包含诸如 \\(max((B_t+(rB_t)(1-(B_t/K))-C_t),0)\\) 之类以避免模型向下跌落到0以下（参见 discretelogistic() 代码。类似地，用 \\(min((B_t+(rB_t)(1-(B_t/K))-C_t),1.1K)\\) 以避免计算值高于\\(K\\)），尽管对代码的此类添加仍然是临时的（应该，比如，任何超过\\(K\\)的值都应允许，是 \\(1.1K\\)，还是 \\(1.0K\\)？有些种群自然变动的）。在第 7 章 “剩余产量模型” 一章中我们将研究惩罚函数的使用，惩罚函数可用于防止在估计这些参数时产生异常值，同时避免使用，如 \\(max(\\cdots，0)\\) 这类粗糙的工具。\n我们可以通过将 discretelogistic() 函数的不可见输出转换为可以使用的对象来检查每年的实际资源量（表 3.1）。\n\n代码#run discrete logistic dynamics for 600 years  \nyrs=600  \nans &lt;- discretelogistic(r=2.55,K=1000.0,N0=100,Ct=0.0,Yrs=yrs)  \n\n\n\n代码# layout-ncol: 1\n\nkable(halftable(ans[(yrs-29):yrs,],yearcol=\"year\",subdiv=3),\n      digits=c(0,1,1,0,1,1,0,1,1))\n\n\n表 3.1: ans 对象中最后 30 个按年排列的数字，展示了在 r = 2.2 时呈现 8 周期稳定极限。如果你在 discretelogistic() 中尝试 r = 2.2，它将导致 2 周期稳定极限在 746.24 和 1162.84 之间波动。尝试使用 plot(ans) 并观察每次变化。\n\n\n\n\nyear\nnt\nnt1\nyear\nnt\nnt1\nyear\nnt\nnt1\n\n\n\n571\n493.9\n1131.3\n581\n752.4\n1227.4\n591\n515.6\n1152.4\n\n\n572\n1131.3\n752.4\n582\n1227.4\n515.6\n592\n1152.4\n704.5\n\n\n573\n752.4\n1227.4\n583\n515.6\n1152.4\n593\n704.5\n1235.4\n\n\n574\n1227.4\n515.6\n584\n1152.4\n704.5\n594\n1235.4\n493.9\n\n\n575\n515.6\n1152.4\n585\n704.5\n1235.4\n595\n493.9\n1131.3\n\n\n576\n1152.4\n704.5\n586\n1235.4\n493.9\n596\n1131.3\n752.4\n\n\n577\n704.5\n1235.4\n587\n493.9\n1131.3\n597\n752.4\n1227.4\n\n\n578\n1235.4\n493.9\n588\n1131.3\n752.4\n598\n1227.4\n515.6\n\n\n579\n493.9\n1131.3\n589\n752.4\n1227.4\n599\n515.6\n1152.4\n\n\n580\n1131.3\n752.4\n590\n1227.4\n515.6\n600\n1152.4\n704.5\n\n\n\n\n\n\n\n\n当我们设置 \\(r\\) 值来产生2循环的稳定限制(例如 \\(r＝2.2\\) )，可以从其他年份的数值重复中清楚地看到。检查实际的数值显然比相信图表的视觉印象更准确。这也意味着我们可以尽可能详细地查看结果。在上述情况下，最近50年的平均渔获量为859.675，明显小于1000的\\(K\\)值。由于 \\(N_{t+1}\\) 与 \\(N_t\\) 的相位关系，上一年的最后一行通常不会有 \\(N_{t+1}\\) 的值，因此，在代码中，输入的年份数增加1，以便最终生成 \\(N_{t+1}\\) (请参阅代码)。\n\n3.1.3 确定行为间的边界\n我们可以通过求 ans 中 \\(nt\\) 和 \\(Nt1\\) 列的行平均值来找到一个稳定的限制循环，查看最后 100 个值(四舍五入到小数点后三位)。table() 函数的名称标识循环点的值(如果有的话)。如果只有一个或两个平均值来确定一个渐近平衡或一个两周期稳定的限制循环。通过检查每个 ans 对象中值的时间序列，可以搜索所标识值的首次出现，从而确定循环行为（精确到小数点后三位）何时首次出现。我们将这些值四舍五入，并使用 600 年或更长的时间，因为如果我们使用所有 15 位小数，任何超过 8 的循环都可能无法被清楚地识别出来（尝试将 r = 2.63 更改为 5；并试着用 plot(ans) 绘图）。\n\n代码 #run discretelogistic and search for repeated values of Nt  \nyrs &lt;- 600  \nans &lt;- discretelogistic(r=2.55,K=1000.0,N0=100,Ct=0.0,Yrs=yrs)  \navt &lt;- round(apply(ans[(yrs-100):(yrs-1),2:3],1,mean),2)  \ncount &lt;- table(avt)  \ncount[count &gt; 1] # with r=2.55 you should find an 8-cycle limit  \n\navt\n812.64 833.99 864.65  871.5 928.45 941.88 969.92 989.93 \n    12     13     12     13     12     13     12     13 \n\n\n我们可以建立一个程序来寻找 \\(r\\) 的值生成不同周期的稳定限制环，尽管下面的代码只是部分成功。通过设置一个 for 循环，将不同的值替换为 \\(r\\) 值输入到 discretelogistic()，我们可以搜索一个长时间序列的最后几年在数值的时间序列中唯一的值。然而，四舍五入误差可能会导致意想不到的结果，特别是在不同类型的动态行为之间的边界。我们可以通过将检查的数值四舍五入到小数点后三位来避免这些问题，但请尝试在下面的代码中散列该行，以查看问题变得更糟。\n\n代码#searches for unique solutions given an r value  see Table 3.2\ntestseq &lt;- seq(1.9,2.59,0.01)  \nnseq &lt;- length(testseq)  \nresult &lt;- matrix(0,nrow=nseq,ncol=2,  \n                 dimnames=list(testseq,c(\"r\",\"Unique\")))  \nyrs &lt;- 600  \nfor (i in 1:nseq) {  # i = 31  \n   rval &lt;- testseq[i]  \n   ans &lt;- discretelogistic(r=rval,K=1000.0,N0=100,Ct=0.0,Yrs=yrs)  \n   ans &lt;- ans[-yrs,] # remove last year, see str(ans) for why  \n   ans[,\"nt1\"] &lt;- round(ans[,\"nt1\"],3) #try hashing this out  \n   result[i,] &lt;- c(rval,length(unique(tail(ans[,\"nt1\"],100))))  \n}  \n\n\n在上面的例子中，在 \\(r\\) 值的范围内，最近的100次观测中，最多可以产生60个唯一值。这些代表了计算机上舍入误差的问题。如果持续运行的年数显著增加，那么预期最终会出现一种平衡。无论哪种情况，都存在一个明显的分裂或过渡，从单一平衡点，到2循环，到4循环，最后到8循环稳定极限。在行为的每个转变中，由于舍入误差，结果有一些不稳定性。\n\n代码kable(halftable(result,yearcol = \"r\", subdiv=3),digits=c(0,1,1,0,1,1,0,1,1))  \n\n\n表 3.2: Schaefer 模型动态。结果内容：在 600 年的预测动态中，从不同 r 值获得的 60 年内独特种群数量（N）。100 表示非平衡甚至混沌。\n\n\n\n\nr\nUnique\nr\nUnique\nr\nUnique\n\n\n\n2\n1\n2.1\n2\n2.4\n2\n\n\n2\n1\n2.1\n2\n2.4\n2\n\n\n2\n1\n2.2\n2\n2.4\n2\n\n\n2\n1\n2.2\n2\n2.4\n2\n\n\n2\n1\n2.2\n2\n2.4\n2\n\n\n2\n1\n2.2\n2\n2.4\n2\n\n\n2\n1\n2.2\n2\n2.4\n4\n\n\n2\n1\n2.2\n2\n2.5\n100\n\n\n2\n7\n2.2\n2\n2.5\n4\n\n\n2\n100\n2.2\n2\n2.5\n4\n\n\n2\n100\n2.2\n2\n2.5\n4\n\n\n2\n4\n2.2\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n4\n\n\n2\n2\n2.3\n2\n2.5\n8\n\n\n2\n2\n2.3\n2\n2.6\n8\n\n\n2\n2\n2.3\n2\n2.6\n100\n\n\n2\n2\n2.3\n2\n2.6\n100\n\n\n2\n2\n2.4\n2\n2.6\n100\n\n\n2\n2\n2.4\n2\nNA\nNA\n\n\n2\n2\n2.4\n2\nNA\nNA\n\n\n\n\n\n\n\n\n\n3.1.4 经典的混沌分岔图\nMay(1976) 对基于差分方程的单物种种群模型的动力学进行了综述。文中，他从非常简单的模型描述了混沌动力学的潜力。在那篇文章中，他绘制了一个图，他称之为分岔图（bifurcation diagram），该图显示了模型的平衡属性如何随着单个参数的改变而改变。我们可以使用discretelogistic()函数和下面的代码，以几乎任何精度复制 图 3.3 。\n在分岔图的混沌中，偶尔会有一些简化，由图中的白色间隙表示出来。可以通过替换 testseq 向量中的数值来检查其中的下限位置，如下限值=2.82，上限= 2.87和inc = 0.0001 。这些起始点提供了更多的细节，在这些细节中有以前被掩盖的细节。这些也可以通过改变数值testseq &lt; - c(2.845, 2.855, 0.00001) 检查，于是分岔,2 - 4 -和更高的周期可以看到(甚至可以看到更多的细节通过改变limy= 0 参数绑定y-轴在 \\(limy=c(600, 750)\\) 内感兴趣的区域绑定y轴所需的范围。这个图是通过在每个r的序列值处使用最终尾&lt;- 100点绘制的。可以增加模拟的年数和绘制的最终点的数量，以获得更好的分辨率在混沌区域。要查看更多细节，请在需要细节的区域扩展规模。\n\n代码 #the R code for the bifurcation function  \nbifurcation &lt;- function(testseq,taill=100,yrs=1000,limy=0,incx=0.001){  \n  nseq &lt;- length(testseq)  \n  result &lt;- matrix(0,nrow=nseq,ncol=2,  \n                  dimnames=list(testseq,c(\"r\",\"Unique Values\")))  \n  result2 &lt;- matrix(NA,nrow=nseq,ncol=taill)  \n  for (i in 1:nseq) {    \n     rval &lt;- testseq[i]  \n     ans &lt;- discretelogistic(r=rval,K=1000.0,N0=100,Ct=0.0,Yrs=yrs)  \n     ans[,\"nt1\"] &lt;- round(ans[,\"nt1\"],4)  \n     result[i,] &lt;- c(rval,length(unique(tail(ans[,\"nt1\"],taill))))  \n     result2[i,] &lt;- tail(ans[,\"nt1\"],taill)  \n  }    \n  if (limy[1] == 0) limy &lt;- c(0,getmax(result2,mult=1.02))  \n  parset() # plot taill values against taill of each r value  \n  plot(rep(testseq[1],taill),result2[1,],type=\"p\",pch=16,cex=0.1,  \n   ylim=limy,xlim=c(min(testseq)*(1-incx),max(testseq)*(1+incx)),  \n    xlab=\"r value\",yaxs=\"i\",xaxs=\"i\",ylab=\"Equilibrium Numbers\",  \n     panel.first=grid())  \n  for (i in 2:nseq)  \n      points(rep(testseq[i],taill),result2[i,],pch=16,cex=0.1)  \n  return(invisible(list(result=result,result2=result2)))  \n} # end of bifurcation  \n\n\n\n代码#Alternative r value arrangements for you to try; Fig 3.3  \n #testseq &lt;- seq(2.847,2.855,0.00001) #hash/unhash as needed \n #bifurcation(testseq,limy=c(600,740),incx=0.0001) # t  \n #testseq &lt;- seq(2.6225,2.6375,0.00001) # then explore   \n #bifurcation(testseq,limy=c(660,730),incx=0.0001)   \ntestseq &lt;- seq(1.9,2.975,0.0005) # modify to explore  \nbifurcation(testseq,limy=0)    \n\n\n\n\n\n\n图 3.3: Schaefer 模型动态。一个经典的分岔图（May，1976），绘制了平衡动态与 r 值的函数关系，展示了从 2-、4-、8-循环以及混沌行为的转变。\n\n\n\n\n\n3.1.5 捕捞对种群动态的影响\n如果我们设置一个默认的 discretelogisitic() 运行，以在渔获量为零时拥有8个周期的稳定极限，我们可以应用不同水平的恒定渔获量，看看这可能如何影响动态。在这里，我们应用了 0,50,200 和 325 个个体(尽管 \\(N_t\\)，\\(K\\) 和 \\(C_t\\) 也可能是吨)。当然是初始值 \\(N_0\\) 必须大于捕获值，否则可以自由更改值。在下面四种情况中，我们假设 \\(p\\) 值为 1.0 (= Schaefer模型)时，可以尝试 \\(p=1e−08\\) 探讨使用与 Fox 模型等价的方法所产生的差异。\n\n代码 #Effect of catches on stability properties of discretelogistic  \nyrs=50; Kval=1000.0  \nnocatch &lt;- discretelogistic(r=2.56,K=Kval,N0=500,Ct=0,Yrs=yrs)  \ncatch50 &lt;- discretelogistic(r=2.56,K=Kval,N0=500,Ct=50,Yrs=yrs)  \ncatch200 &lt;- discretelogistic(r=2.56,K=Kval,N0=500,Ct=200,Yrs=yrs)  \ncatch300 &lt;- discretelogistic(r=2.56,K=Kval,N0=500,Ct=300,Yrs=yrs)  \n\n\n我们组合了一个小函数 plottime()，以简化最终对象的重复绘图。我们还使用了效用函数 parsyn() 来辅助 par() 函数的语法，以定义基本图形图的边界。请注意，生成这样的函数可以简化后续的代码，我建议构建这样一个有用的函数集合，可以与函数 source() 一起使用，将它们引入到自己的会话中(就像预包;不要忘记在编写函数时记录文档，RStudio 甚至有一个插入 Roxygen 骨架命令)。在这里，随着捕获量的增加，可以看到动态开始稳定 4 到 2 周期，然后渐近平衡。注意，随着渔获量的增加，随着时间的推移(图表底部的数字)，平均渔获量下降。\n\n代码 #Effect of different catches on n-cyclic behaviour Fig3.4  \nplottime &lt;- function(x,ylab) {  \n   yrs &lt;- nrow(x)  \n   plot1(x[,\"year\"],x[,\"nt\"],ylab=ylab,defpar=FALSE)  \n   avB &lt;- round(mean(x[(yrs-40):yrs,\"nt\"],na.rm=TRUE),3)  \n   mtext(avB,side=1,outer=F,line=-1.1,font=7,cex=1.0)   \n} # end of plottime  \n #the oma argument is used to adjust the space around the graph  \npar(mfrow=c(2,2),mai=c(0.25,0.4,0.05,0.05),oma=c(1.0,0,0.25,0))   \npar(cex=0.75, mgp=c(1.35,0.35,0), font.axis=7,font=7,font.lab=7)    \nplottime(nocatch,\"Catch = 0\")  \nplottime(catch50,\"Catch = 50\")  \nplottime(catch200,\"Catch = 200\")  \nplottime(catch300,\"Catch = 300\")  \nmtext(\"years\",side=1,outer=TRUE,line=-0.2,font=7,cex=1.0)   \n\n\n\n\n\n\n图 3.4: Schaefer 模型动态。左上角的图描绘了未捕捞的预期动态（8 周期），而接下来的三个图，随着平均捕捞量的减少，说明了捕捞量增加而其他因素不变的影响。\n\n\n\n\n我们可以对四个相图做一些类似的事情。这里，我们从 MQMF:::plot.dynpop() 函数中借用了部分代码，以定义一个小型定制函数，以方便一起绘制四个阶段的图。\n\n代码#Phase plot for Schaefer model Fig 3.5  \nplotphase &lt;- function(x,label,ymax=0) { #x from discretelogistic  \n  yrs &lt;- nrow(x)  \n  colnames(x) &lt;- tolower(colnames(x))  \n  if (ymax[1] == 0) ymax &lt;- getmax(x[,c(2:3)])  \n  plot(x[,\"nt\"],x[,\"nt1\"],type=\"p\",pch=16,cex=1.0,ylim=c(0,ymax),  \n       yaxs=\"i\",xlim=c(0,ymax),xaxs=\"i\",ylab=\"nt1\",xlab=\"\",  \n       panel.first=grid(),col=\"darkgrey\")  \n  begin &lt;- trunc(yrs * 0.6) #last 40% of yrs = 20, when yrs=50  \n  points(x[begin:yrs,\"nt\"],x[begin:yrs,\"nt1\"],pch=18,col=1,cex=1.2)  \n  mtext(label,side=1,outer=F,line=-1.1,font=7,cex=1.2)   \n} # end of plotphase  \npar(mfrow=c(2,2),mai=c(0.25,0.25,0.05,0.05),oma=c(1.0,1.0,0,0))   \npar(cex=0.75, mgp=c(1.35,0.35,0), font.axis=7,font=7,font.lab=7)    \nplotphase(nocatch,\"Catch = 0\",ymax=1300)  \nplotphase(catch50,\"Catch = 50\",ymax=1300)  \nplotphase(catch200,\"Catch = 200\",ymax=1300)  \nplotphase(catch300,\"Catch = 300\",ymax=1300)  \nmtext(\"nt\",side=1,outer=T,line=0.0,font=7,cex=1.0)  \nmtext(\"nt+1\",side=2,outer=T,line=0.0,font=7,cex=1.0)  \n\n\n\n\n\n\n图 3.5: Schaefer 模型动态。四个持续捕捞场景的相图。\n\n\n\n\n随着固定捕获量的增加，隐含抛物线曲线(奇异吸引子)的最大值下降。渔获量(\\(\\equiv\\) 捕食者)似乎对种群的动态有稳定的影响。在自然界中是否如此，将取决于特定种群的生物学是否反映了用于描述动态的模型的基本假设(例如，Schaefer 模型假设种群中存在线性密度依赖)。\n现在，我们应该很清楚，即使是简单的模型也可以表现出复杂的行为。我们只是稍微触及了这个主题，但同样清楚的是，使用 R，可以探索这些想法到任何深度。\n\n3.1.6 决定论\n本章所有的模型都表现出确定性动力学，即使是混沌动力学，在初始条件重复的情况下也会遵循相同的轨迹。当然，在自然界中，这种确定性行为是罕见的。模型总是对可能发生的事情进行抽象。与生产力相关的自然过程(自然死亡率、生长和繁殖)都将随着时间的推移而变化，这是对食物供应、生态相互作用和环境影响(如温度)的响应。通过包括所谓的过程误差，可以将过程中的这种可变性近似地包括到模型中，过程误差可以用方程形式表示为:\n\\[\n{N_{t+1}}={N_t}+{({r+\\varepsilon_t}){N_t}}\\left( 1-{{\\left( \\frac{N_t}{(K+\\varepsilon_t)} \\right)}} \\right)\n\\qquad(3.2)\\]\n其中 \\(\\varepsilon\\) 和 \\(\\epsilon\\) 表示每个模型参数随时间 \\(t\\) 变化的正态随机误差。有时，在模拟中，只有一个参数会添加变化。作为种群现象，这将导致种群数量遵循不一定是平滑的轨迹，而且在模拟中，单个复制将不足以捕捉可能的动态的潜在范围。在模拟中是否包括这种过程误差将取决于模拟的目的。在这里，目的是探索确定性种群动态的期望，但应该始终记住，这些模型只是近似，旨在代表平均行为。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  },
  {
    "objectID": "03-simpopmodel.html#年龄结构的建模概念",
    "href": "03-simpopmodel.html#年龄结构的建模概念",
    "title": "3  简单种群模型",
    "section": "\n3.2 年龄结构的建模概念",
    "text": "3.2 年龄结构的建模概念\n当然，在我们刚刚考察的剩余产量模型中，最大的简化是，它们忽略了与年龄和个体大小有关的生物学和行为差异的所有方面。这种简化的模型仍然有用(见第 7 章“剩余产量模型”（Surplus Production Models） )，但面对公认的网具选择性(类似于捕食者有偏好的猎物)和不同年龄的生长和繁殖力、渔业和其他自然资源科学家经常在他们的模型中包括年龄和或大小。在这里，我们将只对这些想法进行初步处理，因为在详细讨论这些复杂问题之前，还需要建模动态过程的许多其他细节。\n\n3.2.1 世代中的残存\n很明显，个体的残存，\\(S\\)，两个时间段之间的残存可用 \\(t+1\\) 时的数量与 \\(t\\) 时的数量的比值表示(记住，如果知道体重与年龄的关系，年龄-数量可以转换为年龄-体质量或年龄-生物量):\n\\[\nS_t=\\frac{{{N}_{t+1}}}{{{N}_{t}}} \\quad \\text{ or }\\quad {{N}_{t+1}}={S_t}{N}_{t}\n\\qquad(3.3)\\]\n这种随时间的比例减少暗示着负指数增长。给定瞬时总死亡率为 \\(Z\\) (自然死亡率和捕捞死亡率之和)，则每年的残存率(即存活的比例)等于 \\(e^{−Z}\\)。这可以通过设置一个具有恒定初始条件的模拟种群，并应用不同瞬时总死亡率向量来说明。\n这将相当于考虑一个单一世代补充的为 0+ 年龄的个体。假设没有移入个体，这样的单一世代种群只能在数量上下降，尽管这看起来很明显，但在考虑年龄结构的种群时，这是重要的直觉。总死亡率(通常用 \\(Z\\) 表示)仅仅是自然死亡率(通常用 \\(M\\) 表示)和捕捞死亡率(通常用 \\(F\\) 表示)的总和。在下面的例子中，请注意，应用\\(Z =0.05\\) 会导致即使在 50 年后种群数量也大于零。图示中的每个世代轨迹都描述了种群规模的指数或恒定比例下降。\n\n代码#Exponential population declines under different Z. Fig 3.6  \nyrs &lt;- 50;  yrs1 &lt;- yrs + 1 # to leave room for B[0]  \nyears &lt;- seq(0,yrs,1)  \nB0 &lt;- 1000        # now alternative total mortality rates  \nZ &lt;- c(0.05,0.1,0.2,0.4,0.55)   \nnZ &lt;- length(Z)  \nBt &lt;- matrix(0,nrow=yrs1,ncol=nZ,dimnames=list(years,Z))  \nBt[1,] &lt;- B0  \nfor (j in 1:nZ) for (i in 2:yrs1) Bt[i,j] &lt;- Bt[(i-1),j]*exp(-Z[j])  \nplot1(years,Bt[,1],xlab=\"Years\",ylab=\"Population Size\",lwd=2)  \nif (nZ &gt; 1) for (j in 2:nZ) lines(years,Bt[,j],lwd=2,col=j,lty=j)  \nlegend(\"topright\",legend=paste0(\"Z = \",Z),col=1:nZ,lwd=3,  \n       bty=\"n\",cex=1,lty=1:5)   \n\n\n\n\n\n\n图 3.6: 不同总死亡率水平下的指数型种群衰退。最上方的曲线是 Z = 0.05，最陡峭的曲线是 Z = 0.55。\n\n\n\n\n\n3.2.2 瞬时 Vs 年死亡率\n在前一节中，我们讨论了所谓的瞬时率。它们可以用来生成残存率，即在给定瞬时死亡率的一年后预期残存的比例。瞬时死亡率的概念是指在无限小的时间段内的死亡率。\n我们已经知道每年残存的比例:\n\\[\nS={e}^{-Z}\n\\qquad(3.4)\\]\n因此1年时间死亡率（ \\(A\\) ）表示为：\n\\[\nA=1-{e}^{-Z}\n\\qquad(3.5)\\]\n如果只考虑瞬时捕捞死亡率 \\(F\\)，而忽略自然死亡率，则死亡的比例称为捕获率，\\(H\\)。\n\\[\nH=1-{e}^{-F}\n\\qquad(3.6)\\]\n如果知道了每年的捕获率，就可以将其反向转换来估计瞬时捕捞死亡率。\n\\[\nF=-\\log{(1-H)}\n\\qquad(3.7)\\]\n其中 log 是自然对数或以 \\(e\\) 为底的对数。\n有时似乎很难直观地理解瞬时速率的含义。如果举例说明瞬时率是如何推导出来的，这个困难就会减轻。从 1000 个个体的种群开始，假设每年的移除率为 \\(0.5\\)，这意味着只有 500 个个体能存活一年。将年总死亡率代入最后一个方程，可估计瞬时总死亡率为 \\(-\\log(1-0.5) = 0.693147\\)。如果我们使用两个 6 个月周期来近似这个水平所需的时间步长，以获得 50% 的存活率，我们需要将 0.693147 除以 2.0，并将死亡率用 2 次。类似地，如果时间步长是每月的，我们将除以 12，并将结果应用 12 次。虽然很难将每个月称为瞬时，但这将是适用近似瞬时死亡率 (0.693147/12) 的期间。这种重新缩放可以在越来越小的时间间隔中发生，直到时间间隔足够小，结果与预期的 500 个年终剩余个体没有显著差异（ 表 3.3 ）。\n显而易见，应用近似瞬时速率的时间间隔越短，最终值就越接近预期的1000的0.5(即500)。希望这些代码能够帮助您对瞬时死亡率概念有直观的了解。\n可以根据瞬时死亡率绘制年死亡率图，以说明两者之间的差异。请注意，瞬时死亡率大约 为 0.18 时，年收捕获 率也大致相同。应该清楚的是，不可能获得大于 1.0 的捕获率(相当于捕获&gt;100%的可开发生物量)。高的捕获率开始显得难以置信，如果它们出现在适合渔业模式的情况下，那么在被接受之前，它们确实需要得到保护。另一方面，瞬时率显然可以超过 1.0，但理想情况下，这样的事件不应再被误解。\n\n代码 #Prepare matrix of harvest rate vs time to appoximate F  \nZ &lt;- -log(0.5)  \ntimediv &lt;- c(2,4,12,52,365,730,2920,8760,525600)  \nyrfrac &lt;- 1/timediv  \nnames(yrfrac) &lt;- c(\"6mth\",\"3mth\",\"1mth\",\"1wk\",\"1d\",\"12h\",  \n                   \"3h\",\"1h\",\"1m\")  \nnfrac &lt;- length(yrfrac)  \ncolumns &lt;- c(\"yrfrac\",\"divisor\",\"yrfracH\",\"Remain\")  \nresult &lt;- matrix(0,nrow=nfrac,ncol=length(columns),  \n                 dimnames=list(names(yrfrac),columns))  \nfor (i in 1:nfrac) {  \n   timestepmort &lt;- Z/timediv[i]   \n   N &lt;- 1000  \n   for (j in 1:timediv[i]) N &lt;- N * (1-timestepmort)  \n   result[i,] &lt;- c(yrfrac[i],timediv[i],timestepmort,N)  \n}  \n\n\n\n代码kable(result,digits=c(10,0,8,4)) \n\n\n表 3.3: 将恒定的总死亡率分配到越来越短的时间段内，且这些时间段总和为一年时的结果。yrfrac 是一年的分数，Approx 是瞬时总死亡率除以除数，Remain 是一年后剩余的动物数量（从 1000 开始计算）。\n\n\n\n\n\nyrfrac\ndivisor\nyrfracH\nRemain\n\n\n\n6mth\n0.5000000000\n2\n0.34657359\n426.9661\n\n\n3mth\n0.2500000000\n4\n0.17328680\n467.1104\n\n\n1mth\n0.0833333333\n12\n0.05776227\n489.6953\n\n\n1wk\n0.0192307692\n52\n0.01332975\n497.6748\n\n\n1d\n0.0027397260\n365\n0.00189903\n499.6706\n\n\n12h\n0.0013698630\n730\n0.00094952\n499.8354\n\n\n3h\n0.0003424658\n2920\n0.00023738\n499.9589\n\n\n1h\n0.0001141553\n8760\n0.00007913\n499.9863\n\n\n1m\n0.0000019026\n525600\n0.00000132\n499.9998\n\n\n\n\n\n\n\n\n\n代码#Annual harvest rate against instantaneous F, Fig 3.7  \nFi &lt;- seq(0.001,2,0.001)  \nH &lt;- 1 - exp(-Fi)  \nparset()  # a wrapper for simplifying defining the par values  \nplot(Fi,H,type=\"l\",lwd=2,panel.first=grid(),  \n     xlab=\"Instantaneous Fishing Mortality F\",  \n     ylab=\"Annual Proportion Mortality H\")  \nlines(c(0,1),c(0,1),lwd=2,lty=2,col=2)  \n\n\n\n\n\n\n图 3.7: 瞬时捕捞死亡率（实线）与年度捕捞死亡率或年度收获率（虚线）之间的关系。在 F 值大于约 0.2 时，数值开始分离。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  },
  {
    "objectID": "03-simpopmodel.html#简单单位补充量渔获量",
    "href": "03-simpopmodel.html#简单单位补充量渔获量",
    "title": "3  简单种群模型",
    "section": "\n3.3 简单单位补充量渔获量",
    "text": "3.3 简单单位补充量渔获量\n我们知道，一旦某一世代补充到群体中，其数量只会减少(假设没有迁入)。注意”补充量（recruitment）“的概念，它可以指后期仔鱼进入资源后，然而，它也可以指个体变得可用或易受渔业损害。这里我们关注的是仔鱼后加入资源后的情况。当我们在下面和第 5 章“静态模型”（Static Models）的章节中考虑选择性和可用性概念时，我们将处理补充量加入到渔业。有趣的是,尽管数字预计将减少通过时间,鉴于个体体长和重量上生长，我们还不知道如果世代的质量总是随时间减少或者增加然后减少最终所有的个体死亡。\n一个世代的质量是否会在几年内增加，即使它的数量首次发现下降，因为对于捕获和努力之间的关系有一种简单但普遍的直觉。很明显，一种鱼类的渔获量总是会随着捕捞努力量的增加而增加，但这只是短期的想法。这个看似显而易见的概念在1930年之前就被驳斥了，并被 Russell (1942) 的一些出版著作很好地阐述了，他证明了一个渔业的最大持续渔获量不一定来自于最大努力量(或最大捕捞死亡)。这不仅是一个学术问题，而且直接关系到渔业的管理。一旦人们意识到过度捕捞甚至是鱼类资源崩溃的可能性，这一问题直到 20 世纪初才被正式承认 (Garstang, 1900)，那么如何最好地管理渔业就成为一个重要的问题。在管理渔业时，曾试图管理所作的全部努力量。支持这一观点的一个论点来自于单位补充量渔获量 (yield-per-recruit，YPR) 的概念，该概念以数量和质量的形式从数学上跟踪了在不同水平的强制捕捞死亡率下的世代的命运；捕捞死亡率被认为与所采取的努力量直接相关。“单位补充量”的概念意味着它遵循个体世代，并以最大化每个补充量的收益为目标。\n我们将重复 Russell (1942) 的例子来说明YPR背后的思想。Russell 的例子只涉及捕捞死亡率，这与假设没有自然死亡率（忽略了 M）是一样的。对于这个简单的 YPR 我们也会忽略自然死亡率和应用一系列常数收获率每年计算年龄-数量（numbers-at-age）(相当于式 公式 3.3 ),我们将使用一个年龄-体重乘以年龄-数量计算年龄-渔获量的重量,从中我们可以获得总的预期渔获量。\n\n代码# Simple Yield-per-Recruit see Russell (1942)  \nage &lt;- 1:11;  nage &lt;- length(age); N0 &lt;- 1000  # some definitions  \n # weight-at-age values  \nWaA &lt;- c(NA,0.082,0.175,0.283,0.4,0.523,0.7,0.85,0.925,0.99,1.0)  \n # now the harvest rates  \nH &lt;- c(0.01,0.06,0.11,0.16,0.21,0.26,0.31,0.36,0.55,0.8)  \nnH &lt;- length(H)  \nNaA &lt;- matrix(0,nrow=nage,ncol=nH,dimnames=list(age,H)) # storage  \nCatchN &lt;- NaA;  CatchW &lt;- NaA      # define some storage matrices  \nfor (i in 1:nH) {                # loop through the harvest rates  \n   NaA[1,i] &lt;- N0  # start each harvest rate with initial numbers  \n   for (age in 2:nage) {  # loop through over-simplified dynamics  \n      NaA[age,i] &lt;- NaA[(age-1),i] * (1 - H[i])  \n      CatchN[age,i] &lt;- NaA[(age-1),i] - NaA[age,i]  \n   }  \n   CatchW[,i] &lt;- CatchN[,i] * WaA  \n}                      # transpose the vector of total catches to  \ntotC &lt;- t(colSums(CatchW,na.rm=TRUE))   # simplify later printing  \n\n\n不同的渔获率对种群年龄结构的影响在渔获的分年龄数量和分年龄重量上都很明显。随着渔获率的增加，高年龄组的捕获数量越来越少，分年龄捕获数也越来越少。对于较高的捕获率，种群变得依赖于最近的补充量，而不是在较老的年龄组中数量和生物量的积累。\n\n代码kable(NaA,digits=c(0,0,0,0,0,0,0,0,1,1),row.names=TRUE) \n\n\n表 3.4: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获数量。\n\n\n\n\n\n0.01\n0.06\n0.11\n0.16\n0.21\n0.26\n0.31\n0.36\n0.55\n0.8\n\n\n\n1\n1000\n1000\n1000\n1000\n1000\n1000\n1000\n1000\n1000.0\n1000.0\n\n\n2\n990\n940\n890\n840\n790\n740\n690\n640\n450.0\n200.0\n\n\n3\n980\n884\n792\n706\n624\n548\n476\n410\n202.5\n40.0\n\n\n4\n970\n831\n705\n593\n493\n405\n329\n262\n91.1\n8.0\n\n\n5\n961\n781\n627\n498\n390\n300\n227\n168\n41.0\n1.6\n\n\n6\n951\n734\n558\n418\n308\n222\n156\n107\n18.5\n0.3\n\n\n7\n941\n690\n497\n351\n243\n164\n108\n69\n8.3\n0.1\n\n\n8\n932\n648\n442\n295\n192\n122\n74\n44\n3.7\n0.0\n\n\n9\n923\n610\n394\n248\n152\n90\n51\n28\n1.7\n0.0\n\n\n10\n914\n573\n350\n208\n120\n67\n35\n18\n0.8\n0.0\n\n\n11\n904\n539\n312\n175\n95\n49\n24\n12\n0.3\n0.0\n\n\n\n\n\n\n\n\n\n代码kable(CatchW[2:11,],digits=c(2,2,2,2,2,2,2,2,2,2),row.names=TRUE)\n\n\n表 3.5: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获重量。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.01\n0.06\n0.11\n0.16\n0.21\n0.26\n0.31\n0.36\n0.55\n0.8\n\n\n\n2\n0.82\n4.92\n9.02\n13.12\n17.22\n21.32\n25.42\n29.52\n45.10\n65.60\n\n\n3\n1.73\n9.87\n17.13\n23.52\n29.03\n33.67\n37.43\n40.32\n43.31\n28.00\n\n\n4\n2.77\n15.00\n24.66\n31.95\n37.09\n40.29\n41.77\n41.73\n31.52\n9.06\n\n\n5\n3.88\n19.93\n31.02\n37.93\n41.42\n42.14\n40.74\n37.75\n20.05\n2.56\n\n\n6\n5.02\n24.50\n36.10\n41.66\n42.78\n40.78\n36.75\n31.59\n11.80\n0.67\n\n\n7\n6.66\n30.82\n43.00\n46.84\n45.23\n40.39\n33.94\n27.06\n7.10\n0.18\n\n\n8\n8.00\n35.18\n46.47\n47.78\n43.39\n36.29\n28.44\n21.03\n3.88\n0.04\n\n\n9\n8.62\n35.99\n45.01\n43.67\n37.30\n29.22\n21.35\n14.65\n1.90\n0.01\n\n\n10\n9.14\n36.21\n42.87\n39.26\n31.54\n23.15\n15.77\n10.03\n0.92\n0.00\n\n\n11\n9.14\n34.38\n38.54\n33.31\n25.17\n17.30\n10.99\n6.49\n0.42\n0.00\n\n\n\n\n\n\n\n\n\n代码kable(totC,digits=c(1,1,1,1,1,1,1,1,1,1)) \n\n\n表 3.6: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下种群的渔获量。\n\n\n\n\n0.01\n0.06\n0.11\n0.16\n0.21\n0.26\n0.31\n0.36\n0.55\n0.8\n\n\n55.8\n246.8\n333.8\n359.1\n350.2\n324.5\n292.6\n260.2\n166\n106.1\n\n\n\n\n\n\n\n如果使用 MQMF 中的 plot1()函数绘制渔获总重量对捕获率的图，我们可以立即看到，在产量方面确实存在一个最佳渔获率，而不是最大利用率。如果让努力量增加，渔获量并不总是增加。如果捕获率很低，那么捕获的鱼类太少，不足以弥补显著的捕获量。然而，产量随着捕获率的增加而迅速增加，而当超过产生最大产量的捕获率时，产量下降得更慢。\n\n代码 #Use MQMF::plot1 for a quick plot of the total catches. Figure 3.8  \nplot1(H,totC,xlab=\"Harvest Rate\",ylab=\"Total Yield\",lwd=2)  \n\n\n\n\n\n\n图 3.8: 忽略自然死亡率、年龄选择性或任何其他影响的简化单位补充量-渔获量分析。该分析使用了 Russell（1942）的部分年龄-体重数据，尽管 Russell 仅考察了两种捕捞率，但本分析考察了更广泛的捕捞率。\n\n\n\n\n为了快速说明不同捕获率的影响，这个例子在 1942 年获得了成功。对单位补充量渔获量的更全面的处理需要考虑动态中的自然死亡率和网具选择性带来的年龄死亡率差异。\n\n3.3.1 单位补充量渔获量中的选择性\n通常，在完全年龄结构的渔业模型中，人们会用一个选择性函数来描述每个年龄组(或体长组)对特定捕捞网具的不同脆弱性。随着鱼的年龄增加(或变大)，鱼会越来越多地补充到渔业中，直到它们完全易于受到捕捞的影响。通常，这种选择性曲线的参数是在将年龄结构模型与渔业数据拟合的过程中获得的。然而，在这里，我们将仅仅是给定了属性值(参见第 5章“静态模型”（static Models）中选择性的更多细节)。早期的 YPR 分析经常使用所谓的刀刃选择性，这意味着鱼类在特定年龄 100% 容易受到渔具的攻击。然而，在这里，我们将实现一个更现实、但更简单的脆弱性随年龄的选择性曲线。有许多不同的方程用来描述不同渔具的选择性特性，但拖网渔具使用的一个非常常见的方程是标准 logistic 或 s 形曲线，它也可以有许多公式化的表达式。一个常用来描述随年龄 \\(S_a\\) 或体长变化，选择性 logistic 形状 ，以及年龄或体长的成熟度定义为:\n\\[\n{{S}_{a}}=\\frac{1}{1+{{({{e}^{(\\alpha +\\beta a)}})}^{-1}}}=\\frac{{{e}^{(\\alpha +\\beta a)}}}{1+{{e}^{(\\alpha +\\beta a)}}}\n\\qquad(3.8)\\]\n式中 \\(\\alpha\\) 和 \\(\\beta\\) 为 logistic 参数，\\(-\\alpha/\\beta\\) 为 0.5（50%）选择性处的年龄。四分位数之间的距离(字面上分位数的25%到75%；logistic曲线梯度的度量)定义为 \\(IQ=2\\log(3)/\\beta\\)（参见 MQMF 函数 mature() 用于该函数的执行）。一般来说，在年龄结构模型中，需要长度或年龄组成数据，以便直接估计网具选择性和渔业可用性。在计算单位补充量渔获量时，通常的理由是要包括一种形式的选择性，以确定开始应用捕捞死亡率的最佳年龄。在管理方面，这可以用来确定拖网或刺网的网眼尺寸。这就是为什么刀刃选择性经常被使用的原因，它可以识别年龄在什么年龄以下没有选择，在什么年龄以上有 100% 的选择。这在 MQMF 函数 logistic() 中实现（使用不同的公式），但在 mature() 中没有实现。刀刃选择性并不倾向于在完整的年龄结构种群评估模型中使用。\n\n代码 #Logistic S shaped cureve for maturity  \nages &lt;- seq(0,50,1)  \nsel1 &lt;- mature(-3.650425,0.146017,sizeage=ages) #-3.65/0.146=25  \nsel2 &lt;- mature(-6,0.2,ages)  \nsel3 &lt;- mature(-6,0.24,ages)  \nplot1(ages,sel1,xlab=\"Age Yrs\",ylab=\"Selectivity\",cex=0.75,lwd=2)  \nlines(ages,sel2,col=2,lwd=2,lty=2)  \nlines(ages,sel3,col=3,lwd=2,lty=3)  \nabline(v=25,col=\"grey\",lty=2)   \nabline(h=c(0.25,0.5,0.75),col=\"grey\",lty=2)  \nlegend(\"topleft\",c(\"25_15.04\",\"30_10.986\",\"25_9.155\"),col=c(1,2,3),  \n       lwd=3,cex=1.1,bty=\"n\",lty=1:3)  \n\n\n\n\n\n\n图 3.9: 使用 mature() 函数的逻辑斯蒂 S 形曲线示例。图例包含每条曲线的 L50 和 IQ，其参数在代码中定义。\n\n\n\n\n\n3.3.2 Baranov 渔获量方程\n公式 3.4 描述了结合捕捞和自然死亡后的残存率，但简单的总死亡率 \\(Z\\)意味着所有鱼的捕捞死亡率相同。如果我们要考虑选择性，那么我们需要考虑年龄的捕捞死亡率。\n\\[\nS_{a,t}=e^{-(M + {s_a}{F_t})}\n\\qquad(3.9)\\]\n其中 \\(S_{a,t}\\) 为 \\(t\\) 年 \\(a\\) 龄鱼的残存率，\\(M\\) 为自然死亡系数（假设随时间不变），\\(s_a\\) 为年龄 \\(a\\) 的选择性，\\(F_t\\) 已知，\\(t\\) 年完全选择的捕捞死亡系数。\n一旦残存数量 \\(S_tN_t\\) 已知，那么死亡的数量显然不同时期存在差异。从一个时间段到下一个时间段一个世代的死亡总数量可以表示为:\n\\[\nN_{z}=N_{t}-N_{t+1}  \n\\qquad(3.10)\\]\n如果用残存等式代替 \\(N_{t_1}\\)，就可得到残存的补偿方程，其描述了时间段间总死亡数量：\n\\[\nN_{a,z}=N_{a,t}-N_{a,t}{e}^{-(M+{s_a}{F_t})}=N_{a,t}(1-{e}^{-(M+{s_a}{F_t})})\n\\qquad(3.11)\\]\n这里 \\(N_{a,z}\\) 为年龄 \\(a\\) 死亡的数量。当然，不是所有死亡的鱼都作为渔获，一些是自然死亡的，但也出现捕捞一些自然死亡的个体的现象。将死亡率分为 \\(M\\)（假设不同年龄的自然死亡系数不变）和 \\(F_t\\) (捕捞努力量引起的完全选择死亡)，它可以随时间 \\(t\\) 而变化，可以计算渔获量和残存量。可以将 \\(s_aF_t\\) 简化为 \\(F_{a,t}\\)。有可能进行这种分开的假设是年龄结构和体长结构的种群评估模型的一个重要组成部分。使用瞬时率，由于捕捞死亡而非自然死亡的数量用分数 \\(F_{a,t}/(M+F_{a,t})\\) 来描述，如果将其包含到 公式 3.11 中，我们发现我们已经推导出了所谓的 Baranov 渔获量方程 (QUINN 2003; Quinn 和 Deriso 1999) ，现在通常用于渔业建模，以估计渔获中的数量。它被用来追踪单个世代的命运，如果将所有年龄段相加，就能得出总的渔获量:\n\\[\n{{\\hat{C}}_{a,t}}=\\frac{{F}_{a,t}}{M+{F}_{a,t}}{{N}_{a,t}}\\left( 1-{{e}^{-\\left( M+{{F}_{a,t}} \\right)}} \\right)\n\\qquad(3.12)\\]\n其中\\(\\hat{C}_{a,t}\\)为\\(t\\)年年龄\\(a\\)的期望渔获，\\(F_{a,t}\\)为\\(t\\)年年龄\\(a\\)的瞬时捕捞死亡系率（\\(s_aF_t\\)），\\(M\\)为自然死亡率（假设年龄间不变），\\(N_{a,t}\\)为\\(t\\)年年龄\\(a\\)的数量。该方程可用MQMF的函数bce()运行。\n\n代码 # Baranov catch equation  \nage &lt;- 0:12;  nage &lt;- length(age)   \nsa &lt;-mature(-4,2,age) #selectivity-at-age  \nH &lt;- 0.2;  M &lt;- 0.35  \nFF &lt;- -log(1 - H)#Fully selected instantaneous fishing mortality  \nFt &lt;- sa * FF     # instantaneous Fishing mortality-at-age  \nN0 &lt;- 1000  \nout &lt;- cbind(bce(M,Ft,N0,age),\"Select\"=sa)  # out becomes Table 3.7  \n\n\n\n代码kable(out, digits = 3)\n\n\n表 3.7: 将巴拉诺夫捕捞方程应用于年捕捞率为 0.2 且瞬时自然死亡率为 0.3 的种群。\n\n\n\n\n\nNt\nN-Dying\nCatch\nSelect\n\n\n\n0\n1000.000\nNA\nNA\n0.018\n\n\n1\n686.191\n291.645\n22.164\n0.119\n\n\n2\n432.501\n192.368\n61.322\n0.500\n\n\n3\n250.395\n116.618\n65.488\n0.881\n\n\n4\n141.728\n66.827\n41.840\n0.982\n\n\n5\n79.943\n37.766\n24.018\n0.998\n\n\n6\n45.071\n21.298\n13.574\n1.000\n\n\n7\n25.409\n12.007\n7.655\n1.000\n\n\n8\n14.325\n6.769\n4.316\n1.000\n\n\n9\n8.075\n3.816\n2.433\n1.000\n\n\n10\n4.553\n2.151\n1.372\n1.000\n\n\n11\n2.567\n1.213\n0.773\n1.000\n\n\n12\n1.447\n0.684\n0.436\n1.000\n\n\n\n\n\n\n\n\n\n3.3.3 生长和各年龄体重\n为了获得渔获量的质量(即渔获量的重量)，需要将渔获量中的各年龄数量乘以各年龄重量。各年龄体重可以是特定年份特定渔业的平均体重观测值的向量 (Beverton 和 Holt 1993) ，或者，更常见的是，从 von Bertalanffy 生长曲线推导出的标准年龄体重方程，它从各年龄长度开始。\n\\[\nL_{a}=L_{\\infty}(1-e^{(-K(a-t_0))})\n\\qquad(3.13)\\]\n其中，\\(L_a\\)为年龄\\(a\\)的长度，\\(L_{\\infty}\\)为平均最大年龄长度，\\(K\\)为系数，它决定了如何快速达到 \\(L_{\\infty}\\)，\\(t_0\\) 为长度为 0 时的假设年龄。用 MQMF 的函数 vB()运行。假设各年龄长度和各年龄体重之间存在幂次关系，因此增加了两个参数:\n\\[\n\\begin{aligned}  \n{W_a}  &= {\\alpha}{L_a}^{b}=w_a(1-e^{(-K(a-t_0))})^{b} \\\\  \n{\\log{(W_a)}} &= \\log{(\\alpha)}+{b}{L_a}  \n\\end{aligned}  \n\\qquad(3.14)\\]\n其中，\\(\\alpha\\) 为恒定值，\\(w_a\\) 为 \\((\\alpha L_{\\infty})\\)，\\(b\\) 为指数，近似为 3.0（大小是二维的，而重量是三维的）。对数变换形式当然是线性的。在第 5章“静态模型”（Static Models）中，我们将看到如何估计这些模型的参数。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  },
  {
    "objectID": "03-simpopmodel.html#完整的单位补充量产量",
    "href": "03-simpopmodel.html#完整的单位补充量产量",
    "title": "3  简单种群模型",
    "section": "\n3.4 完整的单位补充量产量",
    "text": "3.4 完整的单位补充量产量\n把所有这些整合在一起，意味着我们可以产生一个更完整的单位补充量产量（YPR）分析。标准的 YPR 分析假设恒定的补充量，这意味着我们可以跟踪单个世代的命运，并仍然捕捉所需的细节。当然，补充量不是一个常数，所以这种方法被认为是基于长期或平衡条件。以这种方式忽略变化和随机性意味着，任何关于潜在生产力和由此产生的管理决策的结论都需要谨慎对待（事实上，非常谨慎）。但这些方法是在渔业分析都是确定性的，并假定处于平衡状态时发展起来的，不确定性的含义尚未被探索 (Beverton 和 Holt 1993) 。\n当目标是最大化产量时，这样的分析是有意义的。但是，恒定补充量的假设和对不确定性的忽视意味着这些分析通常不是保守的。人们尝试改进 YPR 分析提出的建议，其中比较有用的是 \\(F_{0.1}\\) 的出现(发音为 F zero point one)。定义为产量曲线起点处产量增长率 1/10 的渔获率 (Hilborn 和 Walters 1992)。\\(F_{0.1}\\) 的优势这是捕捞努力量的相对 大幅下降，只会导致产量的很小损失。这可以提高渔业的经济效益和可持续性。然而，本质上使用 \\(F_{0.1}\\) 仍然是一个经验规则，它在实践中比 \\(F_{max}\\) （最高产量点）更可持续，通常比 \\(F_{msy}\\) (平衡时可产生 MSY 的捕捞死亡率)更好。\n\n代码# A more complete YPR analysis  \nage &lt;- 0:20;  nage &lt;- length(age) #storage vectors and matrices  \nlaa &lt;- vB(c(50.0,0.25,-1.5),age) # length-at-age  \nWaA &lt;- (0.015 * laa ^ 3.0)/1000  # weight-at-age as kg  \nH &lt;- seq(0.01,0.65,0.05);  nH &lt;- length(H)     \nFF &lt;- round(-log(1 - H),5)  # Fully selected fishing mortality  \nN0 &lt;- 1000  \nM &lt;- 0.1  \nnumt &lt;- matrix(0,nrow=nage,ncol=nH,dimnames=list(age,FF))  \ncatchN &lt;- matrix(0,nrow=nage,ncol=nH,dimnames=list(age,FF))  \nas50 &lt;- c(1,2,3)    \nyield &lt;- matrix(0,nrow=nH,ncol=length(as50),dimnames=list(H,as50))  \nfor (sel in 1:length(as50)) {  \n   sa &lt;- logist(as50[sel],1.0,age)  # selectivity-at-age  \n   for (harv in 1:nH) {  \n      Ft &lt;- sa * FF[harv]      # Fishing mortality-at-age  \n      out &lt;- bce(M,Ft,N0,age)  \n      numt[,harv] &lt;- out[,\"Nt\"]  \n      catchN[,harv] &lt;- out[,\"Catch\"]  \n      yield[harv,sel] &lt;- sum(out[,\"Catch\"] * WaA,na.rm=TRUE)  \n   } # end of harv loop  \n} # end of sel loop  \n\n\n\n代码#A full YPR analysis  Figure 3.10  \nplot1(H,yield[,3],xlab=\"Harvest Rate\",ylab=\"Yield\",cex=0.75,lwd=2)  \nlines(H,yield[,2],lwd=2,col=2,lty=2)  \nlines(H,yield[,1],lwd=2,col=3,lty=3)  \nlegend(\"bottomright\",legend=as50,col=c(3,2,1),lwd=3,bty=\"n\",  \n       cex=1.0,lty=c(3,2,1))   \n\n\n\n\n\n\n图 3.10: 不同捕捞强度和不同初次开发年龄对总平衡产量的影响。图例标明了不同的初次开发年龄。\n\n\n\n\n这些详细的分析考虑了选择性、年龄体重和自然死亡率，提供了一个渔场在不同条件下的潜在产量的更准确的表示，尽管仍然是确定性的。一旦考虑到不确定性和自然变化，即使只是近似地使用\\(F_{0.1}\\) ，那么YPR分析仍然可以为了解特定渔业的生产能力提供一些有用的见解。当然，如今onbe更有可能进行单位补充量的利润分析，但原则是不变的。\n\n代码kable(yield, digits = 3)\n\n\n表 3.8: 不同捕捞率（行）和不同首次开发年龄（列）对总平衡产量的影响。\n\n\n\n\n\n1\n2\n3\n\n\n\n0.01\n85.825\n84.152\n81.136\n\n\n0.06\n347.125\n352.465\n350.567\n\n\n0.11\n447.067\n469.250\n480.134\n\n\n0.16\n475.149\n514.595\n540.249\n\n\n0.21\n471.987\n526.522\n565.880\n\n\n0.26\n455.843\n522.962\n574.288\n\n\n0.31\n434.880\n512.360\n573.986\n\n\n0.36\n412.718\n498.720\n569.223\n\n\n0.41\n390.958\n483.969\n562.163\n\n\n0.46\n370.252\n469.031\n553.935\n\n\n0.51\n350.834\n454.348\n545.146\n\n\n0.56\n332.715\n440.100\n536.113\n\n\n0.61\n315.808\n426.329\n526.995",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  },
  {
    "objectID": "03-simpopmodel.html#结束语",
    "href": "03-simpopmodel.html#结束语",
    "title": "3  简单种群模型",
    "section": "\n3.5 结束语",
    "text": "3.5 结束语\n我们使用了相对简单的种群模型来说明渔业和生态学中的许多观点。重要的是，重点是模拟模型，而不是将模型与数据拟合(见下一章“模型参数估计”)。模拟模型通常包括模型参数值的不确定性，但是，由于许多题目在这里只作了介绍性的处理，更彻底的处理本身需要一本书。然而，通过探索在考虑的各种模型上施加一系列参数值的含义，这些模型的属性和隐含的动力学可以被揭示出来。因此，模拟研究是对任何自然过程建模的重要工具。然而，同样重要的是，使用这些参数的合理或现实的组合进行模拟。理解所有模型的数学性质是很有用的，但是，自然地，最重要的兴趣是当模型具有现实值并可能在自然界中找到时。\n在使用任何种群模型或其组成部分时获得的直觉对理解任何未来的工作都有价值，但是，当然，所说明的每个模型(特别是相对简单的模型)中的上下文和假设总是要记住的。令人惊讶的是，即使是简单的模型有时也能提供对各种自然过程的洞察。\n在本章中，我们只考虑了简单的种群模型，但我们也可以很好地使用 R 来探索物种之间在竞争、捕食、寄生、共生等过程中的相互作用。所有的早期模型(Lotka，1925；Wolterra，1927；Gause，1934)考虑了没有空间结构的种群。使用 R 会相对直接地增加这种模型的复杂性，并包括空间细节，如 Huffaker(1958) 的实验探索。Huffaker 后来的一些实验性捕食者-补捕食者安排持续了 490 天。在这种情况下，模拟研究对于扩展探索的可能性非常有用。这样有趣的工作将需要成为另一本书的一部分，因为在渔业领域，我们还有许多其他领域需要探索和讨论。\n使用 R 作为进行此类模拟的工具，使得分析比在电子表格上布置参数操作更抽象。然而，代码块和已开发函数的可重用性，以及更复杂模型和函数的增量开发的潜力所带来的优势，超过了编程环境的更抽象的本质。使用 R 作为一种编程语言来开发这些不同的分析非常适合渔业和生态建模工作。\n\n\n\n\n\n\nBeverton, Raymond J. H., 和 Sidney J. Holt. 1993. On the Dynamics of Exploited Fish Populations. Springer Netherlands. https://doi.org/10.1007/978-94-011-2106-4.\n\n\nHilborn, Ray, 和 Carl J. Walters. 1992. Quantitative Fisheries Stock Assessment. Springer US. https://doi.org/10.1007/978-1-4615-3598-0.\n\n\nMay, Robert, 和 Angela R. McLean, 编. 2007. Theoretical Ecology. Oxford University Press. https://doi.org/10.1093/oso/9780199209989.001.0001.\n\n\nQUINN, TERRANCE J. 2003. 《RUMINATIONS ON THE DEVELOPMENT AND FUTURE OF POPULATION DYNAMICS MODELS IN FISHERIES》. Natural Resource Modeling 16 (4): 341–92. https://doi.org/10.1111/j.1939-7445.2003.tb00119.x.\n\n\nQuinn, Terrance J., 和 Richard B. Deriso. 1999. Quantitative Fish Dynamics. Biological Resource Management. Oxford, New York: Oxford University Press.\n\n\nRussell, E. S. 1942. The Overfishing Problem. CUP Archive.\n\n\nSchaefer, M. 1991. 《Some Aspects of the Dynamics of Populations Important to the Management of the Commercial Marine Fisheries》. Bulletin of Mathematical Biology 53 (1-2): 253–79. https://doi.org/10.1016/s0092-8240(05)80049-7.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>简单种群模型</span>"
    ]
  }
]