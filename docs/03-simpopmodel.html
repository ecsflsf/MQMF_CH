<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>使用 R 语言进行渔业建模和定量方法研究 - 3&nbsp; 简单种群模型</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-application.html" rel="next">
<link href="./02-NonIntroductiontoR.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script><script>
    MathJax ={
  tex: {
    macros: {
      bm: ["{\\boldsymbol #1}",1],
    }
  }
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-simpopmodel.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">简单种群模型</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">使用 R 语言进行渔业建模和定量方法研究</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切换深色模式"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">关于建模</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-NonIntroductiontoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R 语言的不完全介绍</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-simpopmodel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">简单种群模型</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-application.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">模型参数估算</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-staticModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">静态模型</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">不确定性</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-spm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">剩余生产模型</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">目录</h2>
   
  <ul>
<li>
<a href="#%E7%AE%80%E4%BB%8B" id="toc-简介" class="nav-link active" data-scroll-target="#%E7%AE%80%E4%BB%8B"><span class="header-section-number">3.1</span> 简介</a>
  <ul class="collapse">
<li><a href="#%E7%A6%BB%E6%95%A3logistic%E6%A8%A1%E5%9E%8B" id="toc-离散logistic模型" class="nav-link" data-scroll-target="#%E7%A6%BB%E6%95%A3logistic%E6%A8%A1%E5%9E%8B"><span class="header-section-number">3.1.1</span> 离散Logistic模型</a></li>
  <li><a href="#%E5%8A%A8%E6%80%81%E8%A1%8C%E4%B8%BA" id="toc-动态行为" class="nav-link" data-scroll-target="#%E5%8A%A8%E6%80%81%E8%A1%8C%E4%B8%BA"><span class="header-section-number">3.1.2</span> 动态行为</a></li>
  <li><a href="#%E7%A1%AE%E5%AE%9A%E8%A1%8C%E4%B8%BA%E9%97%B4%E7%9A%84%E8%BE%B9%E7%95%8C" id="toc-确定行为间的边界" class="nav-link" data-scroll-target="#%E7%A1%AE%E5%AE%9A%E8%A1%8C%E4%B8%BA%E9%97%B4%E7%9A%84%E8%BE%B9%E7%95%8C"><span class="header-section-number">3.1.3</span> 确定行为间的边界</a></li>
  <li><a href="#%E7%BB%8F%E5%85%B8%E7%9A%84%E6%B7%B7%E6%B2%8C%E5%88%86%E5%B2%94%E5%9B%BE" id="toc-经典的混沌分岔图" class="nav-link" data-scroll-target="#%E7%BB%8F%E5%85%B8%E7%9A%84%E6%B7%B7%E6%B2%8C%E5%88%86%E5%B2%94%E5%9B%BE"><span class="header-section-number">3.1.4</span> 经典的混沌分岔图</a></li>
  <li><a href="#%E6%8D%95%E6%8D%9E%E5%AF%B9%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E7%9A%84%E5%BD%B1%E5%93%8D" id="toc-捕捞对种群动态的影响" class="nav-link" data-scroll-target="#%E6%8D%95%E6%8D%9E%E5%AF%B9%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="header-section-number">3.1.5</span> 捕捞对种群动态的影响</a></li>
  <li><a href="#%E5%86%B3%E5%AE%9A%E8%AE%BA" id="toc-决定论" class="nav-link" data-scroll-target="#%E5%86%B3%E5%AE%9A%E8%AE%BA"><span class="header-section-number">3.1.6</span> 决定论</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%B9%B4%E9%BE%84%E7%BB%93%E6%9E%84%E7%9A%84%E5%BB%BA%E6%A8%A1%E6%A6%82%E5%BF%B5" id="toc-年龄结构的建模概念" class="nav-link" data-scroll-target="#%E5%B9%B4%E9%BE%84%E7%BB%93%E6%9E%84%E7%9A%84%E5%BB%BA%E6%A8%A1%E6%A6%82%E5%BF%B5"><span class="header-section-number">3.2</span> 年龄结构的建模概念</a>
  <ul class="collapse">
<li><a href="#%E4%B8%96%E4%BB%A3%E4%B8%AD%E7%9A%84%E6%AE%8B%E5%AD%98" id="toc-世代中的残存" class="nav-link" data-scroll-target="#%E4%B8%96%E4%BB%A3%E4%B8%AD%E7%9A%84%E6%AE%8B%E5%AD%98"><span class="header-section-number">3.2.1</span> 世代中的残存</a></li>
  <li><a href="#%E7%9E%AC%E6%97%B6-vs-%E5%B9%B4%E6%AD%BB%E4%BA%A1%E7%8E%87" id="toc-瞬时-vs-年死亡率" class="nav-link" data-scroll-target="#%E7%9E%AC%E6%97%B6-vs-%E5%B9%B4%E6%AD%BB%E4%BA%A1%E7%8E%87"><span class="header-section-number">3.2.2</span> 瞬时 Vs 年死亡率</a></li>
  </ul>
</li>
  <li>
<a href="#%E7%AE%80%E5%8D%95%E5%8D%95%E4%BD%8D%E8%A1%A5%E5%85%85%E9%87%8F%E6%B8%94%E8%8E%B7%E9%87%8F" id="toc-简单单位补充量渔获量" class="nav-link" data-scroll-target="#%E7%AE%80%E5%8D%95%E5%8D%95%E4%BD%8D%E8%A1%A5%E5%85%85%E9%87%8F%E6%B8%94%E8%8E%B7%E9%87%8F"><span class="header-section-number">3.3</span> 简单单位补充量渔获量</a>
  <ul class="collapse">
<li><a href="#sec-ypr_selectivity" id="toc-sec-ypr_selectivity" class="nav-link" data-scroll-target="#sec-ypr_selectivity"><span class="header-section-number">3.3.1</span> 单位补充量渔获量中的选择性</a></li>
  <li><a href="#baranov-%E6%B8%94%E8%8E%B7%E9%87%8F%E6%96%B9%E7%A8%8B" id="toc-baranov-渔获量方程" class="nav-link" data-scroll-target="#baranov-%E6%B8%94%E8%8E%B7%E9%87%8F%E6%96%B9%E7%A8%8B"><span class="header-section-number">3.3.2</span> Baranov 渔获量方程</a></li>
  <li><a href="#%E7%94%9F%E9%95%BF%E5%92%8C%E5%90%84%E5%B9%B4%E9%BE%84%E4%BD%93%E9%87%8D" id="toc-生长和各年龄体重" class="nav-link" data-scroll-target="#%E7%94%9F%E9%95%BF%E5%92%8C%E5%90%84%E5%B9%B4%E9%BE%84%E4%BD%93%E9%87%8D"><span class="header-section-number">3.3.3</span> 生长和各年龄体重</a></li>
  </ul>
</li>
  <li><a href="#%E5%AE%8C%E6%95%B4%E7%9A%84%E5%8D%95%E4%BD%8D%E8%A1%A5%E5%85%85%E9%87%8F%E4%BA%A7%E9%87%8F" id="toc-完整的单位补充量产量" class="nav-link" data-scroll-target="#%E5%AE%8C%E6%95%B4%E7%9A%84%E5%8D%95%E4%BD%8D%E8%A1%A5%E5%85%85%E9%87%8F%E4%BA%A7%E9%87%8F"><span class="header-section-number">3.4</span> 完整的单位补充量产量</a></li>
  <li><a href="#%E7%BB%93%E6%9D%9F%E8%AF%AD" id="toc-结束语" class="nav-link" data-scroll-target="#%E7%BB%93%E6%9D%9F%E8%AF%AD"><span class="header-section-number">3.5</span> 结束语</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-simplemodel" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">简单种群模型</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> 代码</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">显示所有代码</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">隐藏所有代码</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">查看源代码</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="简介" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="简介">
<span class="header-section-number">3.1</span> 简介</h2>
<p>简单的种群模型构成了众多渔业模型的基础，事实上，渔业模型与生态种群模型的区别只是人为的划分。理解任何种群模型的运行方式都将有助于更好地理解渔业模型，因此在本章中，我们将使用R来检验种群生物学中的一些基本思想的动力学。</p>
<section id="离散logistic模型" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="离散logistic模型">
<span class="header-section-number">3.1.1</span> 离散Logistic模型</h3>
<p>我们将首先考察已成为生态学中经典种群模型之一的离散逻辑斯蒂模型所展示的动力学。这种模型出现在许多地方，以许多不同的形式出现，因此值得进行一些详细的探索。这里我们将使用 <span class="citation" data-cites="schaefer1991">(<a href="08-references.html#ref-schaefer1991" role="doc-biblioref">Schaefer 1991</a>)</span> Schaefer(1954, 1957)版本，它有四个组成部分或项:</p>
<p><span id="eq-3_1"><span class="math display">\[
\begin{aligned}
N_{t=0} &amp;= N_0 \\
N_{t+1} &amp;= N_t + rN_t \left(1-\left(\dfrac{N_t}{K} \right) \right) -C_t
\end{aligned}
\qquad(3.1)\]</span></span></p>
<p><span class="math inline">\(N_t\)</span> 项为时间 <span class="math inline">\(t\)</span> 时的数量（如年 <span class="math inline">\(t\)</span> 的开始时），最后一项为 <span class="math inline">\(C_t\)</span>，它是在时间 <span class="math inline">\(t\)</span> 内（如年份 <span class="math inline">\(t\)</span> ）捕获的渔获量。第一行反映了初始状态，定义为时间 <span class="math inline">\(0\)</span> 时的数量（或生物量）。要注意下标，因为无论是数量还是生物量，它们都是指特定时间的数量和生物量，通常是确定的时间段 <span class="math inline">\(t\)</span> 的开始时的数量或生物量，而渔获量指的是整个时间段 <span class="math inline">\(t\)</span> 内的渔获量。这个方程是对时间步长<span class="math inline">\(t\)</span>的动力学的总结； 它是一个差分方程而不是连续微分方程。第二个方程的中间项是更复杂的组成部分，该项定义了所谓的渔业生产曲线。它由 <span class="math inline">\(r\)</span> 和 <span class="math inline">\(K\)</span> 组成，<span class="math inline">\(r\)</span> 为种群的内在增长率， <span class="math inline">\(K\)</span> 为承载力或最大种群规模。如果动力学表示为在开发开始之前处于平衡状态，那么 <span class="math inline">\(N_0\)</span> 会取与 <span class="math inline">\(K\)</span> 相同的值，但它是分开的，以考虑任何时间序列开始时偏离均衡的情况。在 <strong>MQMF</strong> 的 <code>discretelogistic()</code> 中，你会看到另一个参数 <span class="math inline">\(p\)</span>，这个参数将在“剩余产量模型”中详细探讨。在此，只需说明的是，当使用默认值 <span class="math inline">\(p=1.0\)</span> 时， <a href="#eq-3_1" class="quarto-xref">公式&nbsp;<span>3.1</span></a> 中的方程等同于 Schaefer 模型。这里，Schaefer 模型输出实时数量，尽管在渔业中，它通常直接用实时生物量（<span class="math inline">\(B_t\)</span>）表示。这些术语可以以这种方式改变，这一事实强调了该模型忽略了生物学实际和属性，如种群体长结构和年龄结构，以及性别和其他属性之间的差异。令人惊讶的是，这样一个简单的模型在理论和实践中仍然是有用的。</p>
<p>我们可以通过将式 <a href="#eq-3_1" class="quarto-xref">公式&nbsp;<span>3.1</span></a> 的中间项与 <span class="math inline">\(N_t\)</span> 值的向量绘制成曲线来说明产量曲线。子项 <span class="math inline">\(rN_t\)</span> 表示无限制的种群指数增长，在这个离散形式的方程中，并将此项与 <span class="math inline">\(N_t\)</span> 相加。因此，只要 <span class="math inline">\(r&gt;0.1\)</span>及渔获量为0，我们就可以期待从方程的 <span class="math inline">\(N_t+rN_t\)</span> 部分得到种群的无尽增长。然而,子项 <span class="math inline">\((1−(N_t/K))\)</span> 为抑制指数增长的项，而且随着种群规模的增长，这种作用越来越大。这就是所谓的密度依赖效应。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">surprod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Nt</span>,<span class="va">r</span>,<span class="va">K</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">r</span><span class="op">*</span><span class="va">Nt</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">Nt</span><span class="op">/</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">densdep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Nt</span>,<span class="va">K</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">Nt</span><span class="op">/</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">1.2</span>; <span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">1000.0</span>; <span class="va">Nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">1000</span>,<span class="fl">10</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0</span>,<span class="fl">0</span>,<span class="fl">0.0</span>,<span class="fl">0.0</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.75</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="fl">0</span><span class="op">)</span>, font.axis<span class="op">=</span><span class="fl">7</span>,font<span class="op">=</span><span class="fl">7</span>,font.lab<span class="op">=</span><span class="fl">7</span><span class="op">)</span>   </span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">Nt</span>,<span class="fu">surprod</span><span class="op">(</span><span class="va">Nt</span>,<span class="va">r</span>,<span class="va">K</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Population Nt"</span>,defpar<span class="op">=</span><span class="cn">FALSE</span>,  </span>
<span>      ylab<span class="op">=</span><span class="st">"Production"</span><span class="op">)</span>  </span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">Nt</span>,<span class="fu">densdep</span><span class="op">(</span><span class="va">Nt</span>,<span class="va">K</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">"Population Nt"</span>,defpar<span class="op">=</span><span class="cn">FALSE</span>,  </span>
<span>      ylab<span class="op">=</span><span class="st">"Density-Dependence"</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.1: 离散 Schaefer（1954，1957）剩余生产模型的完整生产曲线以及与种群大小相当的等效线性密度依赖关系。
</figcaption></figure>
</div>
</div>
</div>
<p>密度依赖是种群规模调节的重要组成部分 <span class="citation" data-cites="theoreti2007">(<a href="08-references.html#ref-theoreti2007" role="doc-biblioref">May 和 McLean 2007</a>)</span>。从 <a href="#fig-3-1" class="quarto-xref">图&nbsp;<span>3.1</span></a> 可以明显看出，Schaefer 模型中的密度依赖项与种群规模呈线性递减关系。这就是”线性密度依赖”一词的字面意思，你可以在种群动态文献中找到它。这个密度依赖项，试图补偿由 <span class="math inline">\(rN_t\)</span> 驱动的指数增长 ，限制种群规模不大于未捕捞种群规模<span class="math inline">\(K\)</span>的长期平均(关于补偿不足时会发生什么，请参阅下一节)。</p>
</section><section id="动态行为" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="动态行为">
<span class="header-section-number">3.1.2</span> 动态行为</h3>
<p>众所周知，微分方程形式的 Schaefer 模型一直非常稳定，最大种群数量真正受限于 <span class="math inline">\(K\)</span> 值。令人惊讶的是，人们发现离散形式的动力学更为复杂和有趣 (May, 1973，1976)。我们已经在函数 <code>discretelogistic()</code> 中实现了上述方程的一种形式，你可以通过 <em>?discrete telogistic</em> 读取它的帮助文件，并且可以通过在控制台输入 <code>discretelogistic</code> 来查看它的代码(注意，没有括号)。如果您检查这个函数中的代码，您将看到它使用 <em>for</em> 循环来逐年间计算每年的资源量。我希望，作为一名 R 程序员，您会想知道为什么我不使用向量化方法来避免使用 <em>for</em> 循环。这突出了种群动力学的一个基本方面，即 <span class="math inline">\(t\)</span> 时的数量总是 <span class="math inline">\(t-1\)</span> 时数量的函数(初始条件可能于 <span class="math inline">\(N_0\)</span> 参数)。种群动态的顺序性质意味着我们不能以任何有效的方式使用矢量化。种群动态的顺序性是如此明显的事实，以至于它施加在种群模型上的约束和结构常常被忽视。</p>
<p><code>discretelogistic()</code> 函数（隐形）输出时间矩阵， <span class="math inline">\(year\)</span>（用 <em>year</em> 表示）、<span class="math inline">\(t\)</span> 时的数量 <span class="math inline">\(n_t\)</span> （表示为 <span class="math inline">\(nt\)</span> ）以及 <span class="math inline">\(t+1\)</span> 时的数量 <span class="math inline">\(n_{t+1}\)</span>（表示为 <span class="math inline">\(nt1\)</span> ）的矩阵。该矩阵也给出 <strong>MQMF</strong> 中包含的了 <em>dynpop</em> 类和S3方法（<em>plot.dynpop</em>；见<em>A non-introduction to R</em> 一章S3类和方法的使用。如果要查看代码，在控制台中输入<em>MQMF:::plot.dynpop</em>，记住当中是3个”:“，而非2个）。当然，可以写任何想写的东西。试着将<code>rv</code>的值 设定为0.5、1.95、2.2、2.475、2.56和2.8，用这些值按顺序运行下面的代码。</p>
<p>如果你运行生成 <a href="#fig-3-2" class="quarto-xref">图&nbsp;<span>3.2</span></a> 的代码，使用上面提到的6个<code>rv</code>值，你应该会看到一个单调阻尼平衡(一个实心点)，然后是一个阻尼振荡平衡(仍然是一个实心点)，然后是介于阻尼振荡平衡和两环稳定极限环之间的东西(有点涂抹了两个实心点)。当 <span class="math inline">\(r = 2.475\)</span> 时，有一个 4 圈稳定的极限环( 4 个实心点)，当 <span class="math inline">\(r = 2.56\)</span> 时，有一个 8 圈稳定的极限环。最后，当 <span class="math inline">\(r = 2.8\)</span> 时，动态以混乱告终，尽管所有的点都落在如图所示的抛物线上，但每一步的结果都不是随机的，也不是直接可预测的。在混沌理论中，这个抛物线被称为奇怪的吸引子，尽管这是一个非常简单的吸引子。这种混沌系统也依赖于起始条件。如果把初始数字改为 101 而不是 100，数字的时间线就会发生根本性的变化，尽管抛物线保持不变。当然，我们可以输入任意范围的数字，也可以使用稍微不同的模型来改变动态。虽然混乱很有趣，玩起来也很有趣 (Gleick，1988；Lauwerier, 1991)，但在模拟自然种群的实际应用中似乎很少有用。事实上，一些人声称，他们观察到的明显的随机性是由种群对随机环境效应的反应引起的，而不是由密度依赖模型中的补偿不足和补偿过度引入的非线性（Higgins等，1997）。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Code for Figure 3.2. Try varying the value of rv from 0.5-2.8  </span></span>
<span><span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">rv</span><span class="op">=</span><span class="fl">2.8</span>;  <span class="va">Kv</span> <span class="op">&lt;-</span> <span class="fl">1000.0</span>; <span class="va">Nz</span><span class="op">=</span><span class="fl">100</span>; <span class="va">catch</span><span class="op">=</span><span class="fl">0.0</span>; <span class="va">p</span><span class="op">=</span><span class="fl">1.0</span>  </span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="va">rv</span>,K<span class="op">=</span><span class="va">Kv</span>,N0<span class="op">=</span><span class="va">Nz</span>,Ct<span class="op">=</span><span class="va">catch</span>,Yrs<span class="op">=</span><span class="va">yrs</span>,p<span class="op">=</span><span class="va">p</span><span class="op">)</span>  </span>
<span><span class="va">avcatch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span><span class="op">(</span><span class="va">yrs</span><span class="op">-</span><span class="fl">50</span><span class="op">)</span><span class="op">:</span><span class="va">yrs</span>,<span class="st">"nt"</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">#used in text  </span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"r="</span>,<span class="va">rv</span>,<span class="st">" K="</span>,<span class="va">Kv</span>,<span class="st">" Ct="</span>,<span class="va">catch</span>, <span class="st">" N0="</span>,<span class="va">Nz</span>,<span class="st">" p="</span>,p<span class="op">=</span><span class="va">p</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ans</span>, main<span class="op">=</span><span class="va">label</span>, cex<span class="op">=</span><span class="fl">0.9</span>, font<span class="op">=</span><span class="fl">7</span><span class="op">)</span> <span class="co">#Schaefer dynamics  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.2: Schaefer 模型动态。左图是按年份的数值，展示了从 r 值为 2.8 开始的混沌动态。右图是时间 t+1 的数值与时间 t 的关系，称为相图。最后 20%的点用红色标出以展示任何平衡行为。灰色对角线是 1:1 线。
</figcaption></figure>
</div>
</div>
</div>
<p>在实际应用中，如果发现模型表现出明显的混沌或周期性行为，甚至是负的种群数量，尝试确定所观察到的现象是真实的生物群体行为(显然不是负数)，还是更简单地说，只是一个特殊参数的数学表达式。人们总是可以通过在计算中包含诸如 <span class="math inline">\(max((B_t+(rB_t)(1-(B_t/K))-C_t),0)\)</span> 之类以避免模型向下跌落到0以下（参见 <code>discretelogistic()</code> 代码。类似地，用 <span class="math inline">\(min((B_t+(rB_t)(1-(B_t/K))-C_t),1.1K)\)</span> 以避免计算值高于<span class="math inline">\(K\)</span>），尽管对代码的此类添加仍然是临时的（应该，比如，任何超过<span class="math inline">\(K\)</span>的值都应允许，是 <span class="math inline">\(1.1K\)</span>，还是 <span class="math inline">\(1.0K\)</span>？有些种群自然变动的）。在第 <a href="07-spm.html" class="quarto-xref"><span>7</span></a> 章 “<a href="./07-spm.html">剩余产量模型</a>” 一章中我们将研究惩罚函数的使用，惩罚函数可用于防止在估计这些参数时产生异常值，同时避免使用，如 <span class="math inline">\(max(\cdots，0)\)</span> 这类粗糙的工具。</p>
<p>我们可以通过将 <code>discretelogistic()</code> 函数的不可见输出转换为可以使用的对象来检查每年的实际资源量（<a href="#tbl-3-1" class="quarto-xref">表&nbsp;<span>3.1</span></a>）。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#run discrete logistic dynamics for 600 years  </span></span>
<span><span class="va">yrs</span><span class="op">=</span><span class="fl">600</span>  </span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.55</span>,K<span class="op">=</span><span class="fl">1000.0</span>,N0<span class="op">=</span><span class="fl">100</span>,Ct<span class="op">=</span><span class="fl">0.0</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-tbl-cap-align="center">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># layout-ncol: 1</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu">halftable</span><span class="op">(</span><span class="va">ans</span><span class="op">[</span><span class="op">(</span><span class="va">yrs</span><span class="op">-</span><span class="fl">29</span><span class="op">)</span><span class="op">:</span><span class="va">yrs</span>,<span class="op">]</span>,yearcol<span class="op">=</span><span class="st">"year"</span>,subdiv<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>      digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-1" class="cell quarto-float anchored" data-tbl-cap-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.1: ans 对象中最后 30 个按年排列的数字，展示了在 r = 2.2 时呈现 8 周期稳定极限。如果你在 discretelogistic() 中尝试 r = 2.2，它将导致 2 周期稳定极限在 746.24 和 1162.84 之间波动。尝试使用 plot(ans) 并观察每次变化。
</figcaption><div aria-describedby="tbl-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">nt</th>
<th style="text-align: right;">nt1</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">nt</th>
<th style="text-align: right;">nt1</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">nt</th>
<th style="text-align: right;">nt1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">571</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">581</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">591</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">1152.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">572</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">582</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">592</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">704.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">573</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">583</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">593</td>
<td style="text-align: right;">704.5</td>
<td style="text-align: right;">1235.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">574</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">584</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">704.5</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">1235.4</td>
<td style="text-align: right;">493.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">575</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">585</td>
<td style="text-align: right;">704.5</td>
<td style="text-align: right;">1235.4</td>
<td style="text-align: right;">595</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">1131.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">576</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">704.5</td>
<td style="text-align: right;">586</td>
<td style="text-align: right;">1235.4</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">596</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">752.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">577</td>
<td style="text-align: right;">704.5</td>
<td style="text-align: right;">1235.4</td>
<td style="text-align: right;">587</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">597</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">1227.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">578</td>
<td style="text-align: right;">1235.4</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">588</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">598</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">515.6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">579</td>
<td style="text-align: right;">493.9</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">589</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">599</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">1152.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">580</td>
<td style="text-align: right;">1131.3</td>
<td style="text-align: right;">752.4</td>
<td style="text-align: right;">590</td>
<td style="text-align: right;">1227.4</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">1152.4</td>
<td style="text-align: right;">704.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>当我们设置 <span class="math inline">\(r\)</span> 值来产生2循环的稳定限制(例如 <span class="math inline">\(r＝2.2\)</span> )，可以从其他年份的数值重复中清楚地看到。检查实际的数值显然比相信图表的视觉印象更准确。这也意味着我们可以尽可能详细地查看结果。在上述情况下，最近50年的平均渔获量为859.675，明显小于1000的<span class="math inline">\(K\)</span>值。由于 <span class="math inline">\(N_{t+1}\)</span> 与 <span class="math inline">\(N_t\)</span> 的相位关系，上一年的最后一行通常不会有 <span class="math inline">\(N_{t+1}\)</span> 的值，因此，在代码中，输入的年份数增加1，以便最终生成 <span class="math inline">\(N_{t+1}\)</span> (请参阅代码)。</p>
</section><section id="确定行为间的边界" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="确定行为间的边界">
<span class="header-section-number">3.1.3</span> 确定行为间的边界</h3>
<p>我们可以通过求 ans 中 <span class="math inline">\(nt\)</span> 和 <span class="math inline">\(Nt1\)</span> 列的行平均值来找到一个稳定的限制循环，查看最后 100 个值(四舍五入到小数点后三位)。<code><a href="https://rdrr.io/r/base/table.html">table()</a></code> 函数的名称标识循环点的值(如果有的话)。如果只有一个或两个平均值来确定一个渐近平衡或一个两周期稳定的限制循环。通过检查每个 ans 对象中值的时间序列，可以搜索所标识值的首次出现，从而确定循环行为（精确到小数点后三位）何时首次出现。我们将这些值四舍五入，并使用 600 年或更长的时间，因为如果我们使用所有 15 位小数，任何超过 8 的循环都可能无法被清楚地识别出来（尝试将 r = 2.63 更改为 5；并试着用 <code>plot(ans)</code> 绘图）。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#run discretelogistic and search for repeated values of Nt  </span></span>
<span><span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fl">600</span>  </span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.55</span>,K<span class="op">=</span><span class="fl">1000.0</span>,N0<span class="op">=</span><span class="fl">100</span>,Ct<span class="op">=</span><span class="fl">0.0</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span><span class="va">avt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span><span class="op">(</span><span class="va">yrs</span><span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">yrs</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">avt</span><span class="op">)</span>  </span>
<span><span class="va">count</span><span class="op">[</span><span class="va">count</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span> <span class="co"># with r=2.55 you should find an 8-cycle limit  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>avt
812.64 833.99 864.65  871.5 928.45 941.88 969.92 989.93 
    12     13     12     13     12     13     12     13 </code></pre>
</div>
</div>
<p>我们可以建立一个程序来寻找 <span class="math inline">\(r\)</span> 的值生成不同周期的稳定限制环，尽管下面的代码只是部分成功。通过设置一个 <em>for</em> 循环，将不同的值替换为 <span class="math inline">\(r\)</span> 值输入到 <code>discretelogistic()</code>，我们可以搜索一个长时间序列的最后几年在数值的时间序列中唯一的值。然而，四舍五入误差可能会导致意想不到的结果，特别是在不同类型的动态行为之间的边界。我们可以通过将检查的数值四舍五入到小数点后三位来避免这些问题，但请尝试在下面的代码中散列该行，以查看问题变得更糟。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#searches for unique solutions given an r value  see Table 3.2</span></span>
<span><span class="va">testseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.9</span>,<span class="fl">2.59</span>,<span class="fl">0.01</span><span class="op">)</span>  </span>
<span><span class="va">nseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">)</span>  </span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nseq</span>,ncol<span class="op">=</span><span class="fl">2</span>,  </span>
<span>                 dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">testseq</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r"</span>,<span class="st">"Unique"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fl">600</span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nseq</span><span class="op">)</span> <span class="op">{</span>  <span class="co"># i = 31  </span></span>
<span>   <span class="va">rval</span> <span class="op">&lt;-</span> <span class="va">testseq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  </span>
<span>   <span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="va">rval</span>,K<span class="op">=</span><span class="fl">1000.0</span>,N0<span class="op">=</span><span class="fl">100</span>,Ct<span class="op">=</span><span class="fl">0.0</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span>   <span class="va">ans</span> <span class="op">&lt;-</span> <span class="va">ans</span><span class="op">[</span><span class="op">-</span><span class="va">yrs</span>,<span class="op">]</span> <span class="co"># remove last year, see str(ans) for why  </span></span>
<span>   <span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span> <span class="co">#try hashing this out  </span></span>
<span>   <span class="va">result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rval</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="op">}</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>在上面的例子中，在 <span class="math inline">\(r\)</span> 值的范围内，最近的100次观测中，最多可以产生60个唯一值。这些代表了计算机上舍入误差的问题。如果持续运行的年数显著增加，那么预期最终会出现一种平衡。无论哪种情况，都存在一个明显的分裂或过渡，从单一平衡点，到2循环，到4循环，最后到8循环稳定极限。在行为的每个转变中，由于舍入误差，结果有一些不稳定性。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="fu">halftable</span><span class="op">(</span><span class="va">result</span>,yearcol <span class="op">=</span> <span class="st">"r"</span>, subdiv<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.2: Schaefer 模型动态。结果内容：在 600 年的预测动态中，从不同 r 值获得的 60 年内独特种群数量（N）。100 表示非平衡甚至混沌。
</figcaption><div aria-describedby="tbl-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">r</th>
<th style="text-align: right;">Unique</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">Unique</th>
<th style="text-align: right;">r</th>
<th style="text-align: right;">Unique</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="经典的混沌分岔图" class="level3" data-number="3.1.4"><h3 data-number="3.1.4" class="anchored" data-anchor-id="经典的混沌分岔图">
<span class="header-section-number">3.1.4</span> 经典的混沌分岔图</h3>
<p>May(1976) 对基于差分方程的单物种种群模型的动力学进行了综述。文中，他从非常简单的模型描述了混沌动力学的潜力。在那篇文章中，他绘制了一个图，他称之为分岔图（bifurcation diagram），该图显示了模型的平衡属性如何随着单个参数的改变而改变。我们可以使用<code>discretelogistic()</code>函数和下面的代码，以几乎任何精度复制 <a href="#fig-3-3" class="quarto-xref">图&nbsp;<span>3.3</span></a> 。</p>
<p>在分岔图的混沌中，偶尔会有一些简化，由图中的白色间隙表示出来。可以通过替换 <em>testseq</em> 向量中的数值来检查其中的下限位置，如下限值=2.82，上限= 2.87和inc = 0.0001 。这些起始点提供了更多的细节，在这些细节中有以前被掩盖的细节。这些也可以通过改变数值<em>testseq &lt; - c(2.845, 2.855, 0.00001)</em> 检查，于是分岔,2 - 4 -和更高的周期可以看到(甚至可以看到更多的细节通过改变<em>limy= 0</em> 参数绑定y-轴在 <span class="math inline">\(limy=c(600, 750)\)</span> 内感兴趣的区域绑定y轴所需的范围。这个图是通过在每个r的序列值处使用最终尾&lt;- 100点绘制的。可以增加模拟的年数和绘制的最终点的数量，以获得更好的分辨率在混沌区域。要查看更多细节，请在需要细节的区域扩展规模。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#the R code for the bifurcation function  </span></span>
<span><span class="va">bifurcation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">testseq</span>,<span class="va">taill</span><span class="op">=</span><span class="fl">100</span>,<span class="va">yrs</span><span class="op">=</span><span class="fl">1000</span>,<span class="va">limy</span><span class="op">=</span><span class="fl">0</span>,<span class="va">incx</span><span class="op">=</span><span class="fl">0.001</span><span class="op">)</span><span class="op">{</span>  </span>
<span>  <span class="va">nseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">)</span>  </span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nseq</span>,ncol<span class="op">=</span><span class="fl">2</span>,  </span>
<span>                  dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">testseq</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r"</span>,<span class="st">"Unique Values"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span>  <span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="va">nseq</span>,ncol<span class="op">=</span><span class="va">taill</span><span class="op">)</span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nseq</span><span class="op">)</span> <span class="op">{</span>    </span>
<span>     <span class="va">rval</span> <span class="op">&lt;-</span> <span class="va">testseq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  </span>
<span>     <span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="va">rval</span>,K<span class="op">=</span><span class="fl">1000.0</span>,N0<span class="op">=</span><span class="fl">100</span>,Ct<span class="op">=</span><span class="fl">0.0</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span>     <span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>  </span>
<span>     <span class="va">result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rval</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,<span class="va">taill</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span>     <span class="va">result2</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">ans</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,<span class="va">taill</span><span class="op">)</span>  </span>
<span>  <span class="op">}</span>    </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">limy</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">limy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu">getmax</span><span class="op">(</span><span class="va">result2</span>,mult<span class="op">=</span><span class="fl">1.02</span><span class="op">)</span><span class="op">)</span>  </span>
<span>  <span class="fu">parset</span><span class="op">(</span><span class="op">)</span> <span class="co"># plot taill values against taill of each r value  </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">taill</span><span class="op">)</span>,<span class="va">result2</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,type<span class="op">=</span><span class="st">"p"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.1</span>,  </span>
<span>   ylim<span class="op">=</span><span class="va">limy</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">incx</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">incx</span><span class="op">)</span><span class="op">)</span>,  </span>
<span>    xlab<span class="op">=</span><span class="st">"r value"</span>,yaxs<span class="op">=</span><span class="st">"i"</span>,xaxs<span class="op">=</span><span class="st">"i"</span>,ylab<span class="op">=</span><span class="st">"Equilibrium Numbers"</span>,  </span>
<span>     panel.first<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nseq</span><span class="op">)</span>  </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">testseq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">taill</span><span class="op">)</span>,<span class="va">result2</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>result<span class="op">=</span><span class="va">result</span>,result2<span class="op">=</span><span class="va">result2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="op">}</span> <span class="co"># end of bifurcation  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Alternative r value arrangements for you to try; Fig 3.3  </span></span>
<span> <span class="co">#testseq &lt;- seq(2.847,2.855,0.00001) #hash/unhash as needed </span></span>
<span> <span class="co">#bifurcation(testseq,limy=c(600,740),incx=0.0001) # t  </span></span>
<span> <span class="co">#testseq &lt;- seq(2.6225,2.6375,0.00001) # then explore   </span></span>
<span> <span class="co">#bifurcation(testseq,limy=c(660,730),incx=0.0001)   </span></span>
<span><span class="va">testseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.9</span>,<span class="fl">2.975</span>,<span class="fl">0.0005</span><span class="op">)</span> <span class="co"># modify to explore  </span></span>
<span><span class="fu">bifurcation</span><span class="op">(</span><span class="va">testseq</span>,limy<span class="op">=</span><span class="fl">0</span><span class="op">)</span>    </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.3: Schaefer 模型动态。一个经典的分岔图（May，1976），绘制了平衡动态与 r 值的函数关系，展示了从 2-、4-、8-循环以及混沌行为的转变。
</figcaption></figure>
</div>
</div>
</div>
</section><section id="捕捞对种群动态的影响" class="level3" data-number="3.1.5"><h3 data-number="3.1.5" class="anchored" data-anchor-id="捕捞对种群动态的影响">
<span class="header-section-number">3.1.5</span> 捕捞对种群动态的影响</h3>
<p>如果我们设置一个默认的 <code>discretelogisitic()</code> 运行，以在渔获量为零时拥有8个周期的稳定极限，我们可以应用不同水平的恒定渔获量，看看这可能如何影响动态。在这里，我们应用了 0,50,200 和 325 个个体(尽管 <span class="math inline">\(N_t\)</span>，<span class="math inline">\(K\)</span> 和 <span class="math inline">\(C_t\)</span> 也可能是吨)。当然是初始值 <span class="math inline">\(N_0\)</span> 必须大于捕获值，否则可以自由更改值。在下面四种情况中，我们假设 <span class="math inline">\(p\)</span> 值为 1.0 (= Schaefer模型)时，可以尝试 <span class="math inline">\(p=1e−08\)</span> 探讨使用与 Fox 模型等价的方法所产生的差异。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Effect of catches on stability properties of discretelogistic  </span></span>
<span><span class="va">yrs</span><span class="op">=</span><span class="fl">50</span>; <span class="va">Kval</span><span class="op">=</span><span class="fl">1000.0</span>  </span>
<span><span class="va">nocatch</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.56</span>,K<span class="op">=</span><span class="va">Kval</span>,N0<span class="op">=</span><span class="fl">500</span>,Ct<span class="op">=</span><span class="fl">0</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span><span class="va">catch50</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.56</span>,K<span class="op">=</span><span class="va">Kval</span>,N0<span class="op">=</span><span class="fl">500</span>,Ct<span class="op">=</span><span class="fl">50</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span><span class="va">catch200</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.56</span>,K<span class="op">=</span><span class="va">Kval</span>,N0<span class="op">=</span><span class="fl">500</span>,Ct<span class="op">=</span><span class="fl">200</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span>
<span><span class="va">catch300</span> <span class="op">&lt;-</span> <span class="fu">discretelogistic</span><span class="op">(</span>r<span class="op">=</span><span class="fl">2.56</span>,K<span class="op">=</span><span class="va">Kval</span>,N0<span class="op">=</span><span class="fl">500</span>,Ct<span class="op">=</span><span class="fl">300</span>,Yrs<span class="op">=</span><span class="va">yrs</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>我们组合了一个小函数 <code>plottime()</code>，以简化最终对象的重复绘图。我们还使用了效用函数 <code>parsyn()</code> 来辅助 <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> 函数的语法，以定义基本图形图的边界。请注意，生成这样的函数可以简化后续的代码，我建议构建这样一个有用的函数集合，可以与函数 <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> 一起使用，将它们引入到自己的会话中(就像预包;不要忘记在编写函数时记录文档，RStudio 甚至有一个插入 Roxygen 骨架命令)。在这里，随着捕获量的增加，可以看到动态开始稳定 4 到 2 周期，然后渐近平衡。注意，随着渔获量的增加，随着时间的推移(图表底部的数字)，平均渔获量下降。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Effect of different catches on n-cyclic behaviour Fig3.4  </span></span>
<span><span class="va">plottime</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">ylab</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>   <span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  </span>
<span>   <span class="fu">plot1</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span>,<span class="va">x</span><span class="op">[</span>,<span class="st">"nt"</span><span class="op">]</span>,ylab<span class="op">=</span><span class="va">ylab</span>,defpar<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>  </span>
<span>   <span class="va">avB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">(</span><span class="va">yrs</span><span class="op">-</span><span class="fl">40</span><span class="op">)</span><span class="op">:</span><span class="va">yrs</span>,<span class="st">"nt"</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>  </span>
<span>   <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="va">avB</span>,side<span class="op">=</span><span class="fl">1</span>,outer<span class="op">=</span><span class="cn">F</span>,line<span class="op">=</span><span class="op">-</span><span class="fl">1.1</span>,font<span class="op">=</span><span class="fl">7</span>,cex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>   </span>
<span><span class="op">}</span> <span class="co"># end of plottime  </span></span>
<span> <span class="co">#the oma argument is used to adjust the space around the graph  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">0</span>,<span class="fl">0.25</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.75</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="fl">0</span><span class="op">)</span>, font.axis<span class="op">=</span><span class="fl">7</span>,font<span class="op">=</span><span class="fl">7</span>,font.lab<span class="op">=</span><span class="fl">7</span><span class="op">)</span>    </span>
<span><span class="fu">plottime</span><span class="op">(</span><span class="va">nocatch</span>,<span class="st">"Catch = 0"</span><span class="op">)</span>  </span>
<span><span class="fu">plottime</span><span class="op">(</span><span class="va">catch50</span>,<span class="st">"Catch = 50"</span><span class="op">)</span>  </span>
<span><span class="fu">plottime</span><span class="op">(</span><span class="va">catch200</span>,<span class="st">"Catch = 200"</span><span class="op">)</span>  </span>
<span><span class="fu">plottime</span><span class="op">(</span><span class="va">catch300</span>,<span class="st">"Catch = 300"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"years"</span>,side<span class="op">=</span><span class="fl">1</span>,outer<span class="op">=</span><span class="cn">TRUE</span>,line<span class="op">=</span><span class="op">-</span><span class="fl">0.2</span>,font<span class="op">=</span><span class="fl">7</span>,cex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>   </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.4: Schaefer 模型动态。左上角的图描绘了未捕捞的预期动态（8 周期），而接下来的三个图，随着平均捕捞量的减少，说明了捕捞量增加而其他因素不变的影响。
</figcaption></figure>
</div>
</div>
</div>
<p>我们可以对四个相图做一些类似的事情。这里，我们从 <code>MQMF:::plot.dynpop()</code> 函数中借用了部分代码，以定义一个小型定制函数，以方便一起绘制四个阶段的图。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Phase plot for Schaefer model Fig 3.5  </span></span>
<span><span class="va">plotphase</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">label</span>,<span class="va">ymax</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span> <span class="co">#x from discretelogistic  </span></span>
<span>  <span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ymax</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">ymax</span> <span class="op">&lt;-</span> <span class="fu">getmax</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="st">"nt"</span><span class="op">]</span>,<span class="va">x</span><span class="op">[</span>,<span class="st">"nt1"</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"p"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">1.0</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ymax</span><span class="op">)</span>,  </span>
<span>       yaxs<span class="op">=</span><span class="st">"i"</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ymax</span><span class="op">)</span>,xaxs<span class="op">=</span><span class="st">"i"</span>,ylab<span class="op">=</span><span class="st">"nt1"</span>,xlab<span class="op">=</span><span class="st">""</span>,  </span>
<span>       panel.first<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"darkgrey"</span><span class="op">)</span>  </span>
<span>  <span class="va">begin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span><span class="op">(</span><span class="va">yrs</span> <span class="op">*</span> <span class="fl">0.6</span><span class="op">)</span> <span class="co">#last 40% of yrs = 20, when yrs=50  </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">begin</span><span class="op">:</span><span class="va">yrs</span>,<span class="st">"nt"</span><span class="op">]</span>,<span class="va">x</span><span class="op">[</span><span class="va">begin</span><span class="op">:</span><span class="va">yrs</span>,<span class="st">"nt1"</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">18</span>,col<span class="op">=</span><span class="fl">1</span>,cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="va">label</span>,side<span class="op">=</span><span class="fl">1</span>,outer<span class="op">=</span><span class="cn">F</span>,line<span class="op">=</span><span class="op">-</span><span class="fl">1.1</span>,font<span class="op">=</span><span class="fl">7</span>,cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>   </span>
<span><span class="op">}</span> <span class="co"># end of plotphase  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.75</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="fl">0</span><span class="op">)</span>, font.axis<span class="op">=</span><span class="fl">7</span>,font<span class="op">=</span><span class="fl">7</span>,font.lab<span class="op">=</span><span class="fl">7</span><span class="op">)</span>    </span>
<span><span class="fu">plotphase</span><span class="op">(</span><span class="va">nocatch</span>,<span class="st">"Catch = 0"</span>,ymax<span class="op">=</span><span class="fl">1300</span><span class="op">)</span>  </span>
<span><span class="fu">plotphase</span><span class="op">(</span><span class="va">catch50</span>,<span class="st">"Catch = 50"</span>,ymax<span class="op">=</span><span class="fl">1300</span><span class="op">)</span>  </span>
<span><span class="fu">plotphase</span><span class="op">(</span><span class="va">catch200</span>,<span class="st">"Catch = 200"</span>,ymax<span class="op">=</span><span class="fl">1300</span><span class="op">)</span>  </span>
<span><span class="fu">plotphase</span><span class="op">(</span><span class="va">catch300</span>,<span class="st">"Catch = 300"</span>,ymax<span class="op">=</span><span class="fl">1300</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"nt"</span>,side<span class="op">=</span><span class="fl">1</span>,outer<span class="op">=</span><span class="cn">T</span>,line<span class="op">=</span><span class="fl">0.0</span>,font<span class="op">=</span><span class="fl">7</span>,cex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"nt+1"</span>,side<span class="op">=</span><span class="fl">2</span>,outer<span class="op">=</span><span class="cn">T</span>,line<span class="op">=</span><span class="fl">0.0</span>,font<span class="op">=</span><span class="fl">7</span>,cex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-5-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.5: Schaefer 模型动态。四个持续捕捞场景的相图。
</figcaption></figure>
</div>
</div>
</div>
<p>随着固定捕获量的增加，隐含抛物线曲线(奇异吸引子)的最大值下降。渔获量(<span class="math inline">\(\equiv\)</span> 捕食者)似乎对种群的动态有稳定的影响。在自然界中是否如此，将取决于特定种群的生物学是否反映了用于描述动态的模型的基本假设(例如，Schaefer 模型假设种群中存在线性密度依赖)。</p>
<p>现在，我们应该很清楚，即使是简单的模型也可以表现出复杂的行为。我们只是稍微触及了这个主题，但同样清楚的是，使用 R，可以探索这些想法到任何深度。</p>
</section><section id="决定论" class="level3" data-number="3.1.6"><h3 data-number="3.1.6" class="anchored" data-anchor-id="决定论">
<span class="header-section-number">3.1.6</span> 决定论</h3>
<p>本章所有的模型都表现出确定性动力学，即使是混沌动力学，在初始条件重复的情况下也会遵循相同的轨迹。当然，在自然界中，这种确定性行为是罕见的。模型总是对可能发生的事情进行抽象。与生产力相关的自然过程(自然死亡率、生长和繁殖)都将随着时间的推移而变化，这是对食物供应、生态相互作用和环境影响(如温度)的响应。通过包括所谓的过程误差，可以将过程中的这种可变性近似地包括到模型中，过程误差可以用方程形式表示为:</p>
<p><span id="eq-3_2"><span class="math display">\[
{N_{t+1}}={N_t}+{({r+\varepsilon_t}){N_t}}\left( 1-{{\left( \frac{N_t}{(K+\varepsilon_t)} \right)}} \right)
\qquad(3.2)\]</span></span></p>
<p>其中 <span class="math inline">\(\varepsilon\)</span> 和 <span class="math inline">\(\epsilon\)</span> 表示每个模型参数随时间 <span class="math inline">\(t\)</span> 变化的正态随机误差。有时，在模拟中，只有一个参数会添加变化。作为种群现象，这将导致种群数量遵循不一定是平滑的轨迹，而且在模拟中，单个复制将不足以捕捉可能的动态的潜在范围。在模拟中是否包括这种过程误差将取决于模拟的目的。在这里，目的是探索确定性种群动态的期望，但应该始终记住，这些模型只是近似，旨在代表平均行为。</p>
</section></section><section id="年龄结构的建模概念" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="年龄结构的建模概念">
<span class="header-section-number">3.2</span> 年龄结构的建模概念</h2>
<p>当然，在我们刚刚考察的剩余产量模型中，最大的简化是，它们忽略了与年龄和个体大小有关的生物学和行为差异的所有方面。这种简化的模型仍然有用(见第 <a href="07-spm.html" class="quarto-xref"><span>7</span></a> 章“<a href="./07-spm.html">剩余产量模型</a>”（<em>Surplus Production Models</em>） )，但面对公认的网具选择性(类似于捕食者有偏好的猎物)和不同年龄的生长和繁殖力、渔业和其他自然资源科学家经常在他们的模型中包括年龄和或大小。在这里，我们将只对这些想法进行初步处理，因为在详细讨论这些复杂问题之前，还需要建模动态过程的许多其他细节。</p>
<section id="世代中的残存" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="世代中的残存">
<span class="header-section-number">3.2.1</span> 世代中的残存</h3>
<p>很明显，个体的残存，<span class="math inline">\(S\)</span>，两个时间段之间的残存可用 <span class="math inline">\(t+1\)</span> 时的数量与 <span class="math inline">\(t\)</span> 时的数量的比值表示(记住，如果知道体重与年龄的关系，年龄-数量可以转换为年龄-体质量或年龄-生物量):</p>
<p><span id="eq-3_3"><span class="math display">\[
S_t=\frac{{{N}_{t+1}}}{{{N}_{t}}} \quad \text{ or }\quad {{N}_{t+1}}={S_t}{N}_{t}
\qquad(3.3)\]</span></span></p>
<p>这种随时间的比例减少暗示着负指数增长。给定瞬时总死亡率为 <span class="math inline">\(Z\)</span> (自然死亡率和捕捞死亡率之和)，则每年的残存率(即存活的比例)等于 <span class="math inline">\(e^{−Z}\)</span>。这可以通过设置一个具有恒定初始条件的模拟种群，并应用不同瞬时总死亡率向量来说明。</p>
<p>这将相当于考虑一个单一世代补充的为 0+ 年龄的个体。假设没有移入个体，这样的单一世代种群只能在数量上下降，尽管这看起来很明显，但在考虑年龄结构的种群时，这是重要的直觉。总死亡率(通常用 <span class="math inline">\(Z\)</span> 表示)仅仅是自然死亡率(通常用 <span class="math inline">\(M\)</span> 表示)和捕捞死亡率(通常用 <span class="math inline">\(F\)</span> 表示)的总和。在下面的例子中，请注意，应用<span class="math inline">\(Z =0.05\)</span> 会导致即使在 50 年后种群数量也大于零。图示中的每个世代轨迹都描述了种群规模的指数或恒定比例下降。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Exponential population declines under different Z. Fig 3.6  </span></span>
<span><span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fl">50</span>;  <span class="va">yrs1</span> <span class="op">&lt;-</span> <span class="va">yrs</span> <span class="op">+</span> <span class="fl">1</span> <span class="co"># to leave room for B[0]  </span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">yrs</span>,<span class="fl">1</span><span class="op">)</span>  </span>
<span><span class="va">B0</span> <span class="op">&lt;-</span> <span class="fl">1000</span>        <span class="co"># now alternative total mortality rates  </span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.55</span><span class="op">)</span>   </span>
<span><span class="va">nZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>  </span>
<span><span class="va">Bt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">yrs1</span>,ncol<span class="op">=</span><span class="va">nZ</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">years</span>,<span class="va">Z</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">Bt</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">B0</span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nZ</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">yrs1</span><span class="op">)</span> <span class="va">Bt</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Bt</span><span class="op">[</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>  </span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">years</span>,<span class="va">Bt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,xlab<span class="op">=</span><span class="st">"Years"</span>,ylab<span class="op">=</span><span class="st">"Population Size"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">nZ</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nZ</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">years</span>,<span class="va">Bt</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="va">j</span>,lty<span class="op">=</span><span class="va">j</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Z = "</span>,<span class="va">Z</span><span class="op">)</span>,col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">nZ</span>,lwd<span class="op">=</span><span class="fl">3</span>,  </span>
<span>       bty<span class="op">=</span><span class="st">"n"</span>,cex<span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>   </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-6-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.6: 不同总死亡率水平下的指数型种群衰退。最上方的曲线是 Z = 0.05，最陡峭的曲线是 Z = 0.55。
</figcaption></figure>
</div>
</div>
</div>
</section><section id="瞬时-vs-年死亡率" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="瞬时-vs-年死亡率">
<span class="header-section-number">3.2.2</span> 瞬时 Vs 年死亡率</h3>
<p>在前一节中，我们讨论了所谓的瞬时率。它们可以用来生成残存率，即在给定瞬时死亡率的一年后预期残存的比例。瞬时死亡率的概念是指在无限小的时间段内的死亡率。</p>
<p>我们已经知道每年残存的比例:</p>
<p><span id="eq-3_4"><span class="math display">\[
S={e}^{-Z}
\qquad(3.4)\]</span></span></p>
<p>因此1年时间死亡率（ <span class="math inline">\(A\)</span> ）表示为：</p>
<p><span id="eq-3_5"><span class="math display">\[
A=1-{e}^{-Z}
\qquad(3.5)\]</span></span></p>
<p>如果只考虑瞬时捕捞死亡率 <span class="math inline">\(F\)</span>，而忽略自然死亡率，则死亡的比例称为捕获率，<span class="math inline">\(H\)</span>。</p>
<p><span id="eq-3_6"><span class="math display">\[
H=1-{e}^{-F}
\qquad(3.6)\]</span></span></p>
<p>如果知道了每年的捕获率，就可以将其反向转换来估计瞬时捕捞死亡率。</p>
<p><span id="eq-3_7"><span class="math display">\[
F=-\log{(1-H)}
\qquad(3.7)\]</span></span></p>
<p>其中 <code>log</code> 是自然对数或以 <span class="math inline">\(e\)</span> 为底的对数。</p>
<p>有时似乎很难直观地理解瞬时速率的含义。如果举例说明瞬时率是如何推导出来的，这个困难就会减轻。从 1000 个个体的种群开始，假设每年的移除率为 <span class="math inline">\(0.5\)</span>，这意味着只有 500 个个体能存活一年。将年总死亡率代入最后一个方程，可估计瞬时总死亡率为 <span class="math inline">\(-\log(1-0.5) = 0.693147\)</span>。如果我们使用两个 6 个月周期来近似这个水平所需的时间步长，以获得 50% 的存活率，我们需要将 0.693147 除以 2.0，并将死亡率用 2 次。类似地，如果时间步长是每月的，我们将除以 12，并将结果应用 12 次。虽然很难将每个月称为瞬时，但这将是适用近似瞬时死亡率 (0.693147/12) 的期间。这种重新缩放可以在越来越小的时间间隔中发生，直到时间间隔足够小，结果与预期的 500 个年终剩余个体没有显著差异（ <a href="#tbl-3-3" class="quarto-xref">表&nbsp;<span>3.3</span></a> ）。</p>
<p>显而易见，应用近似瞬时速率的时间间隔越短，最终值就越接近预期的1000的0.5(即500)。希望这些代码能够帮助您对瞬时死亡率概念有直观的了解。</p>
<p>可以根据瞬时死亡率绘制年死亡率图，以说明两者之间的差异。请注意，瞬时死亡率大约 为 0.18 时，年收捕获 率也大致相同。应该清楚的是，不可能获得大于 1.0 的捕获率(相当于捕获&gt;100%的可开发生物量)。高的捕获率开始显得难以置信，如果它们出现在适合渔业模式的情况下，那么在被接受之前，它们确实需要得到保护。另一方面，瞬时率显然可以超过 1.0，但理想情况下，这样的事件不应再被误解。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Prepare matrix of harvest rate vs time to appoximate F  </span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>  </span>
<span><span class="va">timediv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">12</span>,<span class="fl">52</span>,<span class="fl">365</span>,<span class="fl">730</span>,<span class="fl">2920</span>,<span class="fl">8760</span>,<span class="fl">525600</span><span class="op">)</span>  </span>
<span><span class="va">yrfrac</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">timediv</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">yrfrac</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"6mth"</span>,<span class="st">"3mth"</span>,<span class="st">"1mth"</span>,<span class="st">"1wk"</span>,<span class="st">"1d"</span>,<span class="st">"12h"</span>,  </span>
<span>                   <span class="st">"3h"</span>,<span class="st">"1h"</span>,<span class="st">"1m"</span><span class="op">)</span>  </span>
<span><span class="va">nfrac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">yrfrac</span><span class="op">)</span>  </span>
<span><span class="va">columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yrfrac"</span>,<span class="st">"divisor"</span>,<span class="st">"yrfracH"</span>,<span class="st">"Remain"</span><span class="op">)</span>  </span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nfrac</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">columns</span><span class="op">)</span>,  </span>
<span>                 dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">yrfrac</span><span class="op">)</span>,<span class="va">columns</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nfrac</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>   <span class="va">timestepmort</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">/</span><span class="va">timediv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>   </span>
<span>   <span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  </span>
<span>   <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">timediv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">timestepmort</span><span class="op">)</span>  </span>
<span>   <span class="va">result</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">yrfrac</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">timediv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">timestepmort</span>,<span class="va">N</span><span class="op">)</span>  </span>
<span><span class="op">}</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">result</span>,digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">8</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-3" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.3: 将恒定的总死亡率分配到越来越短的时间段内，且这些时间段总和为一年时的结果。yrfrac 是一年的分数，Approx 是瞬时总死亡率除以除数，Remain 是一年后剩余的动物数量（从 1000 开始计算）。
</figcaption><div aria-describedby="tbl-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">yrfrac</th>
<th style="text-align: right;">divisor</th>
<th style="text-align: right;">yrfracH</th>
<th style="text-align: right;">Remain</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6mth</td>
<td style="text-align: right;">0.5000000000</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.34657359</td>
<td style="text-align: right;">426.9661</td>
</tr>
<tr class="even">
<td style="text-align: left;">3mth</td>
<td style="text-align: right;">0.2500000000</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.17328680</td>
<td style="text-align: right;">467.1104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1mth</td>
<td style="text-align: right;">0.0833333333</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.05776227</td>
<td style="text-align: right;">489.6953</td>
</tr>
<tr class="even">
<td style="text-align: left;">1wk</td>
<td style="text-align: right;">0.0192307692</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">0.01332975</td>
<td style="text-align: right;">497.6748</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1d</td>
<td style="text-align: right;">0.0027397260</td>
<td style="text-align: right;">365</td>
<td style="text-align: right;">0.00189903</td>
<td style="text-align: right;">499.6706</td>
</tr>
<tr class="even">
<td style="text-align: left;">12h</td>
<td style="text-align: right;">0.0013698630</td>
<td style="text-align: right;">730</td>
<td style="text-align: right;">0.00094952</td>
<td style="text-align: right;">499.8354</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3h</td>
<td style="text-align: right;">0.0003424658</td>
<td style="text-align: right;">2920</td>
<td style="text-align: right;">0.00023738</td>
<td style="text-align: right;">499.9589</td>
</tr>
<tr class="even">
<td style="text-align: left;">1h</td>
<td style="text-align: right;">0.0001141553</td>
<td style="text-align: right;">8760</td>
<td style="text-align: right;">0.00007913</td>
<td style="text-align: right;">499.9863</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1m</td>
<td style="text-align: right;">0.0000019026</td>
<td style="text-align: right;">525600</td>
<td style="text-align: right;">0.00000132</td>
<td style="text-align: right;">499.9998</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Annual harvest rate against instantaneous F, Fig 3.7  </span></span>
<span><span class="va">Fi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.001</span>,<span class="fl">2</span>,<span class="fl">0.001</span><span class="op">)</span>  </span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Fi</span><span class="op">)</span>  </span>
<span><span class="fu">parset</span><span class="op">(</span><span class="op">)</span>  <span class="co"># a wrapper for simplifying defining the par values  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Fi</span>,<span class="va">H</span>,type<span class="op">=</span><span class="st">"l"</span>,lwd<span class="op">=</span><span class="fl">2</span>,panel.first<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>,  </span>
<span>     xlab<span class="op">=</span><span class="st">"Instantaneous Fishing Mortality F"</span>,  </span>
<span>     ylab<span class="op">=</span><span class="st">"Annual Proportion Mortality H"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-7-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.7: 瞬时捕捞死亡率（实线）与年度捕捞死亡率或年度收获率（虚线）之间的关系。在 F 值大于约 0.2 时，数值开始分离。
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="简单单位补充量渔获量" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="简单单位补充量渔获量">
<span class="header-section-number">3.3</span> 简单单位补充量渔获量</h2>
<p>我们知道，一旦某一世代补充到群体中，其数量只会减少(假设没有迁入)。注意”补充量（recruitment）“的概念，它可以指后期仔鱼进入资源后，然而，它也可以指个体变得可用或易受渔业损害。这里我们关注的是仔鱼后加入资源后的情况。当我们在下面和第 <a href="05-staticModel.html" class="quarto-xref"><span>5</span></a> 章“静态模型”（<em>Static Models</em>）的章节中考虑选择性和可用性概念时，我们将处理补充量加入到渔业。有趣的是,尽管数字预计将减少通过时间,鉴于个体体长和重量上生长，我们还不知道如果世代的质量总是随时间减少或者增加然后减少最终所有的个体死亡。</p>
<p>一个世代的质量是否会在几年内增加，即使它的数量首次发现下降，因为对于捕获和努力之间的关系有一种简单但普遍的直觉。很明显，一种鱼类的渔获量总是会随着捕捞努力量的增加而增加，但这只是短期的想法。这个看似显而易见的概念在1930年之前就被驳斥了，并被 <span class="citation" data-cites="russell1942">Russell (<a href="08-references.html#ref-russell1942" role="doc-biblioref">1942</a>)</span> 的一些出版著作很好地阐述了，他证明了一个渔业的最大持续渔获量不一定来自于最大努力量(或最大捕捞死亡)。这不仅是一个学术问题，而且直接关系到渔业的管理。一旦人们意识到过度捕捞甚至是鱼类资源崩溃的可能性，这一问题直到 20 世纪初才被正式承认 (Garstang, 1900)，那么如何最好地管理渔业就成为一个重要的问题。在管理渔业时，曾试图管理所作的全部努力量。支持这一观点的一个论点来自于单位补充量渔获量 (yield-per-recruit，YPR) 的概念，该概念以数量和质量的形式从数学上跟踪了在不同水平的强制捕捞死亡率下的世代的命运；捕捞死亡率被认为与所采取的努力量直接相关。“单位补充量”的概念意味着它遵循个体世代，并以最大化每个补充量的收益为目标。</p>
<p>我们将重复 <span class="citation" data-cites="russell1942">Russell (<a href="08-references.html#ref-russell1942" role="doc-biblioref">1942</a>)</span> 的例子来说明YPR背后的思想。Russell 的例子只涉及捕捞死亡率，这与假设没有自然死亡率（忽略了 M）是一样的。对于这个简单的 YPR 我们也会忽略自然死亡率和应用一系列常数收获率每年计算年龄-数量（numbers-at-age）(相当于式 <a href="#eq-3_3" class="quarto-xref">公式&nbsp;<span>3.3</span></a> ),我们将使用一个年龄-体重乘以年龄-数量计算年龄-渔获量的重量,从中我们可以获得总的预期渔获量。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simple Yield-per-Recruit see Russell (1942)  </span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>;  <span class="va">nage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>; <span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  <span class="co"># some definitions  </span></span>
<span> <span class="co"># weight-at-age values  </span></span>
<span><span class="va">WaA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0.082</span>,<span class="fl">0.175</span>,<span class="fl">0.283</span>,<span class="fl">0.4</span>,<span class="fl">0.523</span>,<span class="fl">0.7</span>,<span class="fl">0.85</span>,<span class="fl">0.925</span>,<span class="fl">0.99</span>,<span class="fl">1.0</span><span class="op">)</span>  </span>
<span> <span class="co"># now the harvest rates  </span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.06</span>,<span class="fl">0.11</span>,<span class="fl">0.16</span>,<span class="fl">0.21</span>,<span class="fl">0.26</span>,<span class="fl">0.31</span>,<span class="fl">0.36</span>,<span class="fl">0.55</span>,<span class="fl">0.8</span><span class="op">)</span>  </span>
<span><span class="va">nH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span>  </span>
<span><span class="va">NaA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nage</span>,ncol<span class="op">=</span><span class="va">nH</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">age</span>,<span class="va">H</span><span class="op">)</span><span class="op">)</span> <span class="co"># storage  </span></span>
<span><span class="va">CatchN</span> <span class="op">&lt;-</span> <span class="va">NaA</span>;  <span class="va">CatchW</span> <span class="op">&lt;-</span> <span class="va">NaA</span>      <span class="co"># define some storage matrices  </span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nH</span><span class="op">)</span> <span class="op">{</span>                <span class="co"># loop through the harvest rates  </span></span>
<span>   <span class="va">NaA</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">N0</span>  <span class="co"># start each harvest rate with initial numbers  </span></span>
<span>   <span class="kw">for</span> <span class="op">(</span><span class="va">age</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nage</span><span class="op">)</span> <span class="op">{</span>  <span class="co"># loop through over-simplified dynamics  </span></span>
<span>      <span class="va">NaA</span><span class="op">[</span><span class="va">age</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">NaA</span><span class="op">[</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">H</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>  </span>
<span>      <span class="va">CatchN</span><span class="op">[</span><span class="va">age</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">NaA</span><span class="op">[</span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">NaA</span><span class="op">[</span><span class="va">age</span>,<span class="va">i</span><span class="op">]</span>  </span>
<span>   <span class="op">}</span>  </span>
<span>   <span class="va">CatchW</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">CatchN</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">WaA</span>  </span>
<span><span class="op">}</span>                      <span class="co"># transpose the vector of total catches to  </span></span>
<span><span class="va">totC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">CatchW</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>   <span class="co"># simplify later printing  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>不同的渔获率对种群年龄结构的影响在渔获的分年龄数量和分年龄重量上都很明显。随着渔获率的增加，高年龄组的捕获数量越来越少，分年龄捕获数也越来越少。对于较高的捕获率，种群变得依赖于最近的补充量，而不是在较老的年龄组中数量和生物量的积累。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">NaA</span>,digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,row.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-4" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.4: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获数量。
</figcaption><div aria-describedby="tbl-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0.01</th>
<th style="text-align: right;">0.06</th>
<th style="text-align: right;">0.11</th>
<th style="text-align: right;">0.16</th>
<th style="text-align: right;">0.21</th>
<th style="text-align: right;">0.26</th>
<th style="text-align: right;">0.31</th>
<th style="text-align: right;">0.36</th>
<th style="text-align: right;">0.55</th>
<th style="text-align: right;">0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">1000.0</td>
<td style="text-align: right;">1000.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">990</td>
<td style="text-align: right;">940</td>
<td style="text-align: right;">890</td>
<td style="text-align: right;">840</td>
<td style="text-align: right;">790</td>
<td style="text-align: right;">740</td>
<td style="text-align: right;">690</td>
<td style="text-align: right;">640</td>
<td style="text-align: right;">450.0</td>
<td style="text-align: right;">200.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">980</td>
<td style="text-align: right;">884</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">706</td>
<td style="text-align: right;">624</td>
<td style="text-align: right;">548</td>
<td style="text-align: right;">476</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">202.5</td>
<td style="text-align: right;">40.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">970</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">705</td>
<td style="text-align: right;">593</td>
<td style="text-align: right;">493</td>
<td style="text-align: right;">405</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">262</td>
<td style="text-align: right;">91.1</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">961</td>
<td style="text-align: right;">781</td>
<td style="text-align: right;">627</td>
<td style="text-align: right;">498</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">227</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">41.0</td>
<td style="text-align: right;">1.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">951</td>
<td style="text-align: right;">734</td>
<td style="text-align: right;">558</td>
<td style="text-align: right;">418</td>
<td style="text-align: right;">308</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">941</td>
<td style="text-align: right;">690</td>
<td style="text-align: right;">497</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">243</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">932</td>
<td style="text-align: right;">648</td>
<td style="text-align: right;">442</td>
<td style="text-align: right;">295</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">923</td>
<td style="text-align: right;">610</td>
<td style="text-align: right;">394</td>
<td style="text-align: right;">248</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">914</td>
<td style="text-align: right;">573</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">208</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">904</td>
<td style="text-align: right;">539</td>
<td style="text-align: right;">312</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">CatchW</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">11</span>,<span class="op">]</span>,digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,row.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-5" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.5: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获重量。
</figcaption><div aria-describedby="tbl-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0.01</th>
<th style="text-align: right;">0.06</th>
<th style="text-align: right;">0.11</th>
<th style="text-align: right;">0.16</th>
<th style="text-align: right;">0.21</th>
<th style="text-align: right;">0.26</th>
<th style="text-align: right;">0.31</th>
<th style="text-align: right;">0.36</th>
<th style="text-align: right;">0.55</th>
<th style="text-align: right;">0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">4.92</td>
<td style="text-align: right;">9.02</td>
<td style="text-align: right;">13.12</td>
<td style="text-align: right;">17.22</td>
<td style="text-align: right;">21.32</td>
<td style="text-align: right;">25.42</td>
<td style="text-align: right;">29.52</td>
<td style="text-align: right;">45.10</td>
<td style="text-align: right;">65.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">9.87</td>
<td style="text-align: right;">17.13</td>
<td style="text-align: right;">23.52</td>
<td style="text-align: right;">29.03</td>
<td style="text-align: right;">33.67</td>
<td style="text-align: right;">37.43</td>
<td style="text-align: right;">40.32</td>
<td style="text-align: right;">43.31</td>
<td style="text-align: right;">28.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">24.66</td>
<td style="text-align: right;">31.95</td>
<td style="text-align: right;">37.09</td>
<td style="text-align: right;">40.29</td>
<td style="text-align: right;">41.77</td>
<td style="text-align: right;">41.73</td>
<td style="text-align: right;">31.52</td>
<td style="text-align: right;">9.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">3.88</td>
<td style="text-align: right;">19.93</td>
<td style="text-align: right;">31.02</td>
<td style="text-align: right;">37.93</td>
<td style="text-align: right;">41.42</td>
<td style="text-align: right;">42.14</td>
<td style="text-align: right;">40.74</td>
<td style="text-align: right;">37.75</td>
<td style="text-align: right;">20.05</td>
<td style="text-align: right;">2.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">5.02</td>
<td style="text-align: right;">24.50</td>
<td style="text-align: right;">36.10</td>
<td style="text-align: right;">41.66</td>
<td style="text-align: right;">42.78</td>
<td style="text-align: right;">40.78</td>
<td style="text-align: right;">36.75</td>
<td style="text-align: right;">31.59</td>
<td style="text-align: right;">11.80</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">6.66</td>
<td style="text-align: right;">30.82</td>
<td style="text-align: right;">43.00</td>
<td style="text-align: right;">46.84</td>
<td style="text-align: right;">45.23</td>
<td style="text-align: right;">40.39</td>
<td style="text-align: right;">33.94</td>
<td style="text-align: right;">27.06</td>
<td style="text-align: right;">7.10</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">35.18</td>
<td style="text-align: right;">46.47</td>
<td style="text-align: right;">47.78</td>
<td style="text-align: right;">43.39</td>
<td style="text-align: right;">36.29</td>
<td style="text-align: right;">28.44</td>
<td style="text-align: right;">21.03</td>
<td style="text-align: right;">3.88</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">8.62</td>
<td style="text-align: right;">35.99</td>
<td style="text-align: right;">45.01</td>
<td style="text-align: right;">43.67</td>
<td style="text-align: right;">37.30</td>
<td style="text-align: right;">29.22</td>
<td style="text-align: right;">21.35</td>
<td style="text-align: right;">14.65</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">9.14</td>
<td style="text-align: right;">36.21</td>
<td style="text-align: right;">42.87</td>
<td style="text-align: right;">39.26</td>
<td style="text-align: right;">31.54</td>
<td style="text-align: right;">23.15</td>
<td style="text-align: right;">15.77</td>
<td style="text-align: right;">10.03</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">9.14</td>
<td style="text-align: right;">34.38</td>
<td style="text-align: right;">38.54</td>
<td style="text-align: right;">33.31</td>
<td style="text-align: right;">25.17</td>
<td style="text-align: right;">17.30</td>
<td style="text-align: right;">10.99</td>
<td style="text-align: right;">6.49</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">totC</span>,digits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-6" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.6: 应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下种群的渔获量。
</figcaption><div aria-describedby="tbl-3-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">0.01</th>
<th style="text-align: right;">0.06</th>
<th style="text-align: right;">0.11</th>
<th style="text-align: right;">0.16</th>
<th style="text-align: right;">0.21</th>
<th style="text-align: right;">0.26</th>
<th style="text-align: right;">0.31</th>
<th style="text-align: right;">0.36</th>
<th style="text-align: right;">0.55</th>
<th style="text-align: right;">0.8</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">55.8</td>
<td style="text-align: right;">246.8</td>
<td style="text-align: right;">333.8</td>
<td style="text-align: right;">359.1</td>
<td style="text-align: right;">350.2</td>
<td style="text-align: right;">324.5</td>
<td style="text-align: right;">292.6</td>
<td style="text-align: right;">260.2</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">106.1</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>如果使用 <strong>MQMF</strong> 中的 <code>plot1()</code>函数绘制渔获总重量对捕获率的图，我们可以立即看到，在产量方面确实存在一个最佳渔获率，而不是最大利用率。如果让努力量增加，渔获量并不总是增加。如果捕获率很低，那么捕获的鱼类太少，不足以弥补显著的捕获量。然而，产量随着捕获率的增加而迅速增加，而当超过产生最大产量的捕获率时，产量下降得更慢。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Use MQMF::plot1 for a quick plot of the total catches. Figure 3.8  </span></span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">H</span>,<span class="va">totC</span>,xlab<span class="op">=</span><span class="st">"Harvest Rate"</span>,ylab<span class="op">=</span><span class="st">"Total Yield"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-8-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.8: 忽略自然死亡率、年龄选择性或任何其他影响的简化单位补充量-渔获量分析。该分析使用了 Russell（1942）的部分年龄-体重数据，尽管 Russell 仅考察了两种捕捞率，但本分析考察了更广泛的捕捞率。
</figcaption></figure>
</div>
</div>
</div>
<p>为了快速说明不同捕获率的影响，这个例子在 1942 年获得了成功。对单位补充量渔获量的更全面的处理需要考虑动态中的自然死亡率和网具选择性带来的年龄死亡率差异。</p>
<section id="sec-ypr_selectivity" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-ypr_selectivity">
<span class="header-section-number">3.3.1</span> 单位补充量渔获量中的选择性</h3>
<p>通常，在完全年龄结构的渔业模型中，人们会用一个选择性函数来描述每个年龄组(或体长组)对特定捕捞网具的不同脆弱性。随着鱼的年龄增加(或变大)，鱼会越来越多地补充到渔业中，直到它们完全易于受到捕捞的影响。通常，这种选择性曲线的参数是在将年龄结构模型与渔业数据拟合的过程中获得的。然而，在这里，我们将仅仅是给定了属性值(参见第 <a href="05-staticModel.html" class="quarto-xref"><span>5</span></a>章“静态模型”（<em>static Models</em>）中选择性的更多细节)。早期的 YPR 分析经常使用所谓的刀刃选择性，这意味着鱼类在特定年龄 100% 容易受到渔具的攻击。然而，在这里，我们将实现一个更现实、但更简单的脆弱性随年龄的选择性曲线。有许多不同的方程用来描述不同渔具的选择性特性，但拖网渔具使用的一个非常常见的方程是标准 logistic 或 s 形曲线，它也可以有许多公式化的表达式。一个常用来描述随年龄 <span class="math inline">\(S_a\)</span> 或体长变化，选择性 logistic 形状 ，以及年龄或体长的成熟度定义为:</p>
<p><span id="eq-3_8"><span class="math display">\[
{{S}_{a}}=\frac{1}{1+{{({{e}^{(\alpha +\beta a)}})}^{-1}}}=\frac{{{e}^{(\alpha +\beta a)}}}{1+{{e}^{(\alpha +\beta a)}}}
\qquad(3.8)\]</span></span></p>
<p>式中 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 为 logistic 参数，<span class="math inline">\(-\alpha/\beta\)</span> 为 0.5（50%）选择性处的年龄。四分位数之间的距离(字面上分位数的25%到75%；logistic曲线梯度的度量)定义为 <span class="math inline">\(IQ=2\log(3)/\beta\)</span>（参见 <strong>MQMF</strong> 函数 <code>mature()</code> 用于该函数的执行）。一般来说，在年龄结构模型中，需要长度或年龄组成数据，以便直接估计网具选择性和渔业可用性。在计算单位补充量渔获量时，通常的理由是要包括一种形式的选择性，以确定开始应用捕捞死亡率的最佳年龄。在管理方面，这可以用来确定拖网或刺网的网眼尺寸。这就是为什么刀刃选择性经常被使用的原因，它可以识别年龄在什么年龄以下没有选择，在什么年龄以上有 100% 的选择。这在 <strong>MQMF</strong> 函数 <code>logistic()</code> 中实现（使用不同的公式），但在 <code>mature()</code> 中没有实现。刀刃选择性并不倾向于在完整的年龄结构种群评估模型中使用。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co">#Logistic S shaped cureve for maturity  </span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">1</span><span class="op">)</span>  </span>
<span><span class="va">sel1</span> <span class="op">&lt;-</span> <span class="fu">mature</span><span class="op">(</span><span class="op">-</span><span class="fl">3.650425</span>,<span class="fl">0.146017</span>,sizeage<span class="op">=</span><span class="va">ages</span><span class="op">)</span> <span class="co">#-3.65/0.146=25  </span></span>
<span><span class="va">sel2</span> <span class="op">&lt;-</span> <span class="fu">mature</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">0.2</span>,<span class="va">ages</span><span class="op">)</span>  </span>
<span><span class="va">sel3</span> <span class="op">&lt;-</span> <span class="fu">mature</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">0.24</span>,<span class="va">ages</span><span class="op">)</span>  </span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">ages</span>,<span class="va">sel1</span>,xlab<span class="op">=</span><span class="st">"Age Yrs"</span>,ylab<span class="op">=</span><span class="st">"Selectivity"</span>,cex<span class="op">=</span><span class="fl">0.75</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">ages</span>,<span class="va">sel2</span>,col<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">ages</span>,<span class="va">sel3</span>,col<span class="op">=</span><span class="fl">3</span>,lwd<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">25</span>,col<span class="op">=</span><span class="st">"grey"</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"grey"</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"25_15.04"</span>,<span class="st">"30_10.986"</span>,<span class="st">"25_9.155"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,  </span>
<span>       lwd<span class="op">=</span><span class="fl">3</span>,cex<span class="op">=</span><span class="fl">1.1</span>,bty<span class="op">=</span><span class="st">"n"</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>  </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-9" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-9-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.9: 使用 mature() 函数的逻辑斯蒂 S 形曲线示例。图例包含每条曲线的 L50 和 IQ，其参数在代码中定义。
</figcaption></figure>
</div>
</div>
</div>
</section><section id="baranov-渔获量方程" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="baranov-渔获量方程">
<span class="header-section-number">3.3.2</span> Baranov 渔获量方程</h3>
<p><a href="#eq-3_4" class="quarto-xref">公式&nbsp;<span>3.4</span></a> 描述了结合捕捞和自然死亡后的残存率，但简单的总死亡率 <span class="math inline">\(Z\)</span>意味着所有鱼的捕捞死亡率相同。如果我们要考虑选择性，那么我们需要考虑年龄的捕捞死亡率。</p>
<p><span id="eq-3_9"><span class="math display">\[
S_{a,t}=e^{-(M + {s_a}{F_t})}
\qquad(3.9)\]</span></span></p>
<p>其中 <span class="math inline">\(S_{a,t}\)</span> 为 <span class="math inline">\(t\)</span> 年 <span class="math inline">\(a\)</span> 龄鱼的残存率，<span class="math inline">\(M\)</span> 为自然死亡系数（假设随时间不变），<span class="math inline">\(s_a\)</span> 为年龄 <span class="math inline">\(a\)</span> 的选择性，<span class="math inline">\(F_t\)</span> 已知，<span class="math inline">\(t\)</span> 年完全选择的捕捞死亡系数。</p>
<p>一旦残存数量 <span class="math inline">\(S_tN_t\)</span> 已知，那么死亡的数量显然不同时期存在差异。从一个时间段到下一个时间段一个世代的死亡总数量可以表示为:</p>
<p><span id="eq-3_10"><span class="math display">\[
N_{z}=N_{t}-N_{t+1}  
\qquad(3.10)\]</span></span></p>
<p>如果用残存等式代替 <span class="math inline">\(N_{t_1}\)</span>，就可得到残存的补偿方程，其描述了时间段间总死亡数量：</p>
<p><span id="eq-3_11"><span class="math display">\[
N_{a,z}=N_{a,t}-N_{a,t}{e}^{-(M+{s_a}{F_t})}=N_{a,t}(1-{e}^{-(M+{s_a}{F_t})})
\qquad(3.11)\]</span></span></p>
<p>这里 <span class="math inline">\(N_{a,z}\)</span> 为年龄 <span class="math inline">\(a\)</span> 死亡的数量。当然，不是所有死亡的鱼都作为渔获，一些是自然死亡的，但也出现捕捞一些自然死亡的个体的现象。将死亡率分为 <span class="math inline">\(M\)</span>（假设不同年龄的自然死亡系数不变）和 <span class="math inline">\(F_t\)</span> (捕捞努力量引起的完全选择死亡)，它可以随时间 <span class="math inline">\(t\)</span> 而变化，可以计算渔获量和残存量。可以将 <span class="math inline">\(s_aF_t\)</span> 简化为 <span class="math inline">\(F_{a,t}\)</span>。有可能进行这种分开的假设是年龄结构和体长结构的种群评估模型的一个重要组成部分。使用瞬时率，由于捕捞死亡而非自然死亡的数量用分数 <span class="math inline">\(F_{a,t}/(M+F_{a,t})\)</span> 来描述，如果将其包含到 <a href="#eq-3_11" class="quarto-xref">公式&nbsp;<span>3.11</span></a> 中，我们发现我们已经推导出了所谓的 Baranov 渔获量方程 <span class="citation" data-cites="quinn2003 quinn1999">(<a href="08-references.html#ref-quinn2003" role="doc-biblioref">QUINN 2003</a>; <a href="08-references.html#ref-quinn1999" role="doc-biblioref">Quinn 和 Deriso 1999</a>)</span> ，现在通常用于渔业建模，以估计渔获中的数量。它被用来追踪单个世代的命运，如果将所有年龄段相加，就能得出总的渔获量:</p>
<p><span id="eq-3_12"><span class="math display">\[
{{\hat{C}}_{a,t}}=\frac{{F}_{a,t}}{M+{F}_{a,t}}{{N}_{a,t}}\left( 1-{{e}^{-\left( M+{{F}_{a,t}} \right)}} \right)
\qquad(3.12)\]</span></span></p>
<p>其中<span class="math inline">\(\hat{C}_{a,t}\)</span>为<span class="math inline">\(t\)</span>年年龄<span class="math inline">\(a\)</span>的期望渔获，<span class="math inline">\(F_{a,t}\)</span>为<span class="math inline">\(t\)</span>年年龄<span class="math inline">\(a\)</span>的瞬时捕捞死亡系率（<span class="math inline">\(s_aF_t\)</span>），<span class="math inline">\(M\)</span>为自然死亡率（假设年龄间不变），<span class="math inline">\(N_{a,t}\)</span>为<span class="math inline">\(t\)</span>年年龄<span class="math inline">\(a\)</span>的数量。该方程可用<strong>MQMF</strong>的函数<code>bce()</code>运行。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="co"># Baranov catch equation  </span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">12</span>;  <span class="va">nage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>   </span>
<span><span class="va">sa</span> <span class="op">&lt;-</span><span class="fu">mature</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="va">age</span><span class="op">)</span> <span class="co">#selectivity-at-age  </span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>;  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">0.35</span>  </span>
<span><span class="va">FF</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">H</span><span class="op">)</span><span class="co">#Fully selected instantaneous fishing mortality  </span></span>
<span><span class="va">Ft</span> <span class="op">&lt;-</span> <span class="va">sa</span> <span class="op">*</span> <span class="va">FF</span>     <span class="co"># instantaneous Fishing mortality-at-age  </span></span>
<span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  </span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu">bce</span><span class="op">(</span><span class="va">M</span>,<span class="va">Ft</span>,<span class="va">N0</span>,<span class="va">age</span><span class="op">)</span>,<span class="st">"Select"</span><span class="op">=</span><span class="va">sa</span><span class="op">)</span>  <span class="co"># out becomes Table 3.7  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">out</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-7" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.7: 将巴拉诺夫捕捞方程应用于年捕捞率为 0.2 且瞬时自然死亡率为 0.3 的种群。
</figcaption><div aria-describedby="tbl-3-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Nt</th>
<th style="text-align: right;">N-Dying</th>
<th style="text-align: right;">Catch</th>
<th style="text-align: right;">Select</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">1000.000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">686.191</td>
<td style="text-align: right;">291.645</td>
<td style="text-align: right;">22.164</td>
<td style="text-align: right;">0.119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">432.501</td>
<td style="text-align: right;">192.368</td>
<td style="text-align: right;">61.322</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">250.395</td>
<td style="text-align: right;">116.618</td>
<td style="text-align: right;">65.488</td>
<td style="text-align: right;">0.881</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">141.728</td>
<td style="text-align: right;">66.827</td>
<td style="text-align: right;">41.840</td>
<td style="text-align: right;">0.982</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">79.943</td>
<td style="text-align: right;">37.766</td>
<td style="text-align: right;">24.018</td>
<td style="text-align: right;">0.998</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">45.071</td>
<td style="text-align: right;">21.298</td>
<td style="text-align: right;">13.574</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">25.409</td>
<td style="text-align: right;">12.007</td>
<td style="text-align: right;">7.655</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">14.325</td>
<td style="text-align: right;">6.769</td>
<td style="text-align: right;">4.316</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">8.075</td>
<td style="text-align: right;">3.816</td>
<td style="text-align: right;">2.433</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">4.553</td>
<td style="text-align: right;">2.151</td>
<td style="text-align: right;">1.372</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">2.567</td>
<td style="text-align: right;">1.213</td>
<td style="text-align: right;">0.773</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">1.447</td>
<td style="text-align: right;">0.684</td>
<td style="text-align: right;">0.436</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="生长和各年龄体重" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="生长和各年龄体重">
<span class="header-section-number">3.3.3</span> 生长和各年龄体重</h3>
<p>为了获得渔获量的质量(即渔获量的重量)，需要将渔获量中的各年龄数量乘以各年龄重量。各年龄体重可以是特定年份特定渔业的平均体重观测值的向量 <span class="citation" data-cites="beverton1993a">(<a href="08-references.html#ref-beverton1993a" role="doc-biblioref">Beverton 和 Holt 1993</a>)</span> ，或者，更常见的是，从 von Bertalanffy 生长曲线推导出的标准年龄体重方程，它从各年龄长度开始。</p>
<p><span id="eq-3_13"><span class="math display">\[
L_{a}=L_{\infty}(1-e^{(-K(a-t_0))})
\qquad(3.13)\]</span></span></p>
<p>其中，<span class="math inline">\(L_a\)</span>为年龄<span class="math inline">\(a\)</span>的长度，<span class="math inline">\(L_{\infty}\)</span>为平均最大年龄长度，<span class="math inline">\(K\)</span>为系数，它决定了如何快速达到 <span class="math inline">\(L_{\infty}\)</span>，<span class="math inline">\(t_0\)</span> 为长度为 0 时的假设年龄。用 <strong>MQMF</strong> 的函数 <code>vB()</code>运行。假设各年龄长度和各年龄体重之间存在幂次关系，因此增加了两个参数:</p>
<p><span id="eq-3_14"><span class="math display">\[
\begin{aligned}  
{W_a}  &amp;= {\alpha}{L_a}^{b}=w_a(1-e^{(-K(a-t_0))})^{b} \\  
{\log{(W_a)}} &amp;= \log{(\alpha)}+{b}{L_a}  
\end{aligned}  
\qquad(3.14)\]</span></span></p>
<p>其中，<span class="math inline">\(\alpha\)</span> 为恒定值，<span class="math inline">\(w_a\)</span> 为 <span class="math inline">\((\alpha L_{\infty})\)</span>，<span class="math inline">\(b\)</span> 为指数，近似为 3.0（大小是二维的，而重量是三维的）。对数变换形式当然是线性的。在第 <a href="05-staticModel.html" class="quarto-xref"><span>5</span></a>章“静态模型”（<em>Static Models</em>）中，我们将看到如何估计这些模型的参数。</p>
</section></section><section id="完整的单位补充量产量" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="完整的单位补充量产量">
<span class="header-section-number">3.4</span> 完整的单位补充量产量</h2>
<p>把所有这些整合在一起，意味着我们可以产生一个更完整的单位补充量产量（YPR）分析。标准的 YPR 分析假设恒定的补充量，这意味着我们可以跟踪单个世代的命运，并仍然捕捉所需的细节。当然，补充量不是一个常数，所以这种方法被认为是基于长期或平衡条件。以这种方式忽略变化和随机性意味着，任何关于潜在生产力和由此产生的管理决策的结论都需要谨慎对待（事实上，非常谨慎）。但这些方法是在渔业分析都是确定性的，并假定处于平衡状态时发展起来的，不确定性的含义尚未被探索 <span class="citation" data-cites="beverton1993a">(<a href="08-references.html#ref-beverton1993a" role="doc-biblioref">Beverton 和 Holt 1993</a>)</span> 。</p>
<p>当目标是最大化产量时，这样的分析是有意义的。但是，恒定补充量的假设和对不确定性的忽视意味着这些分析通常不是保守的。人们尝试改进 YPR 分析提出的建议，其中比较有用的是 <span class="math inline">\(F_{0.1}\)</span> 的出现(发音为 F zero point one)。定义为产量曲线起点处产量增长率 1/10 的渔获率 <span class="citation" data-cites="hilborn1992">(<a href="08-references.html#ref-hilborn1992" role="doc-biblioref">Hilborn 和 Walters 1992</a>)</span>。<span class="math inline">\(F_{0.1}\)</span> 的优势这是捕捞努力量的相对 大幅下降，只会导致产量的很小损失。这可以提高渔业的经济效益和可持续性。然而，本质上使用 <span class="math inline">\(F_{0.1}\)</span> 仍然是一个经验规则，它在实践中比 <span class="math inline">\(F_{max}\)</span> （最高产量点）更可持续，通常比 <span class="math inline">\(F_{msy}\)</span> (平衡时可产生 MSY 的捕捞死亡率)更好。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A more complete YPR analysis  </span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>;  <span class="va">nage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="co">#storage vectors and matrices  </span></span>
<span><span class="va">laa</span> <span class="op">&lt;-</span> <span class="fu">vB</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50.0</span>,<span class="fl">0.25</span>,<span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,<span class="va">age</span><span class="op">)</span> <span class="co"># length-at-age  </span></span>
<span><span class="va">WaA</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.015</span> <span class="op">*</span> <span class="va">laa</span> <span class="op">^</span> <span class="fl">3.0</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>  <span class="co"># weight-at-age as kg  </span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.65</span>,<span class="fl">0.05</span><span class="op">)</span>;  <span class="va">nH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span>     </span>
<span><span class="va">FF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">H</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span>  <span class="co"># Fully selected fishing mortality  </span></span>
<span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  </span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>  </span>
<span><span class="va">numt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nage</span>,ncol<span class="op">=</span><span class="va">nH</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">age</span>,<span class="va">FF</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">catchN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nage</span>,ncol<span class="op">=</span><span class="va">nH</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">age</span>,<span class="va">FF</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="va">as50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>    </span>
<span><span class="va">yield</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">nH</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">as50</span><span class="op">)</span>,dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">H</span>,<span class="va">as50</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sel</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">as50</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>   <span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu">logist</span><span class="op">(</span><span class="va">as50</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span>,<span class="fl">1.0</span>,<span class="va">age</span><span class="op">)</span>  <span class="co"># selectivity-at-age  </span></span>
<span>   <span class="kw">for</span> <span class="op">(</span><span class="va">harv</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nH</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>      <span class="va">Ft</span> <span class="op">&lt;-</span> <span class="va">sa</span> <span class="op">*</span> <span class="va">FF</span><span class="op">[</span><span class="va">harv</span><span class="op">]</span>      <span class="co"># Fishing mortality-at-age  </span></span>
<span>      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">bce</span><span class="op">(</span><span class="va">M</span>,<span class="va">Ft</span>,<span class="va">N0</span>,<span class="va">age</span><span class="op">)</span>  </span>
<span>      <span class="va">numt</span><span class="op">[</span>,<span class="va">harv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>,<span class="st">"Nt"</span><span class="op">]</span>  </span>
<span>      <span class="va">catchN</span><span class="op">[</span>,<span class="va">harv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>,<span class="st">"Catch"</span><span class="op">]</span>  </span>
<span>      <span class="va">yield</span><span class="op">[</span><span class="va">harv</span>,<span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="st">"Catch"</span><span class="op">]</span> <span class="op">*</span> <span class="va">WaA</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  </span>
<span>   <span class="op">}</span> <span class="co"># end of harv loop  </span></span>
<span><span class="op">}</span> <span class="co"># end of sel loop  </span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#A full YPR analysis  Figure 3.10  </span></span>
<span><span class="fu">plot1</span><span class="op">(</span><span class="va">H</span>,<span class="va">yield</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,xlab<span class="op">=</span><span class="st">"Harvest Rate"</span>,ylab<span class="op">=</span><span class="st">"Yield"</span>,cex<span class="op">=</span><span class="fl">0.75</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">H</span>,<span class="va">yield</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">2</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">H</span>,<span class="va">yield</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,legend<span class="op">=</span><span class="va">as50</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">3</span>,bty<span class="op">=</span><span class="st">"n"</span>,  </span>
<span>       cex<span class="op">=</span><span class="fl">1.0</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>   </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-3-10" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-3-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-simpopmodel_files/figure-html/fig-3-10-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3.10: 不同捕捞强度和不同初次开发年龄对总平衡产量的影响。图例标明了不同的初次开发年龄。
</figcaption></figure>
</div>
</div>
</div>
<p>这些详细的分析考虑了选择性、年龄体重和自然死亡率，提供了一个渔场在不同条件下的潜在产量的更准确的表示，尽管仍然是确定性的。一旦考虑到不确定性和自然变化，即使只是近似地使用<span class="math inline">\(F_{0.1}\)</span> ，那么YPR分析仍然可以为了解特定渔业的生产能力提供一些有用的见解。当然，如今onbe更有可能进行单位补充量的利润分析，但原则是不变的。</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">yield</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-3-8" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-3-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3.8: 不同捕捞率（行）和不同首次开发年龄（列）对总平衡产量的影响。
</figcaption><div aria-describedby="tbl-3-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">85.825</td>
<td style="text-align: right;">84.152</td>
<td style="text-align: right;">81.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.06</td>
<td style="text-align: right;">347.125</td>
<td style="text-align: right;">352.465</td>
<td style="text-align: right;">350.567</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.11</td>
<td style="text-align: right;">447.067</td>
<td style="text-align: right;">469.250</td>
<td style="text-align: right;">480.134</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.16</td>
<td style="text-align: right;">475.149</td>
<td style="text-align: right;">514.595</td>
<td style="text-align: right;">540.249</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.21</td>
<td style="text-align: right;">471.987</td>
<td style="text-align: right;">526.522</td>
<td style="text-align: right;">565.880</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.26</td>
<td style="text-align: right;">455.843</td>
<td style="text-align: right;">522.962</td>
<td style="text-align: right;">574.288</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.31</td>
<td style="text-align: right;">434.880</td>
<td style="text-align: right;">512.360</td>
<td style="text-align: right;">573.986</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.36</td>
<td style="text-align: right;">412.718</td>
<td style="text-align: right;">498.720</td>
<td style="text-align: right;">569.223</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.41</td>
<td style="text-align: right;">390.958</td>
<td style="text-align: right;">483.969</td>
<td style="text-align: right;">562.163</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.46</td>
<td style="text-align: right;">370.252</td>
<td style="text-align: right;">469.031</td>
<td style="text-align: right;">553.935</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.51</td>
<td style="text-align: right;">350.834</td>
<td style="text-align: right;">454.348</td>
<td style="text-align: right;">545.146</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.56</td>
<td style="text-align: right;">332.715</td>
<td style="text-align: right;">440.100</td>
<td style="text-align: right;">536.113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.61</td>
<td style="text-align: right;">315.808</td>
<td style="text-align: right;">426.329</td>
<td style="text-align: right;">526.995</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="结束语" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="结束语">
<span class="header-section-number">3.5</span> 结束语</h2>
<p>我们使用了相对简单的种群模型来说明渔业和生态学中的许多观点。重要的是，重点是模拟模型，而不是将模型与数据拟合(见下一章“模型参数估计”)。模拟模型通常包括模型参数值的不确定性，但是，由于许多题目在这里只作了介绍性的处理，更彻底的处理本身需要一本书。然而，通过探索在考虑的各种模型上施加一系列参数值的含义，这些模型的属性和隐含的动力学可以被揭示出来。因此，模拟研究是对任何自然过程建模的重要工具。然而，同样重要的是，使用这些参数的合理或现实的组合进行模拟。理解所有模型的数学性质是很有用的，但是，自然地，最重要的兴趣是当模型具有现实值并可能在自然界中找到时。</p>
<p>在使用任何种群模型或其组成部分时获得的直觉对理解任何未来的工作都有价值，但是，当然，所说明的每个模型(特别是相对简单的模型)中的上下文和假设总是要记住的。令人惊讶的是，即使是简单的模型有时也能提供对各种自然过程的洞察。</p>
<p>在本章中，我们只考虑了简单的种群模型，但我们也可以很好地使用 R 来探索物种之间在竞争、捕食、寄生、共生等过程中的相互作用。所有的早期模型(Lotka，1925；Wolterra，1927；Gause，1934)考虑了没有空间结构的种群。使用 R 会相对直接地增加这种模型的复杂性，并包括空间细节，如 Huffaker(1958) 的实验探索。Huffaker 后来的一些实验性捕食者-补捕食者安排持续了 490 天。在这种情况下，模拟研究对于扩展探索的可能性非常有用。这样有趣的工作将需要成为另一本书的一部分，因为在渔业领域，我们还有许多其他领域需要探索和讨论。</p>
<p>使用 R 作为进行此类模拟的工具，使得分析比在电子表格上布置参数操作更抽象。然而，代码块和已开发函数的可重用性，以及更复杂模型和函数的增量开发的潜力所带来的优势，超过了编程环境的更抽象的本质。使用 R 作为一种编程语言来开发这些不同的分析非常适合渔业和生态建模工作。</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-beverton1993a" class="csl-entry" role="listitem">
Beverton, Raymond J. H., 和 Sidney J. Holt. 1993. <em>On the Dynamics of Exploited Fish Populations</em>. Springer Netherlands. <a href="https://doi.org/10.1007/978-94-011-2106-4">https://doi.org/10.1007/978-94-011-2106-4</a>.
</div>
<div id="ref-hilborn1992" class="csl-entry" role="listitem">
Hilborn, Ray, 和 Carl J. Walters. 1992. <em>Quantitative Fisheries Stock Assessment</em>. Springer US. <a href="https://doi.org/10.1007/978-1-4615-3598-0">https://doi.org/10.1007/978-1-4615-3598-0</a>.
</div>
<div id="ref-theoreti2007" class="csl-entry" role="listitem">
May, Robert, 和 Angela R. McLean, 编. 2007. <em>Theoretical Ecology</em>. Oxford University Press. <a href="https://doi.org/10.1093/oso/9780199209989.001.0001">https://doi.org/10.1093/oso/9780199209989.001.0001</a>.
</div>
<div id="ref-quinn2003" class="csl-entry" role="listitem">
QUINN, TERRANCE J. 2003. <span>《RUMINATIONS ON THE DEVELOPMENT AND FUTURE OF POPULATION DYNAMICS MODELS IN FISHERIES》</span>. <em>Natural Resource Modeling</em> 16 (4): 341–92. <a href="https://doi.org/10.1111/j.1939-7445.2003.tb00119.x">https://doi.org/10.1111/j.1939-7445.2003.tb00119.x</a>.
</div>
<div id="ref-quinn1999" class="csl-entry" role="listitem">
Quinn, Terrance J., 和 Richard B. Deriso. 1999. <em>Quantitative Fish Dynamics</em>. Biological Resource Management. Oxford, New York: Oxford University Press.
</div>
<div id="ref-russell1942" class="csl-entry" role="listitem">
Russell, E. S. 1942. <em>The Overfishing Problem</em>. CUP Archive.
</div>
<div id="ref-schaefer1991" class="csl-entry" role="listitem">
Schaefer, M. 1991. <span>《Some Aspects of the Dynamics of Populations Important to the Management of the Commercial Marine Fisheries》</span>. <em>Bulletin of Mathematical Biology</em> 53 (1-2): 253–79. <a href="https://doi.org/10.1016/s0092-8240(05)80049-7">https://doi.org/10.1016/s0092-8240(05)80049-7</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-NonIntroductiontoR.html" class="pagination-link  aria-label=">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R 语言的不完全介绍</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-application.html" class="pagination-link" aria-label="<span class='chapter-number'>4</span>&nbsp; <span class='chapter-title'>模型参数估算</span>">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">模型参数估算</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">源代码</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 简单种群模型 {#sec-simplemodel}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## 简介</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>简单的种群模型构成了众多渔业模型的基础，事实上，渔业模型与生态种群模型的区别只是人为的划分。理解任何种群模型的运行方式都将有助于更好地理解渔业模型，因此在本章中，我们将使用R来检验种群生物学中的一些基本思想的动力学。</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MQMF)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### 离散Logistic模型</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>我们将首先考察已成为生态学中经典种群模型之一的离散逻辑斯蒂模型所展示的动力学。这种模型出现在许多地方，以许多不同的形式出现，因此值得进行一些详细的探索。这里我们将使用 <span class="co">[</span><span class="ot">@schaefer1991</span><span class="co">]</span> Schaefer(1954, 1957)版本，它有四个组成部分或项:</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>N_{t=0} &amp;= N_0 <span class="sc">\\</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>N_{t+1} &amp;= N_t + rN_t \left(1-\left(\dfrac{N_t}{K} \right) \right) -C_t</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_1}</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>$N_t$ 项为时间 $t$ 时的数量（如年 $t$ 的开始时），最后一项为 $C_t$，它是在时间 $t$ 内（如年份 $t$ ）捕获的渔获量。第一行反映了初始状态，定义为时间 $0$ 时的数量（或生物量）。要注意下标，因为无论是数量还是生物量，它们都是指特定时间的数量和生物量，通常是确定的时间段 $t$ 的开始时的数量或生物量，而渔获量指的是整个时间段 $t$ 内的渔获量。这个方程是对时间步长$t$的动力学的总结； 它是一个差分方程而不是连续微分方程。第二个方程的中间项是更复杂的组成部分，该项定义了所谓的渔业生产曲线。它由 $r$ 和 $K$ 组成，$r$ 为种群的内在增长率， $K$ 为承载力或最大种群规模。如果动力学表示为在开发开始之前处于平衡状态，那么 $N_0$ 会取与 $K$ 相同的值，但它是分开的，以考虑任何时间序列开始时偏离均衡的情况。在 **MQMF** 的 <span class="in">`discretelogistic()`</span> 中，你会看到另一个参数 $p$，这个参数将在“剩余产量模型”中详细探讨。在此，只需说明的是，当使用默认值 $p=1.0$ 时， <span class="co">[</span><span class="ot">@eq-3_1</span><span class="co">]</span> 中的方程等同于 Schaefer 模型。这里，Schaefer 模型输出实时数量，尽管在渔业中，它通常直接用实时生物量（$B_t$）表示。这些术语可以以这种方式改变，这一事实强调了该模型忽略了生物学实际和属性，如种群体长结构和年龄结构，以及性别和其他属性之间的差异。令人惊讶的是，这样一个简单的模型在理论和实践中仍然是有用的。</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>我们可以通过将式 <span class="co">[</span><span class="ot">@eq-3_1</span><span class="co">]</span> 的中间项与 $N_t$ 值的向量绘制成曲线来说明产量曲线。子项 $rN_t$ 表示无限制的种群指数增长，在这个离散形式的方程中，并将此项与 $N_t$ 相加。因此，只要 $r&gt;0.1$及渔获量为0，我们就可以期待从方程的 $N_t+rN_t$ 部分得到种群的无尽增长。然而,子项 $(1−(N_t/K))$ 为抑制指数增长的项，而且随着种群规模的增长，这种作用越来越大。这就是所谓的密度依赖效应。</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-1</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "离散 Schaefer（1954，1957）剩余生产模型的完整生产曲线以及与种群大小相当的等效线性密度依赖关系。"</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>surprod <span class="ot">&lt;-</span> <span class="cf">function</span>(Nt,r,K) <span class="fu">return</span>((r<span class="sc">*</span>Nt)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(Nt<span class="sc">/</span>K)))  </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>densdep <span class="ot">&lt;-</span> <span class="cf">function</span>(Nt,K) <span class="fu">return</span>((<span class="dv">1</span><span class="sc">-</span>(Nt<span class="sc">/</span>K)))  </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">1.2</span>; K <span class="ot">&lt;-</span> <span class="fl">1000.0</span>; Nt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">1000</span>,<span class="dv">10</span>)  </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>),<span class="at">oma=</span><span class="fu">c</span>(<span class="fl">0.0</span>,<span class="dv">0</span>,<span class="fl">0.0</span>,<span class="fl">0.0</span>))   </span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="dv">0</span>), <span class="at">font.axis=</span><span class="dv">7</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">font.lab=</span><span class="dv">7</span>)   </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(Nt,<span class="fu">surprod</span>(Nt,r,K),<span class="at">xlab=</span><span class="st">"Population Nt"</span>,<span class="at">defpar=</span><span class="cn">FALSE</span>,  </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Production"</span>)  </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(Nt,<span class="fu">densdep</span>(Nt,K),<span class="at">xlab=</span><span class="st">"Population Nt"</span>,<span class="at">defpar=</span><span class="cn">FALSE</span>,  </span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Density-Dependence"</span>)  </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>密度依赖是种群规模调节的重要组成部分 <span class="co">[</span><span class="ot">@theoreti2007</span><span class="co">]</span>。从 @fig-3-1 可以明显看出，Schaefer 模型中的密度依赖项与种群规模呈线性递减关系。这就是"线性密度依赖"一词的字面意思，你可以在种群动态文献中找到它。这个密度依赖项，试图补偿由 $rN_t$ 驱动的指数增长 ，限制种群规模不大于未捕捞种群规模$K$的长期平均(关于补偿不足时会发生什么，请参阅下一节)。</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a><span class="fu">### 动态行为</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>众所周知，微分方程形式的 Schaefer 模型一直非常稳定，最大种群数量真正受限于 $K$ 值。令人惊讶的是，人们发现离散形式的动力学更为复杂和有趣 (May, 1973，1976)。我们已经在函数 <span class="in">`discretelogistic()`</span> 中实现了上述方程的一种形式，你可以通过 *?discrete telogistic* 读取它的帮助文件，并且可以通过在控制台输入 `discretelogistic` 来查看它的代码(注意，没有括号)。如果您检查这个函数中的代码，您将看到它使用 *for* 循环来逐年间计算每年的资源量。我希望，作为一名 R 程序员，您会想知道为什么我不使用向量化方法来避免使用 *for* 循环。这突出了种群动力学的一个基本方面，即 $t$ 时的数量总是 $t-1$ 时数量的函数(初始条件可能于 $N_0$ 参数)。种群动态的顺序性质意味着我们不能以任何有效的方式使用矢量化。种群动态的顺序性是如此明显的事实，以至于它施加在种群模型上的约束和结构常常被忽视。</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="in">`discretelogistic()`</span> 函数（隐形）输出时间矩阵， $year$（用 *year* 表示）、$t$ 时的数量 $n_t$ （表示为 $nt$ ）以及 $t+1$ 时的数量 $n_{t+1}$（表示为 $nt1$ ）的矩阵。该矩阵也给出 **MQMF** 中包含的了 *dynpop* 类和S3方法（*plot.dynpop*；见*A non-introduction to R* 一章S3类和方法的使用。如果要查看代码，在控制台中输入*MQMF:::plot.dynpop*，记住当中是3个":"，而非2个）。当然，可以写任何想写的东西。试着将<span class="in">`rv`</span>的值 设定为0.5、1.95、2.2、2.475、2.56和2.8，用这些值按顺序运行下面的代码。</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>如果你运行生成 @fig-3-2 的代码，使用上面提到的6个<span class="in">`rv`</span>值，你应该会看到一个单调阻尼平衡(一个实心点)，然后是一个阻尼振荡平衡(仍然是一个实心点)，然后是介于阻尼振荡平衡和两环稳定极限环之间的东西(有点涂抹了两个实心点)。当 $r = 2.475$ 时，有一个 4 圈稳定的极限环( 4 个实心点)，当 $r = 2.56$ 时，有一个 8 圈稳定的极限环。最后，当 $r = 2.8$ 时，动态以混乱告终，尽管所有的点都落在如图所示的抛物线上，但每一步的结果都不是随机的，也不是直接可预测的。在混沌理论中，这个抛物线被称为奇怪的吸引子，尽管这是一个非常简单的吸引子。这种混沌系统也依赖于起始条件。如果把初始数字改为 101 而不是 100，数字的时间线就会发生根本性的变化，尽管抛物线保持不变。当然，我们可以输入任意范围的数字，也可以使用稍微不同的模型来改变动态。虽然混乱很有趣，玩起来也很有趣 (Gleick，1988；Lauwerier, 1991)，但在模拟自然种群的实际应用中似乎很少有用。事实上，一些人声称，他们观察到的明显的随机性是由种群对随机环境效应的反应引起的，而不是由密度依赖模型中的补偿不足和补偿过度引入的非线性（Higgins等，1997）。</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-2</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schaefer 模型动态。左图是按年份的数值，展示了从 r 值为 2.8 开始的混沌动态。右图是时间 t+1 的数值与时间 t 的关系，称为相图。最后 20%的点用红色标出以展示任何平衡行为。灰色对角线是 1:1 线。"</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a> <span class="co">#Code for Figure 3.2. Try varying the value of rv from 0.5-2.8  </span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="dv">100</span>; rv<span class="ot">=</span><span class="fl">2.8</span>;  Kv <span class="ot">&lt;-</span> <span class="fl">1000.0</span>; Nz<span class="ot">=</span><span class="dv">100</span>; catch<span class="ot">=</span><span class="fl">0.0</span>; p<span class="ot">=</span><span class="fl">1.0</span>  </span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span>rv,<span class="at">K=</span>Kv,<span class="at">N0=</span>Nz,<span class="at">Ct=</span>catch,<span class="at">Yrs=</span>yrs,<span class="at">p=</span>p)  </span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>avcatch <span class="ot">&lt;-</span> <span class="fu">mean</span>(ans[(yrs<span class="dv">-50</span>)<span class="sc">:</span>yrs,<span class="st">"nt"</span>],<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="co">#used in text  </span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r="</span>,rv,<span class="st">" K="</span>,Kv,<span class="st">" Ct="</span>,catch, <span class="st">" N0="</span>,Nz,<span class="st">" p="</span>,<span class="at">p=</span>p)  </span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ans, <span class="at">main=</span>label, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">font=</span><span class="dv">7</span>) <span class="co">#Schaefer dynamics  </span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>在实际应用中，如果发现模型表现出明显的混沌或周期性行为，甚至是负的种群数量，尝试确定所观察到的现象是真实的生物群体行为(显然不是负数)，还是更简单地说，只是一个特殊参数的数学表达式。人们总是可以通过在计算中包含诸如 $max((B_t+(rB_t)(1-(B_t/K))-C_t),0)$ 之类以避免模型向下跌落到0以下（参见 <span class="in">`discretelogistic()`</span> 代码。类似地，用 $min((B_t+(rB_t)(1-(B_t/K))-C_t),1.1K)$ 以避免计算值高于$K$），尽管对代码的此类添加仍然是临时的（应该，比如，任何超过$K$的值都应允许，是 $1.1K$，还是 $1.0K$？有些种群自然变动的）。在第 <span class="co">[</span><span class="ot">-@sec-surplusproduction</span><span class="co">]</span> 章 "<span class="co">[</span><span class="ot">剩余产量模型</span><span class="co">](07-spm.qmd)</span>" 一章中我们将研究惩罚函数的使用，惩罚函数可用于防止在估计这些参数时产生异常值，同时避免使用，如 $max(\cdots，0)$ 这类粗糙的工具。</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>我们可以通过将 <span class="in">`discretelogistic()`</span> 函数的不可见输出转换为可以使用的对象来检查每年的实际资源量（@tbl-3-1）。</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a><span class="co">#run discrete logistic dynamics for 600 years  </span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>yrs<span class="ot">=</span><span class="dv">600</span>  </span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span><span class="fl">2.55</span>,<span class="at">K=</span><span class="fl">1000.0</span>,<span class="at">N0=</span><span class="dv">100</span>,<span class="at">Ct=</span><span class="fl">0.0</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-1</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ans 对象中最后 30 个按年排列的数字，展示了在 r = 2.2 时呈现 8 周期稳定极限。如果你在 discretelogistic() 中尝试 r = 2.2，它将导致 2 周期稳定极限在 746.24 和 1162.84 之间波动。尝试使用 plot(ans) 并观察每次变化。"</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap-align: center</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a><span class="co"># layout-ncol: 1</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">halftable</span>(ans[(yrs<span class="dv">-29</span>)<span class="sc">:</span>yrs,],<span class="at">yearcol=</span><span class="st">"year"</span>,<span class="at">subdiv=</span><span class="dv">3</span>),</span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>当我们设置 $r$ 值来产生2循环的稳定限制(例如 $r＝2.2$ )，可以从其他年份的数值重复中清楚地看到。检查实际的数值显然比相信图表的视觉印象更准确。这也意味着我们可以尽可能详细地查看结果。在上述情况下，最近50年的平均渔获量为859.675，明显小于1000的$K$值。由于 $N_{t+1}$ 与 $N_t$ 的相位关系，上一年的最后一行通常不会有 $N_{t+1}$ 的值，因此，在代码中，输入的年份数增加1，以便最终生成 $N_{t+1}$ (请参阅代码)。</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a><span class="fu">### 确定行为间的边界</span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>我们可以通过求 ans 中 $nt$ 和 $Nt1$ 列的行平均值来找到一个稳定的限制循环，查看最后 100 个值(四舍五入到小数点后三位)。<span class="in">`table()`</span> 函数的名称标识循环点的值(如果有的话)。如果只有一个或两个平均值来确定一个渐近平衡或一个两周期稳定的限制循环。通过检查每个 ans 对象中值的时间序列，可以搜索所标识值的首次出现，从而确定循环行为（精确到小数点后三位）何时首次出现。我们将这些值四舍五入，并使用 600 年或更长的时间，因为如果我们使用所有 15 位小数，任何超过 8 的循环都可能无法被清楚地识别出来（尝试将 r = 2.63 更改为 5；并试着用 <span class="in">`plot(ans)`</span> 绘图）。</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a><span class="in"> #run discretelogistic and search for repeated values of Nt  </span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a><span class="in">yrs &lt;- 600  </span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a><span class="in">ans &lt;- discretelogistic(r=2.55,K=1000.0,N0=100,Ct=0.0,Yrs=yrs)  </span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a><span class="in">avt &lt;- round(apply(ans[(yrs-100):(yrs-1),2:3],1,mean),2)  </span></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a><span class="in">count &lt;- table(avt)  </span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a><span class="in">count[count &gt; 1] # with r=2.55 you should find an 8-cycle limit  </span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>我们可以建立一个程序来寻找 $r$ 的值生成不同周期的稳定限制环，尽管下面的代码只是部分成功。通过设置一个 *for* 循环，将不同的值替换为 $r$ 值输入到 <span class="in">`discretelogistic()`</span>，我们可以搜索一个长时间序列的最后几年在数值的时间序列中唯一的值。然而，四舍五入误差可能会导致意想不到的结果，特别是在不同类型的动态行为之间的边界。我们可以通过将检查的数值四舍五入到小数点后三位来避免这些问题，但请尝试在下面的代码中散列该行，以查看问题变得更糟。</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a><span class="co">#searches for unique solutions given an r value  see Table 3.2</span></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>testseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.9</span>,<span class="fl">2.59</span>,<span class="fl">0.01</span>)  </span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>nseq <span class="ot">&lt;-</span> <span class="fu">length</span>(testseq)  </span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nseq,<span class="at">ncol=</span><span class="dv">2</span>,  </span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dimnames=</span><span class="fu">list</span>(testseq,<span class="fu">c</span>(<span class="st">"r"</span>,<span class="st">"Unique"</span>)))  </span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="dv">600</span>  </span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nseq) {  <span class="co"># i = 31  </span></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>   rval <span class="ot">&lt;-</span> testseq[i]  </span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>   ans <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span>rval,<span class="at">K=</span><span class="fl">1000.0</span>,<span class="at">N0=</span><span class="dv">100</span>,<span class="at">Ct=</span><span class="fl">0.0</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>   ans <span class="ot">&lt;-</span> ans[<span class="sc">-</span>yrs,] <span class="co"># remove last year, see str(ans) for why  </span></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>   ans[,<span class="st">"nt1"</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(ans[,<span class="st">"nt1"</span>],<span class="dv">3</span>) <span class="co">#try hashing this out  </span></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>   result[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(rval,<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">tail</span>(ans[,<span class="st">"nt1"</span>],<span class="dv">100</span>))))  </span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>在上面的例子中，在 $r$ 值的范围内，最近的100次观测中，最多可以产生60个唯一值。这些代表了计算机上舍入误差的问题。如果持续运行的年数显著增加，那么预期最终会出现一种平衡。无论哪种情况，都存在一个明显的分裂或过渡，从单一平衡点，到2循环，到4循环，最后到8循环稳定极限。在行为的每个转变中，由于舍入误差，结果有一些不稳定性。</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-2</span></span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Schaefer 模型动态。结果内容：在 600 年的预测动态中，从不同 r 值获得的 60 年内独特种群数量（N）。100 表示非平衡甚至混沌。"</span></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">halftable</span>(result,<span class="at">yearcol =</span> <span class="st">"r"</span>, <span class="at">subdiv=</span><span class="dv">3</span>),<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))  </span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a><span class="fu">### 经典的混沌分岔图</span></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>May(1976) 对基于差分方程的单物种种群模型的动力学进行了综述。文中，他从非常简单的模型描述了混沌动力学的潜力。在那篇文章中，他绘制了一个图，他称之为分岔图（bifurcation diagram），该图显示了模型的平衡属性如何随着单个参数的改变而改变。我们可以使用<span class="in">`discretelogistic()`</span>函数和下面的代码，以几乎任何精度复制 @fig-3-3 。</span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a>在分岔图的混沌中，偶尔会有一些简化，由图中的白色间隙表示出来。可以通过替换 *testseq* 向量中的数值来检查其中的下限位置，如下限值=2.82，上限= 2.87和inc = 0.0001 。这些起始点提供了更多的细节，在这些细节中有以前被掩盖的细节。这些也可以通过改变数值*testseq \&lt; - c(2.845, 2.855, 0.00001)* 检查，于是分岔,2 - 4 -和更高的周期可以看到(甚至可以看到更多的细节通过改变*limy= 0* 参数绑定y-轴在 $limy=c(600, 750)$ 内感兴趣的区域绑定y轴所需的范围。这个图是通过在每个r的序列值处使用最终尾<span class="sc">\&lt;</span>- 100点绘制的。可以增加模拟的年数和绘制的最终点的数量，以获得更好的分辨率在混沌区域。要查看更多细节，请在需要细节的区域扩展规模。</span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a> <span class="co">#the R code for the bifurcation function  </span></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a>bifurcation <span class="ot">&lt;-</span> <span class="cf">function</span>(testseq,<span class="at">taill=</span><span class="dv">100</span>,<span class="at">yrs=</span><span class="dv">1000</span>,<span class="at">limy=</span><span class="dv">0</span>,<span class="at">incx=</span><span class="fl">0.001</span>){  </span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a>  nseq <span class="ot">&lt;-</span> <span class="fu">length</span>(testseq)  </span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nseq,<span class="at">ncol=</span><span class="dv">2</span>,  </span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dimnames=</span><span class="fu">list</span>(testseq,<span class="fu">c</span>(<span class="st">"r"</span>,<span class="st">"Unique Values"</span>)))  </span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a>  result2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span>nseq,<span class="at">ncol=</span>taill)  </span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nseq) {    </span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a>     rval <span class="ot">&lt;-</span> testseq[i]  </span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a>     ans <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span>rval,<span class="at">K=</span><span class="fl">1000.0</span>,<span class="at">N0=</span><span class="dv">100</span>,<span class="at">Ct=</span><span class="fl">0.0</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a>     ans[,<span class="st">"nt1"</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(ans[,<span class="st">"nt1"</span>],<span class="dv">4</span>)  </span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a>     result[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(rval,<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">tail</span>(ans[,<span class="st">"nt1"</span>],taill))))  </span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a>     result2[i,] <span class="ot">&lt;-</span> <span class="fu">tail</span>(ans[,<span class="st">"nt1"</span>],taill)  </span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a>  }    </span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (limy[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">0</span>) limy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">getmax</span>(result2,<span class="at">mult=</span><span class="fl">1.02</span>))  </span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parset</span>() <span class="co"># plot taill values against taill of each r value  </span></span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">rep</span>(testseq[<span class="dv">1</span>],taill),result2[<span class="dv">1</span>,],<span class="at">type=</span><span class="st">"p"</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">0.1</span>,  </span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylim=</span>limy,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(testseq)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>incx),<span class="fu">max</span>(testseq)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>incx)),  </span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">"r value"</span>,<span class="at">yaxs=</span><span class="st">"i"</span>,<span class="at">xaxs=</span><span class="st">"i"</span>,<span class="at">ylab=</span><span class="st">"Equilibrium Numbers"</span>,  </span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a>     <span class="at">panel.first=</span><span class="fu">grid</span>())  </span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nseq)  </span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">points</span>(<span class="fu">rep</span>(testseq[i],taill),result2[i,],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">0.1</span>)  </span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(<span class="fu">list</span>(<span class="at">result=</span>result,<span class="at">result2=</span>result2)))  </span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of bifurcation  </span></span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-3</span></span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schaefer 模型动态。一个经典的分岔图（May，1976），绘制了平衡动态与 r 值的函数关系，展示了从 2-、4-、8-循环以及混沌行为的转变。"</span></span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternative r value arrangements for you to try; Fig 3.3  </span></span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a> <span class="co">#testseq &lt;- seq(2.847,2.855,0.00001) #hash/unhash as needed </span></span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a> <span class="co">#bifurcation(testseq,limy=c(600,740),incx=0.0001) # t  </span></span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a> <span class="co">#testseq &lt;- seq(2.6225,2.6375,0.00001) # then explore   </span></span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a> <span class="co">#bifurcation(testseq,limy=c(660,730),incx=0.0001)   </span></span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a>testseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.9</span>,<span class="fl">2.975</span>,<span class="fl">0.0005</span>) <span class="co"># modify to explore  </span></span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a><span class="fu">bifurcation</span>(testseq,<span class="at">limy=</span><span class="dv">0</span>)    </span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### 捕捞对种群动态的影响</span></span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a>如果我们设置一个默认的 <span class="in">`discretelogisitic()`</span> 运行，以在渔获量为零时拥有8个周期的稳定极限，我们可以应用不同水平的恒定渔获量，看看这可能如何影响动态。在这里，我们应用了 0,50,200 和 325 个个体(尽管 $N_t$，$K$ 和 $C_t$ 也可能是吨)。当然是初始值 $N_0$ 必须大于捕获值，否则可以自由更改值。在下面四种情况中，我们假设 $p$ 值为 1.0 (= Schaefer模型)时，可以尝试 $p=1e−08$ 探讨使用与 Fox 模型等价的方法所产生的差异。</span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a> <span class="co">#Effect of catches on stability properties of discretelogistic  </span></span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a>yrs<span class="ot">=</span><span class="dv">50</span>; Kval<span class="ot">=</span><span class="fl">1000.0</span>  </span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a>nocatch <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span><span class="fl">2.56</span>,<span class="at">K=</span>Kval,<span class="at">N0=</span><span class="dv">500</span>,<span class="at">Ct=</span><span class="dv">0</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a>catch50 <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span><span class="fl">2.56</span>,<span class="at">K=</span>Kval,<span class="at">N0=</span><span class="dv">500</span>,<span class="at">Ct=</span><span class="dv">50</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>catch200 <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span><span class="fl">2.56</span>,<span class="at">K=</span>Kval,<span class="at">N0=</span><span class="dv">500</span>,<span class="at">Ct=</span><span class="dv">200</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a>catch300 <span class="ot">&lt;-</span> <span class="fu">discretelogistic</span>(<span class="at">r=</span><span class="fl">2.56</span>,<span class="at">K=</span>Kval,<span class="at">N0=</span><span class="dv">500</span>,<span class="at">Ct=</span><span class="dv">300</span>,<span class="at">Yrs=</span>yrs)  </span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a>我们组合了一个小函数 <span class="in">`plottime()`</span>，以简化最终对象的重复绘图。我们还使用了效用函数 <span class="in">`parsyn()`</span> 来辅助 <span class="in">`par()`</span> 函数的语法，以定义基本图形图的边界。请注意，生成这样的函数可以简化后续的代码，我建议构建这样一个有用的函数集合，可以与函数 <span class="in">`source()`</span> 一起使用，将它们引入到自己的会话中(就像预包;不要忘记在编写函数时记录文档，RStudio 甚至有一个插入 Roxygen 骨架命令)。在这里，随着捕获量的增加，可以看到动态开始稳定 4 到 2 周期，然后渐近平衡。注意，随着渔获量的增加，随着时间的推移(图表底部的数字)，平均渔获量下降。</span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-4</span></span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Schaefer 模型动态。左上角的图描绘了未捕捞的预期动态（8 周期），而接下来的三个图，随着平均捕捞量的减少，说明了捕捞量增加而其他因素不变的影响。"</span></span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-216"><a href="#cb29-216" aria-hidden="true" tabindex="-1"></a> <span class="co">#Effect of different catches on n-cyclic behaviour Fig3.4  </span></span>
<span id="cb29-217"><a href="#cb29-217" aria-hidden="true" tabindex="-1"></a>plottime <span class="ot">&lt;-</span> <span class="cf">function</span>(x,ylab) {  </span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a>   yrs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)  </span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot1</span>(x[,<span class="st">"year"</span>],x[,<span class="st">"nt"</span>],<span class="at">ylab=</span>ylab,<span class="at">defpar=</span><span class="cn">FALSE</span>)  </span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a>   avB <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(x[(yrs<span class="dv">-40</span>)<span class="sc">:</span>yrs,<span class="st">"nt"</span>],<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">3</span>)  </span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mtext</span>(avB,<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span>F,<span class="at">line=</span><span class="sc">-</span><span class="fl">1.1</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">cex=</span><span class="fl">1.0</span>)   </span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of plottime  </span></span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a> <span class="co">#the oma argument is used to adjust the space around the graph  </span></span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>),<span class="at">oma=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="dv">0</span>))   </span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="dv">0</span>), <span class="at">font.axis=</span><span class="dv">7</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">font.lab=</span><span class="dv">7</span>)    </span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a><span class="fu">plottime</span>(nocatch,<span class="st">"Catch = 0"</span>)  </span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a><span class="fu">plottime</span>(catch50,<span class="st">"Catch = 50"</span>)  </span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a><span class="fu">plottime</span>(catch200,<span class="st">"Catch = 200"</span>)  </span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a><span class="fu">plottime</span>(catch300,<span class="st">"Catch = 300"</span>)  </span>
<span id="cb29-230"><a href="#cb29-230" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"years"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span><span class="cn">TRUE</span>,<span class="at">line=</span><span class="sc">-</span><span class="fl">0.2</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">cex=</span><span class="fl">1.0</span>)   </span>
<span id="cb29-231"><a href="#cb29-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>我们可以对四个相图做一些类似的事情。这里，我们从 <span class="in">`MQMF:::plot.dynpop()`</span> 函数中借用了部分代码，以定义一个小型定制函数，以方便一起绘制四个阶段的图。</span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-239"><a href="#cb29-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-5</span></span>
<span id="cb29-240"><a href="#cb29-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Schaefer 模型动态。四个持续捕捞场景的相图。"</span></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-242"><a href="#cb29-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-243"><a href="#cb29-243" aria-hidden="true" tabindex="-1"></a><span class="co">#Phase plot for Schaefer model Fig 3.5  </span></span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a>plotphase <span class="ot">&lt;-</span> <span class="cf">function</span>(x,label,<span class="at">ymax=</span><span class="dv">0</span>) { <span class="co">#x from discretelogistic  </span></span>
<span id="cb29-245"><a href="#cb29-245" aria-hidden="true" tabindex="-1"></a>  yrs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)  </span>
<span id="cb29-246"><a href="#cb29-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(x))  </span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ymax[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">0</span>) ymax <span class="ot">&lt;-</span> <span class="fu">getmax</span>(x[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)])  </span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x[,<span class="st">"nt"</span>],x[,<span class="st">"nt1"</span>],<span class="at">type=</span><span class="st">"p"</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">1.0</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),  </span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a>       <span class="at">yaxs=</span><span class="st">"i"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">xaxs=</span><span class="st">"i"</span>,<span class="at">ylab=</span><span class="st">"nt1"</span>,<span class="at">xlab=</span><span class="st">""</span>,  </span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel.first=</span><span class="fu">grid</span>(),<span class="at">col=</span><span class="st">"darkgrey"</span>)  </span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a>  begin <span class="ot">&lt;-</span> <span class="fu">trunc</span>(yrs <span class="sc">*</span> <span class="fl">0.6</span>) <span class="co">#last 40% of yrs = 20, when yrs=50  </span></span>
<span id="cb29-252"><a href="#cb29-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x[begin<span class="sc">:</span>yrs,<span class="st">"nt"</span>],x[begin<span class="sc">:</span>yrs,<span class="st">"nt1"</span>],<span class="at">pch=</span><span class="dv">18</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">cex=</span><span class="fl">1.2</span>)  </span>
<span id="cb29-253"><a href="#cb29-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(label,<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span>F,<span class="at">line=</span><span class="sc">-</span><span class="fl">1.1</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">cex=</span><span class="fl">1.2</span>)   </span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of plotphase  </span></span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>),<span class="at">oma=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="dv">0</span>,<span class="dv">0</span>))   </span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.35</span>,<span class="fl">0.35</span>,<span class="dv">0</span>), <span class="at">font.axis=</span><span class="dv">7</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">font.lab=</span><span class="dv">7</span>)    </span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a><span class="fu">plotphase</span>(nocatch,<span class="st">"Catch = 0"</span>,<span class="at">ymax=</span><span class="dv">1300</span>)  </span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a><span class="fu">plotphase</span>(catch50,<span class="st">"Catch = 50"</span>,<span class="at">ymax=</span><span class="dv">1300</span>)  </span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a><span class="fu">plotphase</span>(catch200,<span class="st">"Catch = 200"</span>,<span class="at">ymax=</span><span class="dv">1300</span>)  </span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a><span class="fu">plotphase</span>(catch300,<span class="st">"Catch = 300"</span>,<span class="at">ymax=</span><span class="dv">1300</span>)  </span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"nt"</span>,<span class="at">side=</span><span class="dv">1</span>,<span class="at">outer=</span>T,<span class="at">line=</span><span class="fl">0.0</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">cex=</span><span class="fl">1.0</span>)  </span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"nt+1"</span>,<span class="at">side=</span><span class="dv">2</span>,<span class="at">outer=</span>T,<span class="at">line=</span><span class="fl">0.0</span>,<span class="at">font=</span><span class="dv">7</span>,<span class="at">cex=</span><span class="fl">1.0</span>)  </span>
<span id="cb29-263"><a href="#cb29-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-264"><a href="#cb29-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a>随着固定捕获量的增加，隐含抛物线曲线(奇异吸引子)的最大值下降。渔获量($\equiv$ 捕食者)似乎对种群的动态有稳定的影响。在自然界中是否如此，将取决于特定种群的生物学是否反映了用于描述动态的模型的基本假设(例如，Schaefer 模型假设种群中存在线性密度依赖)。</span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a>现在，我们应该很清楚，即使是简单的模型也可以表现出复杂的行为。我们只是稍微触及了这个主题，但同样清楚的是，使用 R，可以探索这些想法到任何深度。</span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### 决定论</span></span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a>本章所有的模型都表现出确定性动力学，即使是混沌动力学，在初始条件重复的情况下也会遵循相同的轨迹。当然，在自然界中，这种确定性行为是罕见的。模型总是对可能发生的事情进行抽象。与生产力相关的自然过程(自然死亡率、生长和繁殖)都将随着时间的推移而变化，这是对食物供应、生态相互作用和环境影响(如温度)的响应。通过包括所谓的过程误差，可以将过程中的这种可变性近似地包括到模型中，过程误差可以用方程形式表示为:</span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a>{N_{t+1}}={N_t}+{({r+\varepsilon_t}){N_t}}\left( 1-{{\left( \frac{N_t}{(K+\varepsilon_t)} \right)}} \right)</span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_2}</span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a>其中 $\varepsilon$ 和 $\epsilon$ 表示每个模型参数随时间 $t$ 变化的正态随机误差。有时，在模拟中，只有一个参数会添加变化。作为种群现象，这将导致种群数量遵循不一定是平滑的轨迹，而且在模拟中，单个复制将不足以捕捉可能的动态的潜在范围。在模拟中是否包括这种过程误差将取决于模拟的目的。在这里，目的是探索确定性种群动态的期望，但应该始终记住，这些模型只是近似，旨在代表平均行为。</span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## 年龄结构的建模概念</span></span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a>当然，在我们刚刚考察的剩余产量模型中，最大的简化是，它们忽略了与年龄和个体大小有关的生物学和行为差异的所有方面。这种简化的模型仍然有用(见第 <span class="co">[</span><span class="ot">-@sec-surplusproduction</span><span class="co">]</span> 章“<span class="co">[</span><span class="ot">剩余产量模型</span><span class="co">](07-spm.qmd)</span>”（*Surplus Production Models*） )，但面对公认的网具选择性(类似于捕食者有偏好的猎物)和不同年龄的生长和繁殖力、渔业和其他自然资源科学家经常在他们的模型中包括年龄和或大小。在这里，我们将只对这些想法进行初步处理，因为在详细讨论这些复杂问题之前，还需要建模动态过程的许多其他细节。</span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### 世代中的残存</span></span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a>很明显，个体的残存，$S$，两个时间段之间的残存可用 $t+1$ 时的数量与 $t$ 时的数量的比值表示(记住，如果知道体重与年龄的关系，年龄-数量可以转换为年龄-体质量或年龄-生物量):</span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a>S_t=\frac{{{N}_{t+1}}}{{{N}_{t}}} \quad \text{ or }\quad {{N}_{t+1}}={S_t}{N}_{t} </span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_3}</span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a>这种随时间的比例减少暗示着负指数增长。给定瞬时总死亡率为 $Z$ (自然死亡率和捕捞死亡率之和)，则每年的残存率(即存活的比例)等于 $e^{−Z}$。这可以通过设置一个具有恒定初始条件的模拟种群，并应用不同瞬时总死亡率向量来说明。</span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a>这将相当于考虑一个单一世代补充的为 0+ 年龄的个体。假设没有移入个体，这样的单一世代种群只能在数量上下降，尽管这看起来很明显，但在考虑年龄结构的种群时，这是重要的直觉。总死亡率(通常用 $Z$ 表示)仅仅是自然死亡率(通常用 $M$ 表示)和捕捞死亡率(通常用 $F$ 表示)的总和。在下面的例子中，请注意，应用$Z =0.05$ 会导致即使在 50 年后种群数量也大于零。图示中的每个世代轨迹都描述了种群规模的指数或恒定比例下降。</span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-6</span></span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "不同总死亡率水平下的指数型种群衰退。最上方的曲线是 Z = 0.05，最陡峭的曲线是 Z = 0.55。"</span></span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a><span class="co">#Exponential population declines under different Z. Fig 3.6  </span></span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>yrs <span class="ot">&lt;-</span> <span class="dv">50</span>;  yrs1 <span class="ot">&lt;-</span> yrs <span class="sc">+</span> <span class="dv">1</span> <span class="co"># to leave room for B[0]  </span></span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,yrs,<span class="dv">1</span>)  </span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="dv">1000</span>        <span class="co"># now alternative total mortality rates  </span></span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.55</span>)   </span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a>nZ <span class="ot">&lt;-</span> <span class="fu">length</span>(Z)  </span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a>Bt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>yrs1,<span class="at">ncol=</span>nZ,<span class="at">dimnames=</span><span class="fu">list</span>(years,Z))  </span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a>Bt[<span class="dv">1</span>,] <span class="ot">&lt;-</span> B0  </span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nZ) <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>yrs1) Bt[i,j] <span class="ot">&lt;-</span> Bt[(i<span class="dv">-1</span>),j]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>Z[j])  </span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(years,Bt[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">"Years"</span>,<span class="at">ylab=</span><span class="st">"Population Size"</span>,<span class="at">lwd=</span><span class="dv">2</span>)  </span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (nZ <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nZ) <span class="fu">lines</span>(years,Bt[,j],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>j,<span class="at">lty=</span>j)  </span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend=</span><span class="fu">paste0</span>(<span class="st">"Z = "</span>,Z),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span>nZ,<span class="at">lwd=</span><span class="dv">3</span>,  </span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">"n"</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)   </span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a><span class="fu">### 瞬时 Vs 年死亡率</span></span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a>在前一节中，我们讨论了所谓的瞬时率。它们可以用来生成残存率，即在给定瞬时死亡率的一年后预期残存的比例。瞬时死亡率的概念是指在无限小的时间段内的死亡率。</span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a>我们已经知道每年残存的比例:</span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>S={e}^{-Z}</span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_4}</span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a>因此1年时间死亡率（ $A$ ）表示为：</span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a>A=1-{e}^{-Z}</span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_5}</span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a>如果只考虑瞬时捕捞死亡率 $F$，而忽略自然死亡率，则死亡的比例称为捕获率，$H$。</span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a>H=1-{e}^{-F}</span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_6}</span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a>如果知道了每年的捕获率，就可以将其反向转换来估计瞬时捕捞死亡率。</span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a>F=-\log{(1-H)} </span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_7}</span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a>其中 <span class="in">`log`</span> 是自然对数或以 $e$ 为底的对数。</span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a>有时似乎很难直观地理解瞬时速率的含义。如果举例说明瞬时率是如何推导出来的，这个困难就会减轻。从 1000 个个体的种群开始，假设每年的移除率为 $0.5$，这意味着只有 500 个个体能存活一年。将年总死亡率代入最后一个方程，可估计瞬时总死亡率为 $-\log(1-0.5) = 0.693147$。如果我们使用两个 6 个月周期来近似这个水平所需的时间步长，以获得 50% 的存活率，我们需要将 0.693147 除以 2.0，并将死亡率用 2 次。类似地，如果时间步长是每月的，我们将除以 12，并将结果应用 12 次。虽然很难将每个月称为瞬时，但这将是适用近似瞬时死亡率 (0.693147/12) 的期间。这种重新缩放可以在越来越小的时间间隔中发生，直到时间间隔足够小，结果与预期的 500 个年终剩余个体没有显著差异（ @tbl-3-3 ）。</span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a>显而易见，应用近似瞬时速率的时间间隔越短，最终值就越接近预期的1000的0.5(即500)。希望这些代码能够帮助您对瞬时死亡率概念有直观的了解。</span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a>可以根据瞬时死亡率绘制年死亡率图，以说明两者之间的差异。请注意，瞬时死亡率大约 为 0.18 时，年收捕获 率也大致相同。应该清楚的是，不可能获得大于 1.0 的捕获率(相当于捕获<span class="sc">\&gt;</span>100%的可开发生物量)。高的捕获率开始显得难以置信，如果它们出现在适合渔业模式的情况下，那么在被接受之前，它们确实需要得到保护。另一方面，瞬时率显然可以超过 1.0，但理想情况下，这样的事件不应再被误解。</span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a> <span class="co">#Prepare matrix of harvest rate vs time to appoximate F  </span></span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.5</span>)  </span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a>timediv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">52</span>,<span class="dv">365</span>,<span class="dv">730</span>,<span class="dv">2920</span>,<span class="dv">8760</span>,<span class="dv">525600</span>)  </span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a>yrfrac <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>timediv  </span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yrfrac) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"6mth"</span>,<span class="st">"3mth"</span>,<span class="st">"1mth"</span>,<span class="st">"1wk"</span>,<span class="st">"1d"</span>,<span class="st">"12h"</span>,  </span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3h"</span>,<span class="st">"1h"</span>,<span class="st">"1m"</span>)  </span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a>nfrac <span class="ot">&lt;-</span> <span class="fu">length</span>(yrfrac)  </span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yrfrac"</span>,<span class="st">"divisor"</span>,<span class="st">"yrfracH"</span>,<span class="st">"Remain"</span>)  </span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nfrac,<span class="at">ncol=</span><span class="fu">length</span>(columns),  </span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">names</span>(yrfrac),columns))  </span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nfrac) {  </span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a>   timestepmort <span class="ot">&lt;-</span> Z<span class="sc">/</span>timediv[i]   </span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a>   N <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>timediv[i]) N <span class="ot">&lt;-</span> N <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>timestepmort)  </span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a>   result[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(yrfrac[i],timediv[i],timestepmort,N)  </span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-3</span></span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "将恒定的总死亡率分配到越来越短的时间段内，且这些时间段总和为一年时的结果。yrfrac 是一年的分数，Approx 是瞬时总死亡率除以除数，Remain 是一年后剩余的动物数量（从 1000 开始计算）。"</span></span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(result,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">4</span>)) </span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-7</span></span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "瞬时捕捞死亡率（实线）与年度捕捞死亡率或年度收获率（虚线）之间的关系。在 F 值大于约 0.2 时，数值开始分离。"</span></span>
<span id="cb29-389"><a href="#cb29-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a><span class="co">#Annual harvest rate against instantaneous F, Fig 3.7  </span></span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a>Fi <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="dv">2</span>,<span class="fl">0.001</span>)  </span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>Fi)  </span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a><span class="fu">parset</span>()  <span class="co"># a wrapper for simplifying defining the par values  </span></span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Fi,H,<span class="at">type=</span><span class="st">"l"</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">panel.first=</span><span class="fu">grid</span>(),  </span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Instantaneous Fishing Mortality F"</span>,  </span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Annual Proportion Mortality H"</span>)  </span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)  </span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-399"><a href="#cb29-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-400"><a href="#cb29-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## 简单单位补充量渔获量</span></span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a>我们知道，一旦某一世代补充到群体中，其数量只会减少(假设没有迁入)。注意"补充量（recruitment）"的概念，它可以指后期仔鱼进入资源后，然而，它也可以指个体变得可用或易受渔业损害。这里我们关注的是仔鱼后加入资源后的情况。当我们在下面和第 <span class="co">[</span><span class="ot">-@sec-staticmodel</span><span class="co">]</span> 章“静态模型”（*Static Models*）的章节中考虑选择性和可用性概念时，我们将处理补充量加入到渔业。有趣的是,尽管数字预计将减少通过时间,鉴于个体体长和重量上生长，我们还不知道如果世代的质量总是随时间减少或者增加然后减少最终所有的个体死亡。</span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a>一个世代的质量是否会在几年内增加，即使它的数量首次发现下降，因为对于捕获和努力之间的关系有一种简单但普遍的直觉。很明显，一种鱼类的渔获量总是会随着捕捞努力量的增加而增加，但这只是短期的想法。这个看似显而易见的概念在1930年之前就被驳斥了，并被 @russell1942 的一些出版著作很好地阐述了，他证明了一个渔业的最大持续渔获量不一定来自于最大努力量(或最大捕捞死亡)。这不仅是一个学术问题，而且直接关系到渔业的管理。一旦人们意识到过度捕捞甚至是鱼类资源崩溃的可能性，这一问题直到 20 世纪初才被正式承认 (Garstang, 1900)，那么如何最好地管理渔业就成为一个重要的问题。在管理渔业时，曾试图管理所作的全部努力量。支持这一观点的一个论点来自于单位补充量渔获量 (yield-per-recruit，YPR) 的概念，该概念以数量和质量的形式从数学上跟踪了在不同水平的强制捕捞死亡率下的世代的命运；捕捞死亡率被认为与所采取的努力量直接相关。"单位补充量"的概念意味着它遵循个体世代，并以最大化每个补充量的收益为目标。</span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-407"><a href="#cb29-407" aria-hidden="true" tabindex="-1"></a>我们将重复 @russell1942 的例子来说明YPR背后的思想。Russell 的例子只涉及捕捞死亡率，这与假设没有自然死亡率（忽略了 M）是一样的。对于这个简单的 YPR 我们也会忽略自然死亡率和应用一系列常数收获率每年计算年龄-数量（numbers-at-age）(相当于式 @eq-3_3 ),我们将使用一个年龄-体重乘以年龄-数量计算年龄-渔获量的重量,从中我们可以获得总的预期渔获量。</span>
<span id="cb29-408"><a href="#cb29-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple Yield-per-Recruit see Russell (1942)  </span></span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>;  nage <span class="ot">&lt;-</span> <span class="fu">length</span>(age); N0 <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># some definitions  </span></span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a> <span class="co"># weight-at-age values  </span></span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a>WaA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="fl">0.082</span>,<span class="fl">0.175</span>,<span class="fl">0.283</span>,<span class="fl">0.4</span>,<span class="fl">0.523</span>,<span class="fl">0.7</span>,<span class="fl">0.85</span>,<span class="fl">0.925</span>,<span class="fl">0.99</span>,<span class="fl">1.0</span>)  </span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a> <span class="co"># now the harvest rates  </span></span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.06</span>,<span class="fl">0.11</span>,<span class="fl">0.16</span>,<span class="fl">0.21</span>,<span class="fl">0.26</span>,<span class="fl">0.31</span>,<span class="fl">0.36</span>,<span class="fl">0.55</span>,<span class="fl">0.8</span>)  </span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a>nH <span class="ot">&lt;-</span> <span class="fu">length</span>(H)  </span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a>NaA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nage,<span class="at">ncol=</span>nH,<span class="at">dimnames=</span><span class="fu">list</span>(age,H)) <span class="co"># storage  </span></span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a>CatchN <span class="ot">&lt;-</span> NaA;  CatchW <span class="ot">&lt;-</span> NaA      <span class="co"># define some storage matrices  </span></span>
<span id="cb29-421"><a href="#cb29-421" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nH) {                <span class="co"># loop through the harvest rates  </span></span>
<span id="cb29-422"><a href="#cb29-422" aria-hidden="true" tabindex="-1"></a>   NaA[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> N0  <span class="co"># start each harvest rate with initial numbers  </span></span>
<span id="cb29-423"><a href="#cb29-423" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (age <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nage) {  <span class="co"># loop through over-simplified dynamics  </span></span>
<span id="cb29-424"><a href="#cb29-424" aria-hidden="true" tabindex="-1"></a>      NaA[age,i] <span class="ot">&lt;-</span> NaA[(age<span class="dv">-1</span>),i] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> H[i])  </span>
<span id="cb29-425"><a href="#cb29-425" aria-hidden="true" tabindex="-1"></a>      CatchN[age,i] <span class="ot">&lt;-</span> NaA[(age<span class="dv">-1</span>),i] <span class="sc">-</span> NaA[age,i]  </span>
<span id="cb29-426"><a href="#cb29-426" aria-hidden="true" tabindex="-1"></a>   }  </span>
<span id="cb29-427"><a href="#cb29-427" aria-hidden="true" tabindex="-1"></a>   CatchW[,i] <span class="ot">&lt;-</span> CatchN[,i] <span class="sc">*</span> WaA  </span>
<span id="cb29-428"><a href="#cb29-428" aria-hidden="true" tabindex="-1"></a>}                      <span class="co"># transpose the vector of total catches to  </span></span>
<span id="cb29-429"><a href="#cb29-429" aria-hidden="true" tabindex="-1"></a>totC <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">colSums</span>(CatchW,<span class="at">na.rm=</span><span class="cn">TRUE</span>))   <span class="co"># simplify later printing  </span></span>
<span id="cb29-430"><a href="#cb29-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-431"><a href="#cb29-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-432"><a href="#cb29-432" aria-hidden="true" tabindex="-1"></a>不同的渔获率对种群年龄结构的影响在渔获的分年龄数量和分年龄重量上都很明显。随着渔获率的增加，高年龄组的捕获数量越来越少，分年龄捕获数也越来越少。对于较高的捕获率，种群变得依赖于最近的补充量，而不是在较老的年龄组中数量和生物量的积累。</span>
<span id="cb29-433"><a href="#cb29-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-436"><a href="#cb29-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-437"><a href="#cb29-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-4</span></span>
<span id="cb29-438"><a href="#cb29-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获数量。"</span></span>
<span id="cb29-439"><a href="#cb29-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-440"><a href="#cb29-440" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(NaA,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">row.names=</span><span class="cn">TRUE</span>) </span>
<span id="cb29-441"><a href="#cb29-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-442"><a href="#cb29-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-445"><a href="#cb29-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-446"><a href="#cb29-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-5</span></span>
<span id="cb29-447"><a href="#cb29-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下，种群的分年龄渔获重量。"</span></span>
<span id="cb29-448"><a href="#cb29-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-449"><a href="#cb29-449" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(CatchW[<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>,],<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">row.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-450"><a href="#cb29-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-451"><a href="#cb29-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-454"><a href="#cb29-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-455"><a href="#cb29-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-6</span></span>
<span id="cb29-456"><a href="#cb29-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "应用简单年龄结构模型进行单位补充量产量分析得到的10个年渔获率情形下种群的渔获量。"</span></span>
<span id="cb29-457"><a href="#cb29-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-458"><a href="#cb29-458" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(totC,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb29-459"><a href="#cb29-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-460"><a href="#cb29-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-461"><a href="#cb29-461" aria-hidden="true" tabindex="-1"></a>如果使用 **MQMF** 中的 <span class="in">`plot1()`</span>函数绘制渔获总重量对捕获率的图，我们可以立即看到，在产量方面确实存在一个最佳渔获率，而不是最大利用率。如果让努力量增加，渔获量并不总是增加。如果捕获率很低，那么捕获的鱼类太少，不足以弥补显著的捕获量。然而，产量随着捕获率的增加而迅速增加，而当超过产生最大产量的捕获率时，产量下降得更慢。</span>
<span id="cb29-462"><a href="#cb29-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-465"><a href="#cb29-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-466"><a href="#cb29-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-8</span></span>
<span id="cb29-467"><a href="#cb29-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "忽略自然死亡率、年龄选择性或任何其他影响的简化单位补充量-渔获量分析。该分析使用了 Russell（1942）的部分年龄-体重数据，尽管 Russell 仅考察了两种捕捞率，但本分析考察了更广泛的捕捞率。"</span></span>
<span id="cb29-468"><a href="#cb29-468" aria-hidden="true" tabindex="-1"></a> <span class="co">#Use MQMF::plot1 for a quick plot of the total catches. Figure 3.8  </span></span>
<span id="cb29-469"><a href="#cb29-469" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(H,totC,<span class="at">xlab=</span><span class="st">"Harvest Rate"</span>,<span class="at">ylab=</span><span class="st">"Total Yield"</span>,<span class="at">lwd=</span><span class="dv">2</span>)  </span>
<span id="cb29-470"><a href="#cb29-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-471"><a href="#cb29-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-472"><a href="#cb29-472" aria-hidden="true" tabindex="-1"></a>为了快速说明不同捕获率的影响，这个例子在 1942 年获得了成功。对单位补充量渔获量的更全面的处理需要考虑动态中的自然死亡率和网具选择性带来的年龄死亡率差异。</span>
<span id="cb29-473"><a href="#cb29-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-474"><a href="#cb29-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### 单位补充量渔获量中的选择性 {#sec-ypr_selectivity}</span></span>
<span id="cb29-475"><a href="#cb29-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-476"><a href="#cb29-476" aria-hidden="true" tabindex="-1"></a>通常，在完全年龄结构的渔业模型中，人们会用一个选择性函数来描述每个年龄组(或体长组)对特定捕捞网具的不同脆弱性。随着鱼的年龄增加(或变大)，鱼会越来越多地补充到渔业中，直到它们完全易于受到捕捞的影响。通常，这种选择性曲线的参数是在将年龄结构模型与渔业数据拟合的过程中获得的。然而，在这里，我们将仅仅是给定了属性值(参见第 <span class="co">[</span><span class="ot">-@sec-staticmodel</span><span class="co">]</span>章“静态模型”（*static Models*）中选择性的更多细节)。早期的 YPR 分析经常使用所谓的刀刃选择性，这意味着鱼类在特定年龄 100% 容易受到渔具的攻击。然而，在这里，我们将实现一个更现实、但更简单的脆弱性随年龄的选择性曲线。有许多不同的方程用来描述不同渔具的选择性特性，但拖网渔具使用的一个非常常见的方程是标准 logistic 或 s 形曲线，它也可以有许多公式化的表达式。一个常用来描述随年龄 $S_a$ 或体长变化，选择性 logistic 形状 ，以及年龄或体长的成熟度定义为:</span>
<span id="cb29-477"><a href="#cb29-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-478"><a href="#cb29-478" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-479"><a href="#cb29-479" aria-hidden="true" tabindex="-1"></a>{{S}_{a}}=\frac{1}{1+{{({{e}^{(\alpha +\beta a)}})}^{-1}}}=\frac{{{e}^{(\alpha +\beta a)}}}{1+{{e}^{(\alpha +\beta a)}}} </span>
<span id="cb29-480"><a href="#cb29-480" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_8}</span>
<span id="cb29-481"><a href="#cb29-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-482"><a href="#cb29-482" aria-hidden="true" tabindex="-1"></a>式中 $\alpha$ 和 $\beta$ 为 logistic 参数，$-\alpha/\beta$ 为 0.5（50%）选择性处的年龄。四分位数之间的距离(字面上分位数的25%到75%；logistic曲线梯度的度量)定义为 $IQ=2\log(3)/\beta$（参见 **MQMF** 函数 `mature()` 用于该函数的执行）。一般来说，在年龄结构模型中，需要长度或年龄组成数据，以便直接估计网具选择性和渔业可用性。在计算单位补充量渔获量时，通常的理由是要包括一种形式的选择性，以确定开始应用捕捞死亡率的最佳年龄。在管理方面，这可以用来确定拖网或刺网的网眼尺寸。这就是为什么刀刃选择性经常被使用的原因，它可以识别年龄在什么年龄以下没有选择，在什么年龄以上有 100% 的选择。这在 **MQMF** 函数 <span class="in">`logistic()`</span> 中实现（使用不同的公式），但在 <span class="in">`mature()`</span> 中没有实现。刀刃选择性并不倾向于在完整的年龄结构种群评估模型中使用。</span>
<span id="cb29-483"><a href="#cb29-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-486"><a href="#cb29-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-487"><a href="#cb29-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-9</span></span>
<span id="cb29-488"><a href="#cb29-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "使用 mature() 函数的逻辑斯蒂 S 形曲线示例。图例包含每条曲线的 L50 和 IQ，其参数在代码中定义。"</span></span>
<span id="cb29-489"><a href="#cb29-489" aria-hidden="true" tabindex="-1"></a> <span class="co">#Logistic S shaped cureve for maturity  </span></span>
<span id="cb29-490"><a href="#cb29-490" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">1</span>)  </span>
<span id="cb29-491"><a href="#cb29-491" aria-hidden="true" tabindex="-1"></a>sel1 <span class="ot">&lt;-</span> <span class="fu">mature</span>(<span class="sc">-</span><span class="fl">3.650425</span>,<span class="fl">0.146017</span>,<span class="at">sizeage=</span>ages) <span class="co">#-3.65/0.146=25  </span></span>
<span id="cb29-492"><a href="#cb29-492" aria-hidden="true" tabindex="-1"></a>sel2 <span class="ot">&lt;-</span> <span class="fu">mature</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="fl">0.2</span>,ages)  </span>
<span id="cb29-493"><a href="#cb29-493" aria-hidden="true" tabindex="-1"></a>sel3 <span class="ot">&lt;-</span> <span class="fu">mature</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="fl">0.24</span>,ages)  </span>
<span id="cb29-494"><a href="#cb29-494" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(ages,sel1,<span class="at">xlab=</span><span class="st">"Age Yrs"</span>,<span class="at">ylab=</span><span class="st">"Selectivity"</span>,<span class="at">cex=</span><span class="fl">0.75</span>,<span class="at">lwd=</span><span class="dv">2</span>)  </span>
<span id="cb29-495"><a href="#cb29-495" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ages,sel2,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)  </span>
<span id="cb29-496"><a href="#cb29-496" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ages,sel3,<span class="at">col=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">3</span>)  </span>
<span id="cb29-497"><a href="#cb29-497" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">25</span>,<span class="at">col=</span><span class="st">"grey"</span>,<span class="at">lty=</span><span class="dv">2</span>)   </span>
<span id="cb29-498"><a href="#cb29-498" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>),<span class="at">col=</span><span class="st">"grey"</span>,<span class="at">lty=</span><span class="dv">2</span>)  </span>
<span id="cb29-499"><a href="#cb29-499" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"25_15.04"</span>,<span class="st">"30_10.986"</span>,<span class="st">"25_9.155"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),  </span>
<span id="cb29-500"><a href="#cb29-500" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">cex=</span><span class="fl">1.1</span>,<span class="at">bty=</span><span class="st">"n"</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)  </span>
<span id="cb29-501"><a href="#cb29-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-502"><a href="#cb29-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-503"><a href="#cb29-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-504"><a href="#cb29-504" aria-hidden="true" tabindex="-1"></a><span class="fu">### Baranov 渔获量方程</span></span>
<span id="cb29-505"><a href="#cb29-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-506"><a href="#cb29-506" aria-hidden="true" tabindex="-1"></a>@eq-3_4 描述了结合捕捞和自然死亡后的残存率，但简单的总死亡率 $Z$意味着所有鱼的捕捞死亡率相同。如果我们要考虑选择性，那么我们需要考虑年龄的捕捞死亡率。</span>
<span id="cb29-507"><a href="#cb29-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-508"><a href="#cb29-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-509"><a href="#cb29-509" aria-hidden="true" tabindex="-1"></a>S_{a,t}=e^{-(M + {s_a}{F_t})} </span>
<span id="cb29-510"><a href="#cb29-510" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_9}</span>
<span id="cb29-511"><a href="#cb29-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-512"><a href="#cb29-512" aria-hidden="true" tabindex="-1"></a>其中 $S_{a,t}$ 为 $t$ 年 $a$ 龄鱼的残存率，$M$ 为自然死亡系数（假设随时间不变），$s_a$ 为年龄 $a$ 的选择性，$F_t$ 已知，$t$ 年完全选择的捕捞死亡系数。</span>
<span id="cb29-513"><a href="#cb29-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-514"><a href="#cb29-514" aria-hidden="true" tabindex="-1"></a>一旦残存数量 $S_tN_t$ 已知，那么死亡的数量显然不同时期存在差异。从一个时间段到下一个时间段一个世代的死亡总数量可以表示为:</span>
<span id="cb29-515"><a href="#cb29-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-516"><a href="#cb29-516" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-517"><a href="#cb29-517" aria-hidden="true" tabindex="-1"></a>N_{z}=N_{t}-N_{t+1}  </span>
<span id="cb29-518"><a href="#cb29-518" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_10}</span>
<span id="cb29-519"><a href="#cb29-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-520"><a href="#cb29-520" aria-hidden="true" tabindex="-1"></a>如果用残存等式代替 $N_{t_1}$，就可得到残存的补偿方程，其描述了时间段间总死亡数量：</span>
<span id="cb29-521"><a href="#cb29-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-522"><a href="#cb29-522" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-523"><a href="#cb29-523" aria-hidden="true" tabindex="-1"></a>N_{a,z}=N_{a,t}-N_{a,t}{e}^{-(M+{s_a}{F_t})}=N_{a,t}(1-{e}^{-(M+{s_a}{F_t})})</span>
<span id="cb29-524"><a href="#cb29-524" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_11}</span>
<span id="cb29-525"><a href="#cb29-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-526"><a href="#cb29-526" aria-hidden="true" tabindex="-1"></a>这里 $N_{a,z}$ 为年龄 $a$ 死亡的数量。当然，不是所有死亡的鱼都作为渔获，一些是自然死亡的，但也出现捕捞一些自然死亡的个体的现象。将死亡率分为 $M$（假设不同年龄的自然死亡系数不变）和 $F_t$ (捕捞努力量引起的完全选择死亡)，它可以随时间 $t$ 而变化，可以计算渔获量和残存量。可以将 $s_aF_t$ 简化为 $F_{a,t}$。有可能进行这种分开的假设是年龄结构和体长结构的种群评估模型的一个重要组成部分。使用瞬时率，由于捕捞死亡而非自然死亡的数量用分数 $F_{a,t}/(M+F_{a,t})$ 来描述，如果将其包含到 @eq-3_11 中，我们发现我们已经推导出了所谓的 Baranov 渔获量方程 <span class="co">[</span><span class="ot">@quinn2003; @quinn1999</span><span class="co">]</span> ，现在通常用于渔业建模，以估计渔获中的数量。它被用来追踪单个世代的命运，如果将所有年龄段相加，就能得出总的渔获量:</span>
<span id="cb29-527"><a href="#cb29-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-528"><a href="#cb29-528" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-529"><a href="#cb29-529" aria-hidden="true" tabindex="-1"></a>{{\hat{C}}_{a,t}}=\frac{{F}_{a,t}}{M+{F}_{a,t}}{{N}_{a,t}}\left( 1-{{e}^{-\left( M+{{F}_{a,t}} \right)}} \right)</span>
<span id="cb29-530"><a href="#cb29-530" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_12}</span>
<span id="cb29-531"><a href="#cb29-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-532"><a href="#cb29-532" aria-hidden="true" tabindex="-1"></a>其中$\hat{C}_{a,t}$为$t$年年龄$a$的期望渔获，$F_{a,t}$为$t$年年龄$a$的瞬时捕捞死亡系率（$s_aF_t$），$M$为自然死亡率（假设年龄间不变），$N_{a,t}$为$t$年年龄$a$的数量。该方程可用**MQMF**的函数<span class="in">`bce()`</span>运行。</span>
<span id="cb29-533"><a href="#cb29-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-536"><a href="#cb29-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-537"><a href="#cb29-537" aria-hidden="true" tabindex="-1"></a> <span class="co"># Baranov catch equation  </span></span>
<span id="cb29-538"><a href="#cb29-538" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">12</span>;  nage <span class="ot">&lt;-</span> <span class="fu">length</span>(age)   </span>
<span id="cb29-539"><a href="#cb29-539" aria-hidden="true" tabindex="-1"></a>sa <span class="ot">&lt;-</span><span class="fu">mature</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">2</span>,age) <span class="co">#selectivity-at-age  </span></span>
<span id="cb29-540"><a href="#cb29-540" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fl">0.2</span>;  M <span class="ot">&lt;-</span> <span class="fl">0.35</span>  </span>
<span id="cb29-541"><a href="#cb29-541" aria-hidden="true" tabindex="-1"></a>FF <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> H)<span class="co">#Fully selected instantaneous fishing mortality  </span></span>
<span id="cb29-542"><a href="#cb29-542" aria-hidden="true" tabindex="-1"></a>Ft <span class="ot">&lt;-</span> sa <span class="sc">*</span> FF     <span class="co"># instantaneous Fishing mortality-at-age  </span></span>
<span id="cb29-543"><a href="#cb29-543" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb29-544"><a href="#cb29-544" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">bce</span>(M,Ft,N0,age),<span class="st">"Select"</span><span class="ot">=</span>sa)  <span class="co"># out becomes Table 3.7  </span></span>
<span id="cb29-545"><a href="#cb29-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-546"><a href="#cb29-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-549"><a href="#cb29-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-550"><a href="#cb29-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-7</span></span>
<span id="cb29-551"><a href="#cb29-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "将巴拉诺夫捕捞方程应用于年捕捞率为 0.2 且瞬时自然死亡率为 0.3 的种群。"</span></span>
<span id="cb29-552"><a href="#cb29-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-553"><a href="#cb29-553" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(out, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-554"><a href="#cb29-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-555"><a href="#cb29-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-556"><a href="#cb29-556" aria-hidden="true" tabindex="-1"></a><span class="fu">### 生长和各年龄体重</span></span>
<span id="cb29-557"><a href="#cb29-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-558"><a href="#cb29-558" aria-hidden="true" tabindex="-1"></a>为了获得渔获量的质量(即渔获量的重量)，需要将渔获量中的各年龄数量乘以各年龄重量。各年龄体重可以是特定年份特定渔业的平均体重观测值的向量 <span class="co">[</span><span class="ot">@beverton1993a</span><span class="co">]</span> ，或者，更常见的是，从 von Bertalanffy 生长曲线推导出的标准年龄体重方程，它从各年龄长度开始。</span>
<span id="cb29-559"><a href="#cb29-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-560"><a href="#cb29-560" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-561"><a href="#cb29-561" aria-hidden="true" tabindex="-1"></a>L_{a}=L_{\infty}(1-e^{(-K(a-t_0))}) </span>
<span id="cb29-562"><a href="#cb29-562" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_13}</span>
<span id="cb29-563"><a href="#cb29-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-564"><a href="#cb29-564" aria-hidden="true" tabindex="-1"></a>其中，$L_a$为年龄$a$的长度，$L_{\infty}$为平均最大年龄长度，$K$为系数，它决定了如何快速达到 $L_{\infty}$，$t_0$ 为长度为 0 时的假设年龄。用 **MQMF** 的函数 <span class="in">`vB()`</span>运行。假设各年龄长度和各年龄体重之间存在幂次关系，因此增加了两个参数:</span>
<span id="cb29-565"><a href="#cb29-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-566"><a href="#cb29-566" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-567"><a href="#cb29-567" aria-hidden="true" tabindex="-1"></a>\begin{aligned}  </span>
<span id="cb29-568"><a href="#cb29-568" aria-hidden="true" tabindex="-1"></a>{W_a}  &amp;= {\alpha}{L_a}^{b}=w_a(1-e^{(-K(a-t_0))})^{b} <span class="sc">\\</span>  </span>
<span id="cb29-569"><a href="#cb29-569" aria-hidden="true" tabindex="-1"></a>{\log{(W_a)}} &amp;= \log{(\alpha)}+{b}{L_a}  </span>
<span id="cb29-570"><a href="#cb29-570" aria-hidden="true" tabindex="-1"></a>\end{aligned}  </span>
<span id="cb29-571"><a href="#cb29-571" aria-hidden="true" tabindex="-1"></a>$$ {#eq-3_14}</span>
<span id="cb29-572"><a href="#cb29-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-573"><a href="#cb29-573" aria-hidden="true" tabindex="-1"></a>其中，$\alpha$ 为恒定值，$w_a$ 为 $(\alpha L_{\infty})$，$b$ 为指数，近似为 3.0（大小是二维的，而重量是三维的）。对数变换形式当然是线性的。在第 <span class="co">[</span><span class="ot">-@sec-staticmodel</span><span class="co">]</span>章“静态模型”（*Static Models*）中，我们将看到如何估计这些模型的参数。</span>
<span id="cb29-574"><a href="#cb29-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-575"><a href="#cb29-575" aria-hidden="true" tabindex="-1"></a><span class="fu">## 完整的单位补充量产量</span></span>
<span id="cb29-576"><a href="#cb29-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-577"><a href="#cb29-577" aria-hidden="true" tabindex="-1"></a>把所有这些整合在一起，意味着我们可以产生一个更完整的单位补充量产量（YPR）分析。标准的 YPR 分析假设恒定的补充量，这意味着我们可以跟踪单个世代的命运，并仍然捕捉所需的细节。当然，补充量不是一个常数，所以这种方法被认为是基于长期或平衡条件。以这种方式忽略变化和随机性意味着，任何关于潜在生产力和由此产生的管理决策的结论都需要谨慎对待（事实上，非常谨慎）。但这些方法是在渔业分析都是确定性的，并假定处于平衡状态时发展起来的，不确定性的含义尚未被探索 <span class="co">[</span><span class="ot">@beverton1993a</span><span class="co">]</span> 。</span>
<span id="cb29-578"><a href="#cb29-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-579"><a href="#cb29-579" aria-hidden="true" tabindex="-1"></a>当目标是最大化产量时，这样的分析是有意义的。但是，恒定补充量的假设和对不确定性的忽视意味着这些分析通常不是保守的。人们尝试改进 YPR 分析提出的建议，其中比较有用的是 $F_{0.1}$ 的出现(发音为 F zero point one)。定义为产量曲线起点处产量增长率 1/10 的渔获率 <span class="co">[</span><span class="ot">@hilborn1992</span><span class="co">]</span>。$F_{0.1}$ 的优势这是捕捞努力量的相对 大幅下降，只会导致产量的很小损失。这可以提高渔业的经济效益和可持续性。然而，本质上使用 $F_{0.1}$ 仍然是一个经验规则，它在实践中比 $F_{max}$ （最高产量点）更可持续，通常比 $F_{msy}$ (平衡时可产生 MSY 的捕捞死亡率)更好。</span>
<span id="cb29-580"><a href="#cb29-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-583"><a href="#cb29-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-584"><a href="#cb29-584" aria-hidden="true" tabindex="-1"></a><span class="co"># A more complete YPR analysis  </span></span>
<span id="cb29-585"><a href="#cb29-585" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>;  nage <span class="ot">&lt;-</span> <span class="fu">length</span>(age) <span class="co">#storage vectors and matrices  </span></span>
<span id="cb29-586"><a href="#cb29-586" aria-hidden="true" tabindex="-1"></a>laa <span class="ot">&lt;-</span> <span class="fu">vB</span>(<span class="fu">c</span>(<span class="fl">50.0</span>,<span class="fl">0.25</span>,<span class="sc">-</span><span class="fl">1.5</span>),age) <span class="co"># length-at-age  </span></span>
<span id="cb29-587"><a href="#cb29-587" aria-hidden="true" tabindex="-1"></a>WaA <span class="ot">&lt;-</span> (<span class="fl">0.015</span> <span class="sc">*</span> laa <span class="sc">^</span> <span class="fl">3.0</span>)<span class="sc">/</span><span class="dv">1000</span>  <span class="co"># weight-at-age as kg  </span></span>
<span id="cb29-588"><a href="#cb29-588" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.65</span>,<span class="fl">0.05</span>);  nH <span class="ot">&lt;-</span> <span class="fu">length</span>(H)     </span>
<span id="cb29-589"><a href="#cb29-589" aria-hidden="true" tabindex="-1"></a>FF <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> H),<span class="dv">5</span>)  <span class="co"># Fully selected fishing mortality  </span></span>
<span id="cb29-590"><a href="#cb29-590" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb29-591"><a href="#cb29-591" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span>  </span>
<span id="cb29-592"><a href="#cb29-592" aria-hidden="true" tabindex="-1"></a>numt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nage,<span class="at">ncol=</span>nH,<span class="at">dimnames=</span><span class="fu">list</span>(age,FF))  </span>
<span id="cb29-593"><a href="#cb29-593" aria-hidden="true" tabindex="-1"></a>catchN <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nage,<span class="at">ncol=</span>nH,<span class="at">dimnames=</span><span class="fu">list</span>(age,FF))  </span>
<span id="cb29-594"><a href="#cb29-594" aria-hidden="true" tabindex="-1"></a>as50 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)    </span>
<span id="cb29-595"><a href="#cb29-595" aria-hidden="true" tabindex="-1"></a>yield <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>nH,<span class="at">ncol=</span><span class="fu">length</span>(as50),<span class="at">dimnames=</span><span class="fu">list</span>(H,as50))  </span>
<span id="cb29-596"><a href="#cb29-596" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sel <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(as50)) {  </span>
<span id="cb29-597"><a href="#cb29-597" aria-hidden="true" tabindex="-1"></a>   sa <span class="ot">&lt;-</span> <span class="fu">logist</span>(as50[sel],<span class="fl">1.0</span>,age)  <span class="co"># selectivity-at-age  </span></span>
<span id="cb29-598"><a href="#cb29-598" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (harv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nH) {  </span>
<span id="cb29-599"><a href="#cb29-599" aria-hidden="true" tabindex="-1"></a>      Ft <span class="ot">&lt;-</span> sa <span class="sc">*</span> FF[harv]      <span class="co"># Fishing mortality-at-age  </span></span>
<span id="cb29-600"><a href="#cb29-600" aria-hidden="true" tabindex="-1"></a>      out <span class="ot">&lt;-</span> <span class="fu">bce</span>(M,Ft,N0,age)  </span>
<span id="cb29-601"><a href="#cb29-601" aria-hidden="true" tabindex="-1"></a>      numt[,harv] <span class="ot">&lt;-</span> out[,<span class="st">"Nt"</span>]  </span>
<span id="cb29-602"><a href="#cb29-602" aria-hidden="true" tabindex="-1"></a>      catchN[,harv] <span class="ot">&lt;-</span> out[,<span class="st">"Catch"</span>]  </span>
<span id="cb29-603"><a href="#cb29-603" aria-hidden="true" tabindex="-1"></a>      yield[harv,sel] <span class="ot">&lt;-</span> <span class="fu">sum</span>(out[,<span class="st">"Catch"</span>] <span class="sc">*</span> WaA,<span class="at">na.rm=</span><span class="cn">TRUE</span>)  </span>
<span id="cb29-604"><a href="#cb29-604" aria-hidden="true" tabindex="-1"></a>   } <span class="co"># end of harv loop  </span></span>
<span id="cb29-605"><a href="#cb29-605" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end of sel loop  </span></span>
<span id="cb29-606"><a href="#cb29-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-607"><a href="#cb29-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-610"><a href="#cb29-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-611"><a href="#cb29-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-3-10</span></span>
<span id="cb29-612"><a href="#cb29-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "不同捕捞强度和不同初次开发年龄对总平衡产量的影响。图例标明了不同的初次开发年龄。"</span></span>
<span id="cb29-613"><a href="#cb29-613" aria-hidden="true" tabindex="-1"></a><span class="co">#A full YPR analysis  Figure 3.10  </span></span>
<span id="cb29-614"><a href="#cb29-614" aria-hidden="true" tabindex="-1"></a><span class="fu">plot1</span>(H,yield[,<span class="dv">3</span>],<span class="at">xlab=</span><span class="st">"Harvest Rate"</span>,<span class="at">ylab=</span><span class="st">"Yield"</span>,<span class="at">cex=</span><span class="fl">0.75</span>,<span class="at">lwd=</span><span class="dv">2</span>)  </span>
<span id="cb29-615"><a href="#cb29-615" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(H,yield[,<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)  </span>
<span id="cb29-616"><a href="#cb29-616" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(H,yield[,<span class="dv">1</span>],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">3</span>)  </span>
<span id="cb29-617"><a href="#cb29-617" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>,<span class="at">legend=</span>as50,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">bty=</span><span class="st">"n"</span>,  </span>
<span id="cb29-618"><a href="#cb29-618" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex=</span><span class="fl">1.0</span>,<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>))   </span>
<span id="cb29-619"><a href="#cb29-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-620"><a href="#cb29-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-621"><a href="#cb29-621" aria-hidden="true" tabindex="-1"></a>这些详细的分析考虑了选择性、年龄体重和自然死亡率，提供了一个渔场在不同条件下的潜在产量的更准确的表示，尽管仍然是确定性的。一旦考虑到不确定性和自然变化，即使只是近似地使用$F_{0.1}$ ，那么YPR分析仍然可以为了解特定渔业的生产能力提供一些有用的见解。当然，如今onbe更有可能进行单位补充量的利润分析，但原则是不变的。</span>
<span id="cb29-622"><a href="#cb29-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-625"><a href="#cb29-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-626"><a href="#cb29-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-3-8</span></span>
<span id="cb29-627"><a href="#cb29-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "不同捕捞率（行）和不同首次开发年龄（列）对总平衡产量的影响。"</span></span>
<span id="cb29-628"><a href="#cb29-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-629"><a href="#cb29-629" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(yield, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb29-630"><a href="#cb29-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-631"><a href="#cb29-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-632"><a href="#cb29-632" aria-hidden="true" tabindex="-1"></a><span class="fu">## 结束语</span></span>
<span id="cb29-633"><a href="#cb29-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-634"><a href="#cb29-634" aria-hidden="true" tabindex="-1"></a>我们使用了相对简单的种群模型来说明渔业和生态学中的许多观点。重要的是，重点是模拟模型，而不是将模型与数据拟合(见下一章“模型参数估计”)。模拟模型通常包括模型参数值的不确定性，但是，由于许多题目在这里只作了介绍性的处理，更彻底的处理本身需要一本书。然而，通过探索在考虑的各种模型上施加一系列参数值的含义，这些模型的属性和隐含的动力学可以被揭示出来。因此，模拟研究是对任何自然过程建模的重要工具。然而，同样重要的是，使用这些参数的合理或现实的组合进行模拟。理解所有模型的数学性质是很有用的，但是，自然地，最重要的兴趣是当模型具有现实值并可能在自然界中找到时。</span>
<span id="cb29-635"><a href="#cb29-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-636"><a href="#cb29-636" aria-hidden="true" tabindex="-1"></a>在使用任何种群模型或其组成部分时获得的直觉对理解任何未来的工作都有价值，但是，当然，所说明的每个模型(特别是相对简单的模型)中的上下文和假设总是要记住的。令人惊讶的是，即使是简单的模型有时也能提供对各种自然过程的洞察。</span>
<span id="cb29-637"><a href="#cb29-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-638"><a href="#cb29-638" aria-hidden="true" tabindex="-1"></a>在本章中，我们只考虑了简单的种群模型，但我们也可以很好地使用 R 来探索物种之间在竞争、捕食、寄生、共生等过程中的相互作用。所有的早期模型(Lotka，1925；Wolterra，1927；Gause，1934)考虑了没有空间结构的种群。使用 R 会相对直接地增加这种模型的复杂性，并包括空间细节，如 Huffaker(1958) 的实验探索。Huffaker 后来的一些实验性捕食者-补捕食者安排持续了 490 天。在这种情况下，模拟研究对于扩展探索的可能性非常有用。这样有趣的工作将需要成为另一本书的一部分，因为在渔业领域，我们还有许多其他领域需要探索和讨论。</span>
<span id="cb29-639"><a href="#cb29-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-640"><a href="#cb29-640" aria-hidden="true" tabindex="-1"></a>使用 R 作为进行此类模拟的工具，使得分析比在电子表格上布置参数操作更抽象。然而，代码块和已开发函数的可重用性，以及更复杂模型和函数的增量开发的潜力所带来的优势，超过了编程环境的更抽象的本质。使用 R 作为一种编程语言来开发这些不同的分析非常适合渔业和生态建模工作。</span>
</code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>