{"headings":["引言","不确定性类型","示例模型","自助法bootstrapping","经验概率密度分布","简单自助法示例","自助法时间序列数据","参数相关性","渐近误差","模型输出的不确定性","从多元正态分布中取样","似然剖面","基于似然比的置信区间","负对数似然或似然","模型输出中的分位数似然剖面","贝叶斯后验分布","生成马尔可夫链","起始点","预烧期","收敛至稳定分布","跳跃分布","mcmc的应用示例","马尔可夫链蒙特卡罗mcmc","mcmc的第一个示例","边际分布","rcpp的应用","处理向量和矩阵","simpspm-的替代方法","多个独立链","所需重复实验以避免序列相关","结束语","sec-uncertainty"],"options":{"tbl-title":"表","fig-prefix":"图","tbl-prefix":"表","chapter-id":"sec-uncertainty","fig-title":"图","chapters":true,"eq-prefix":"公式"},"entries":[{"caption":"6  不确定性","key":"sec-uncertainty","order":{"number":1,"section":[6,0,0,0,0,0,0]}},{"caption":"abdat 数据集中 cpue 和捕捞量时间序列。","key":"fig-6-14","order":{"number":14,"section":[6,7,6,0,0,0,0]}},{"caption":"稀疏率为 128 时 1000 个点的边际后验分布。在每种情况下，垂直蓝线都是最大似然最优估计值。可能需要更多的重复来平滑分布。后验模式不一定与最大似然估计值相同。","key":"fig-6-20","order":{"number":20,"section":[6,7,9,0,0,0,0]}},{"caption":"","key":"eq-6_17","order":{"number":17,"section":[6,6,3,0,0,0,0]}},{"caption":"","key":"eq-6_2","order":{"number":2,"section":[6,1,2,0,0,0,0]}},{"caption":"四个 Schaefer 模型参数的轨迹显示的自相关性。这是在对四个参数中的每个参数进行 16 = 4 的稀疏化处理后得到的结果。显然，要消除出现的强相关性，需要大幅提高步长。","key":"fig-6-18","order":{"number":18,"section":[6,7,8,0,0,0,0]}},{"caption":"","key":"eq-6_9","order":{"number":9,"section":[6,5,0,0,0,0,0]}},{"caption":"用于制作 MSY 似然曲线的 nlm 解中前 113 行的前 7 条和最后 7 条记录（可以更多）。行名是试验的 MSY 值，pen 是惩罚值。","key":"tbl-6-5","order":{"number":5,"section":[6,6,3,0,0,0,0]}},{"caption":"","key":"eq-6_1","order":{"number":1,"section":[6,1,2,0,0,0,0]}},{"caption":"Schaefer 剩余产量模型对 abdat 数据集拟合的 K 参数似然曲线。在这种情况下，负对数似然值已被反转为似然值并缩放到总和为 1.0。垂直线是围绕均值的近似 95% 置信界限。最上面的三个数字是界限和估计的最优值。","key":"fig-6-12","order":{"number":12,"section":[6,6,2,0,0,0,0]}},{"caption":"用于制作 K 的似然轮廓的 nlm 解的前 8 条记录，共481行。包括反转换后的负对数似然值（缩放到总和为 1.0）及其运行累积和。","key":"tbl-6-4","order":{"number":4,"section":[6,6,2,0,0,0,0]}},{"caption":"用 Schaefer 模型拟合 abdat 数据集时，1000 个自助法估算的最佳参数估算值与得出的 MSY 值之间的关系。全色强度由至少 20 个点得出。更多的自举重复将使这些强度图更加完整。The relationships between the 1000 bootstrap estimates of the optimum parameter estimates and the derived MSY values for the Schaefer model fitted to the abdat data-set. Full colour intensity derived from a minimum of 20 points. More bootstrap replicates would fill out these intensity plots.","key":"fig-6-6","order":{"number":6,"section":[6,4,1,0,0,0,0]}},{"caption":"simpspm() 和 simpspmC() 的预测结果并排展示，以证明代码从参数 c(r=0.389, K=9200, Binit=3300, sigma=0.05) 生成了相同的答案。","key":"tbl-6-7","order":{"number":7,"section":[6,8,2,0,0,0,0]}},{"caption":"","key":"eq-6_19","order":{"number":19,"section":[6,7,1,0,0,0,0]}},{"caption":"Schaefer 剩余产量模型对 abdat 数据集拟合得到的 r 参数的似然曲线。水平实线是最小值和最小值减去 1.92（95% 水平，自由度为 1，见正文）。外部的垂直线是围绕中心均值 0.389 的近似 95% 置信区间。","key":"fig-6-10","order":{"number":10,"section":[6,6,1,0,0,0,0]}},{"caption":"","key":"eq-6_18","order":{"number":18,"section":[6,7,1,0,0,0,0]}},{"caption":"","key":"eq-6_10","order":{"number":10,"section":[6,5,0,0,0,0,0]}},{"caption":"","key":"eq-6_7","order":{"number":7,"section":[6,4,0,0,0,0,0]}},{"caption":"","key":"eq-6_15","order":{"number":15,"section":[6,6,1,0,0,0,0]}},{"caption":"","key":"eq-6_5","order":{"number":5,"section":[6,1,2,0,0,0,0]}},{"caption":"从最优参数及其相关方差-协方差矩阵定义的多变量正态分布中采样的随机参数向量得出的 1000 条 cpue 预测轨迹。The 1000 predicted cpue trajectories derived from random parameter vectors sampled from the multi-variate Normal distribution defined by the optimum parameters and their related variance-covariance matrix.","key":"fig-6-7","order":{"number":7,"section":[6,5,2,0,0,0,0]}},{"caption":"在 2048（虚线）和 1024（黑色实线）的稀疏率下，使用 1000 和 2000 个重复序列计算的 K 参数边际密度分布在两个链之间的变化。The variation between two chains in the marginal density distributions for the K parameter using 1000 and 2000 replicates at thinning rates of 2048 (dashed line) and 1024 (solid black line).","key":"fig-6-24","order":{"number":24,"section":[6,8,4,0,0,0,0]}},{"caption":"两条链在 Schaefer 模型四个参数上的自相关性，综合稀疏率分别为 1024 和 2048。请注意，Y 轴上的最大值缩小了，使两者之间的差异更加明显。","key":"fig-6-23","order":{"number":23,"section":[6,8,4,0,0,0,0]}},{"caption":"在 64（4x64=256）的稀疏率下使用 10000 次重复和 simpspmC 函数计算的四种 Schaefer 参数的边际密度分布在三个链之间的差异。在线宽大于平均值的地方，会出现明显的细微差别。","key":"fig-6-22","order":{"number":22,"section":[6,8,3,0,0,0,0]}},{"caption":"用 Schaefer 剩余生产模型拟合 abdat 数据集得到的 MSY 的似然曲线。水平红色线是最小值和最小值加 1.92（卡方分布 1 自由度的 95% 水平，见正文）。垂直线是围绕 887.729 吨均值的近似 95% 置信区间。","key":"fig-6-13","order":{"number":13,"section":[6,6,3,0,0,0,0]}},{"caption":"Schaefer 剩余产量模型对 abdat 数据集的 K 参数的似然曲线，与 r 参数的处理方式相同。红线是最小值和最小值加 1.92（卡方分布 1 自由度的 95% 水平，见正文）。垂直粗线是围绕 9128.5 均值的近似 95% 置信区间。","key":"fig-6-11","order":{"number":11,"section":[6,6,1,0,0,0,0]}},{"caption":"simpspm 和 simpspmC 函数的微基准比较输出结果。微秒值分别是最小值、25 分位数、均值和中位数、75 分位数、最大值以及比较中的评估次数。TimeRatio 是第二行除以第一行，因此就均值而言，simpspmC 所需时间约为 simpspm 的 7%。实际值会在不同运行中有所变化，但变化不会太大，尽管不同计算机和不同版本的 R 之间可能会有差异（最好使用最新版本，通常最快）。","key":"tbl-6-8","order":{"number":8,"section":[6,8,2,0,0,0,0]}},{"caption":"","key":"eq-6_11","order":{"number":11,"section":[6,5,0,0,0,0,0]}},{"caption":"abdat 数据集的 Schaefer 剩余产量模型 的最佳拟合用在线性空间表示（红色实线）。灰线穿过数据点，以说明与预测线的差异。The optimum fit of the Schaefer surplus production model to the abdat data set plotted in linear-space (solid red-line). The grey line passes through the data points to clarify the difference with the predicted line.","key":"fig-6-1","order":{"number":1,"section":[6,1,2,0,0,0,0]}},{"caption":"当抽稀步长为 512 = 4 x 128 时，四个 Schaefer 模型参数的轨迹中显示的自相关情况，这是第一个自相关图中所用抽稀步长的 128 倍。","key":"fig-6-19","order":{"number":19,"section":[6,7,8,0,0,0,0]}},{"caption":"","key":"eq-6_6","order":{"number":6,"section":[6,4,0,0,0,0,0]}},{"caption":"","key":"eq-6_16","order":{"number":16,"section":[6,6,2,0,0,0,0]}},{"caption":"四个 Schaefer 模型参数的轨迹以及每个参数的隐含边际分布。如果稀疏化步长增加到 128、256 或更长，迹线内明显的自相关性就会得到改善。","key":"fig-6-17","order":{"number":17,"section":[6,7,8,0,0,0,0]}},{"caption":"5000次自助法估算的基围虾和老虎虾渔获量之间相关性，原始均值用绿色虚线表示，自助法均值和 90% CI 用蓝色实线表示。出于图示目的，已删除了可能的负相关（尽管没有出现）。","key":"fig-6-3","order":{"number":3,"section":[6,3,0,0,0,0,0]}},{"caption":"比较由 simpspm 函数（实黑线）和 simpspmC 函数（虚蓝线）生成的链的 K 参数密度分布，每条链具有相同的起始位置和相同的随机种子，它们相互重叠。使用不同的种子或不同的起始位置重复这些示例，以观察效果。","key":"fig-6-21","order":{"number":21,"section":[6,8,2,0,0,0,0]}},{"caption":"","key":"eq-6_12","order":{"number":12,"section":[6,5,0,0,0,0,0]}},{"caption":"","key":"eq-6_22","order":{"number":22,"section":[6,7,5,0,0,0,0]}},{"caption":"从最优解估算的多变量正态中得出的 r、K、Binit 和推导的 MSY 的 1000 个参数估计直方图。在每幅图中，绿线表示算术平均值，蓝色粗线表示中位数，两条蓝色细线表示中位数周围 90%的置信区间。Histograms of the 1000 parameter estimates for r, K, Binit, and the derived MSY, from the multi-variate normal estimated at the optimum solution. In each plot, the green line denotes the arithmetic mean, the thick blue line the median, and the two fine blue lines the inner 90% confidence bounds around the median.","key":"fig-6-9","order":{"number":9,"section":[6,5,2,0,0,0,0]}},{"caption":"","key":"eq-6_21","order":{"number":21,"section":[6,7,1,0,0,0,0]}},{"caption":"前三个模型参数的 1000 个自举估计值和 MSY 的柱状图。在每幅图中，两条细外线定义了中位数周围的 90%置信区间，中间的垂直线表示最佳估计值，但这些估计值通常紧靠中位数下方，Binit 模型除外。The 1000 bootstrap estimates of each of the first three model parameters and MSY as histograms. In each plot the two fine outer lines define the inner 90% confidence bounds around the median, the central vertical line denotes the optimum estimates, but these are generally immediately below the medians, except for the Binit.","key":"fig-6-5","order":{"number":5,"section":[6,4,0,0,0,0,0]}},{"caption":"","key":"eq-6_20","order":{"number":20,"section":[6,7,1,0,0,0,0]}},{"caption":"","key":"eq-6_3","order":{"number":3,"section":[6,1,2,0,0,0,0]}},{"caption":"abdat 数据集及相关的最佳预测 cpue（predce）和最佳残差（optres）。The abdat data-set with the associated optimum predicted cpue (predce), and the optimum residuals (optres).","key":"tbl-6-1","order":{"number":1,"section":[6,4,0,0,0,0,0]}},{"caption":"从不同的起点（三角形、正方形、圆形）出发的三个独立 MCMC 链中的前 75 个点。这些短链没有设置预烧，因此记录从起点开始。灰色圆点是第四条链中的 10000 个点，其中有 50 个点的 “预烧”和 4 个点的 “稀疏率”，这给出了所有链都应趋近的静态分布的大致概念。","key":"fig-6-15","order":{"number":15,"section":[6,7,8,0,0,0,0]}},{"caption":"","key":"eq-6_13","order":{"number":13,"section":[6,5,1,0,0,0,0]}},{"caption":"从估计的多变量正态分布中取样的 1000 个参数估计值（假定围绕最佳参数估计值）与 Schaefer 模型拟合的丰年鱼量值之间的关系。The relationships between the 1000 parameter estimates sampled from the estimated multi-variate Normal distribution assumed to surround the optimum parameter estimates and the derived MSY values for the Schaefer model fitted to the abdat data set.","key":"fig-6-8","order":{"number":8,"section":[6,5,2,0,0,0,0]}},{"caption":"鲍鱼渔业 abdat 数据集最佳预测 cpue 的 1000 个自助估计值。黑点为原始数据，黑线为原始模型拟合的最佳预测 cpue，灰色轨迹为预测 cpue 的 1000 个自举估计值。1000 bootstrap estimates of the optimum predicted cpue from the abdat data set for an abalone fishery. Black points are the original data, the black line is the optimum predicted cpue from the original model fit, and the grey trajectories are the 1000 bootstrap estimates of the predicted cpue.","key":"fig-6-4","order":{"number":4,"section":[6,4,0,0,0,0,0]}},{"caption":"","key":"eq-6_4","order":{"number":4,"section":[6,1,2,0,0,0,0]}},{"caption":"1970 - 1992 年间澳大利亚北部对虾渔业中基围虾和虎虾产量之间的正相关关系（数据来自 Robins 和 Somers，1994）。The positive correlation between the catches of endeavour and tiger prawns in the Australian Northern Prawn Fishery between 1970 - 1992 (data from Robins and Somers, 1994).","key":"fig-6-2","order":{"number":2,"section":[6,3,0,0,0,0,0]}},{"caption":"","key":"eq-6_14","order":{"number":14,"section":[6,6,1,0,0,0,0]}},{"caption":"nlm 解决方案 126 行中的前 12 条记录用于绘制 r 的似然曲线。The first 12 records from the 126 rows of the nlm solutions that are used to make the likelihood profile on r. The strong correlation between r, K, and Binit is, once again, apparent.","key":"tbl-6-3","order":{"number":3,"section":[6,6,0,0,0,0,0]}},{"caption":"将 Rprof() 函数应用于 do_MCMC() 函数调用后的输出结果，仅查看输出列表的 by.self 部分（按每个函数的运行时间排序），检查 outprof 的结构。总采样时间在 outprof$sampling.time 中。self.pct 的总和为 99.99，因此这些值是需要关注的。","key":"tbl-6-6","order":{"number":6,"section":[6,8,0,0,0,0,0]}},{"caption":"","key":"eq-6_8","order":{"number":8,"section":[6,5,0,0,0,0,0]}},{"caption":"自助百分位数参数置信区间与方差-协方差矩阵渐近估计值参数置信区间的比较。上表是自举法结果，下表是多元正态分布结果。A comparison of the bootstrap percentile confidence bounds on parameters with those derived from the Asymptotic estimate of the variance-covariance matrix. The top table relates to the bootstrapping and the bottom to the values from the multi-variate normal.","key":"tbl-6-2","order":{"number":2,"section":[6,5,2,0,0,0,0]}},{"caption":"Schaefer 模型参数后验分布的 10000 个样本与 MSY 之间的关系。通常情况下，我们会使用比 4 更长的稀疏化步长来描述后验结果。图中的全部颜色至少来自 50 个点。","key":"fig-6-16","order":{"number":16,"section":[6,7,8,0,0,0,0]}}]}